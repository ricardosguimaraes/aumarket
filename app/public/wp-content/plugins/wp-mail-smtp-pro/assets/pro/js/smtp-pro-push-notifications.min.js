"use strict";!async function(i,e){var r="WPMailSMTPPushNotificationsSubscription";if("serviceWorker"in navigator&&"PushManager"in i&&"Notification"in i&&"granted"===Notification.permission){i=localStorage.getItem(r);if(i)try{if(!(i=JSON.parse(i)))throw new Error;const o=await navigator.serviceWorker.register(e.serviceWorkerUrl),s=await o.pushManager.getSubscription();if(null===s||s.endpoint===i.endpoint)return;let t=new FormData;t.set("task","update_subscription"),t.set("user_agent",navigator.userAgent),t.set("subscription_id",i.id),t.set("details",JSON.stringify(s.toJSON()));const n=await fetch(e.apiUrl,{method:"POST",body:t});var a=await n.json();if(!a.success)throw new Error;localStorage.setItem(r,JSON.stringify(a.data))}catch(t){localStorage.removeItem(r)}}}(window,WPMailSMTPPushNotificationsSettings);