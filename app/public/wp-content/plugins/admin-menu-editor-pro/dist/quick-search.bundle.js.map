{"version":3,"file":"quick-search.bundle.js","mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,IAA0C;AAClD,QAAQ,oCAAO,UAAU;AAAA;AAAA;AAAA;AAAA,kGAAC;AAC1B,MAAM,KAAK,EAIN;AACL,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA,UAAU;AACV;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,wBAAwB,uBAAuB;AAC/C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA,qEAAqE;AACrE,YAAY;AACZ;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA,gBAAgB;AAChB;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY;;AAEZ;AACA;AACA;AACA,qDAAqD;AACrD,YAAY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ACA,cAAc,6EAAoB;AAClC,eAAe,6EAAoB;AACnC;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,WAAW,mEAAe;AAC1B;AACA;;;;;;;;;;;;;;;;;;;AC5DgE;AACd;AACI;AACtD;AACA;AACA;AACO;AACP;AACA;AACA;AACA,2BAA2B,2DAAgB;AAC3C,2BAA2B,6EAAoB,OAAO;AACtD;AACA;AACA;AACA;AACO;AACP;AACA,WAAW,mEAAe;AAC1B;AACA;;;;;;;;;;;;;;;;;;;;ACpBuD;AACH;AACM;AACiC;AAC3F;AACA;AACA;AACO;AACP,2BAA2B,oEAAiB;AAC5C;AACA,4BAA4B,6EAAiB,WAAW,wDAAiB,YAAY,+CAAQ;AAC7F;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL,yCAAyC,gFAAwB;AACjE;AACA;AACA;AACA;AACO;AACP,yDAAyD,6DAAkB;AAC3E;AACA;;;;;;;;;;;;;;;;;;;ACxBgE;AACjB;AACG;AAClD;AACA;AACA;AACO;AACP;AACA,yBAAyB,6EAAoB,KAAK;AAClD,2CAA2C,iBAAiB;AAC5D,YAAY,wDAAa,aAAa,+DAAY;AAClD;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACtBqD;AACC;AACtD;AACA;AACA;AACO;AACP;AACA;AACA,8DAA8D,8DAAS;AACvE;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,WAAW,mEAAe;AAC1B;AACA;;;;;;;;;;;;;;;;;;ACtBmD;AACG;AACtD;AACA;AACA;AACO;AACP,gBAAgB,gEAAc;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,IAAI,eAAe,iBAAiB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,WAAW,mEAAe;AAC1B;AACA;;;;;;;;;;;;;;;;;;ACzBgE;AACb;AACnD;AACA;AACA;AACO;AACP;AACA,QAAQ,6EAAoB;AAC5B;AACA;AACA;AACA;AACA;AACO;AACP;AACA,mBAAmB,gEAAY;AAC/B;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACnBO;AACP;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACbA;AACA;AACA;AACO,uCAAuC;AAC9C;AACA;AACA;AACA;AACA,0BAA0B,cAAc;AACxC;AACA;AACA,2EAA2E,WAAW,cAAc;AACpG;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACjBkD;AACI;AACtD;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA,YAAY,+DAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,mEAAW;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,mEAAW;AACnB;AACA,KAAK;AACL;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;AC5DqD;AACC;AACA;AACtD;AACA;AACA;AACO;AACP,8BAA8B,mEAAY;AAC1C;AACA;AACA;AACA;AACA;AACA;AACO;AACP,8BAA8B,mEAAY;AAC1C;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,WAAW,kEAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP,WAAW,mEAAe;AAC1B;AACA;AACA;AACA;AACO;AACP;AACA;AACA;;;;;;;;;;;;;;;;;;;;AC3C0D;AACR;AACmB;AACrE;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,8DAA8D,+CAAQ;AAC7E;AACA;AACA,6CAA6C,kFAAyB;AACtE,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,oCAAoC,sBAAsB;AACjE,sBAAsB,2DAAgB;AACtC;AACA,kBAAkB,wDAAiB;AACnC,kBAAkB,wDAAiB;AACnC,oDAAoD,wDAAiB;AACrE;AACA;AACA;AACA;AACA,mCAAmC,gBAAgB;AACnD;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;;;;;;;;;;;;;;;AC/CA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;ACRA;AACA;AACA;AACA;AACO;AACP;AACA,oBAAoB,YAAY,IAAI,GAAG;AACvC;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;ACRgD;AACQ;AACF;AAC/C;AACP;AACA,QAAQ,wDAAiB;AACzB,QAAQ,wDAAiB;AACzB,QAAQ,wDAAiB;AACzB,QAAQ,wDAAiB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,kCAAkC,qEAAW,CAAC,wDAAiB;AAC/D;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,YAAY,mEAAW;AACvB;AACA;AACA;AACA,2CAA2C,iBAAiB;AAC5D;AACA;AACA;AACA,YAAY,mEAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO,qDAAqD;AAC5D,kDAAkD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;AClHO,0CAA0C,wCAAwC,IAAI;AAC7F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,mCAAmC,wCAAwC,IAAI;AACtF,iDAAiD,YAAY;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChDkD;AAC6C;AACZ;AACX;AACmB;AACI;AACpB;AACF;AACX;AACJ;AACL;AACC;AACS;AACxD;AACP;AACA;AACO,+CAA+C,EAAE,QAAQ;AAChE;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA,wBAAwB,eAAe;AACvC;AACA;AACA,wBAAwB,UAAU;AAClC;AACA;AACA,KAAK;AACL;AACA;AACO;AACP,SAAS,4DAAc;AACvB,QAAQ,0DAAa;AACrB,WAAW,iEAAiB;AAC5B,eAAe,yEAAqB;AACpC,cAAc,uEAAmB;AACjC,eAAe,0EAAoB;AACnC;AACO;AACP,SAAS,oEAAsB;AAC/B,QAAQ,kEAAqB;AAC7B,WAAW,wEAAwB;AACnC,eAAe,gFAA4B;AAC3C,cAAc,8EAA0B;AACxC,eAAe,iFAA2B;AAC1C;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACO;AACP;AACA;AACA,0BAA0B,gEAAY;AACtC;AACA;AACA;AACA;AACA;AACO;AACP,YAAY,+DAA+D;AAC3E,2BAA2B,wEAAoB;AAC/C,2BAA2B,wEAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA,cAAc,oEAAW,oBAAoB,6BAA6B;AAC1E;AACA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACO;AACP,YAAY,wBAAwB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,wDAAiB;AAC1C,sBAAsB,wDAAiB;AACvC;AACA,oBAAoB,wDAAiB;AACrC;AACA;AACA;AACA;AACO;AACP,YAAY,gEAAgE;AAC5E;AACA,UAAU,oEAAW,cAAc,2BAA2B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,yBAAyB,6EAAmB;AAC5C;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACO,4CAA4C;AACnD,wBAAwB,2DAAgB;AACxC;AACA,qBAAqB,wDAAiB;AACtC,qBAAqB,wDAAiB;AACtC,uCAAuC,wDAAiB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,+CAAQ;AAC9D,sDAAsD,+CAAQ;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,YAAY,+DAAY;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW,6DAAU;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO;AACP;AACA;AACA;AACA,wEAAwE,+DAAS;AACjF;AACA;AACA;;;;;;;;;;;;;;;ACzQA;AACA;AACA;AACO;AACP;AACA;AACA;;;;;;;;;;;;;;;ACNA;AACA;AACA;AACA,kBAAkB,sBAAsB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,EAAE;AACtC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,0BAA0B;;AAE1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,kCAAkC;;AAElC;AACA;AACA;;AAEA;AACA;AACA,qEAAqE;AACrE;AACA;AACA,0CAA0C;AAC1C;AACA,uEAAuE;AACvE;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,6DAA6D;AAC7D;AACA,oBAAoB,oBAAoB;AACxC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA,6CAA6C;AAC7C,OAAO;AACP;AACA,6BAA6B;AAC7B;AACA,KAAK;AACL;AACA,oBAAoB,yCAAyC;AAC7D,mBAAmB;AACnB;AACA;AACA;;AAEA,mCAAmC,WAAW;AAC9C;;AAE0B;;;;;;;;;;;;;;;;;ACrII;;AAE9B;AACA,aAAa,gDAAI;;AAEjB,iEAAe,MAAM,EAAC;;;;;;;;;;;;;;;;;;;ACLY;AACM;AACU;;AAElD;AACA;AACA;;AAEA;AACA,qBAAqB,kDAAM,GAAG,kDAAM;;AAEpC;AACA;AACA;AACA;AACA,WAAW,GAAG;AACd,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,yDAAS;AACf,MAAM,8DAAc;AACpB;;AAEA,iEAAe,UAAU,EAAC;;;;;;;;;;;;;;;;;AC3B0B;;AAEpD;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,QAAQ;AACrB;AACA;AACA;AACA,sBAAsB,+DAAe;AACrC;AACA;;AAEA,iEAAe,QAAQ,EAAC;;;;;;;;;;;;;;;;AClBxB;AACA;;AAEA,iEAAe,UAAU,EAAC;;;;;;;;;;;;;;;;;ACHQ;;AAElC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qBAAqB,kDAAM,GAAG,kDAAM;;AAEpC;AACA;AACA;AACA;AACA,WAAW,GAAG;AACd,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;;AAEA,iEAAe,SAAS,EAAC;;;;;;;;;;;;;;;;AC7CzB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,GAAG;AACd,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA,iEAAe,cAAc,EAAC;;;;;;;;;;;;;;;;;ACrBY;;AAE1C;AACA;;AAEA;AACA,WAAW,sDAAU;;AAErB,iEAAe,IAAI,EAAC;;;;;;;;;;;;;;;;ACRpB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,aAAa,QAAQ;AACrB;AACA;AACA;;AAEA;AACA;AACA;;AAEA,iEAAe,eAAe,EAAC;;;;;;;;;;;;;;;;;;;AClBM;AACV;AACU;;AAErC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,QAAQ;AACnB,WAAW,QAAQ,WAAW;AAC9B,WAAW,SAAS;AACpB;AACA,WAAW,QAAQ;AACnB;AACA,WAAW,SAAS;AACpB;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,+CAA+C,iBAAiB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS,wDAAQ;AACjB,MAAM,wDAAQ;AACd;AACA;AACA,iCAAiC,wDAAQ;AACzC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,eAAe,mDAAG;AAClB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,yDAAyD,mDAAG;AAC5D;;AAEA;AACA,eAAe,mDAAG;AAClB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iEAAe,QAAQ,EAAC;;;;;;;;;;;;;;;;AC9LxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,GAAG;AACd,aAAa,SAAS;AACtB;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iEAAe,QAAQ,EAAC;;;;;;;;;;;;;;;;AC9BxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,GAAG;AACd,aAAa,SAAS;AACtB;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iEAAe,YAAY,EAAC;;;;;;;;;;;;;;;;;;AC5Bc;AACG;;AAE7C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,GAAG;AACd,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,4DAAY,WAAW,0DAAU;AACtC;;AAEA,iEAAe,QAAQ,EAAC;;;;;;;;;;;;;;;;;AC5BM;;AAE9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,SAAS,gDAAI;AACb;;AAEA,iEAAe,GAAG,EAAC;;;;;;;;;;;;;;;;;;ACtBkB;AACA;;AAErC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,QAAQ;AACnB,WAAW,QAAQ,WAAW;AAC9B,WAAW,SAAS;AACpB;AACA,WAAW,SAAS;AACpB;AACA,aAAa,UAAU;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,mBAAmB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM,wDAAQ;AACd;AACA;AACA;AACA,SAAS,wDAAQ;AACjB;AACA;AACA;AACA,GAAG;AACH;;AAEA,iEAAe,QAAQ,EAAC;;;;;;;;;;;;;;;;;;;ACpEc;AACD;AACA;;AAErC;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,GAAG;AACd,aAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,wDAAQ;AACd;AACA;AACA,MAAM,wDAAQ;AACd;AACA,YAAY,wDAAQ;AACpB;AACA;AACA;AACA;AACA,UAAU,wDAAQ;AAClB;AACA;AACA;AACA;AACA;;AAEA,iEAAe,QAAQ,EAAC","sources":["webpack:///./node_modules/loglevel/lib/loglevel.js","webpack:///./extras/modules/quick-search/app-geometry.ts","webpack:///./extras/modules/quick-search/crawler.ts","webpack:///./extras/modules/quick-search/db.ts","webpack:///./extras/modules/quick-search/items.ts","webpack:///./extras/modules/quick-search/quick-search.ts","webpack:///./extras/modules/quick-search/scanner.ts","webpack:///./extras/modules/quick-search/utils.ts","webpack:///./node_modules/css-selector-generator/esm/constants.js","webpack:///./node_modules/css-selector-generator/esm/index.js","webpack:///./node_modules/css-selector-generator/esm/selector-attribute.js","webpack:///./node_modules/css-selector-generator/esm/selector-class.js","webpack:///./node_modules/css-selector-generator/esm/selector-fallback.js","webpack:///./node_modules/css-selector-generator/esm/selector-id.js","webpack:///./node_modules/css-selector-generator/esm/selector-nth-child.js","webpack:///./node_modules/css-selector-generator/esm/selector-nth-of-type.js","webpack:///./node_modules/css-selector-generator/esm/selector-tag.js","webpack:///./node_modules/css-selector-generator/esm/types.js","webpack:///./node_modules/css-selector-generator/esm/utilities-cartesian.js","webpack:///./node_modules/css-selector-generator/esm/utilities-data.js","webpack:///./node_modules/css-selector-generator/esm/utilities-dom.js","webpack:///./node_modules/css-selector-generator/esm/utilities-element-data.js","webpack:///./node_modules/css-selector-generator/esm/utilities-iselement.js","webpack:///./node_modules/css-selector-generator/esm/utilities-messages.js","webpack:///./node_modules/css-selector-generator/esm/utilities-options.js","webpack:///./node_modules/css-selector-generator/esm/utilities-powerset.js","webpack:///./node_modules/css-selector-generator/esm/utilities-selectors.js","webpack:///./node_modules/css-selector-generator/esm/utilities-typescript.js","webpack:///./node_modules/js-cookie/dist/js.cookie.mjs","webpack:///./node_modules/lodash-es/_Symbol.js","webpack:///./node_modules/lodash-es/_baseGetTag.js","webpack:///./node_modules/lodash-es/_baseTrim.js","webpack:///./node_modules/lodash-es/_freeGlobal.js","webpack:///./node_modules/lodash-es/_getRawTag.js","webpack:///./node_modules/lodash-es/_objectToString.js","webpack:///./node_modules/lodash-es/_root.js","webpack:///./node_modules/lodash-es/_trimmedEndIndex.js","webpack:///./node_modules/lodash-es/debounce.js","webpack:///./node_modules/lodash-es/isObject.js","webpack:///./node_modules/lodash-es/isObjectLike.js","webpack:///./node_modules/lodash-es/isSymbol.js","webpack:///./node_modules/lodash-es/now.js","webpack:///./node_modules/lodash-es/throttle.js","webpack:///./node_modules/lodash-es/toNumber.js"],"sourcesContent":["/*\n* loglevel - https://github.com/pimterry/loglevel\n*\n* Copyright (c) 2013 Tim Perry\n* Licensed under the MIT license.\n*/\n(function (root, definition) {\n    \"use strict\";\n    if (typeof define === 'function' && define.amd) {\n        define(definition);\n    } else if (typeof module === 'object' && module.exports) {\n        module.exports = definition();\n    } else {\n        root.log = definition();\n    }\n}(this, function () {\n    \"use strict\";\n\n    // Slightly dubious tricks to cut down minimized file size\n    var noop = function() {};\n    var undefinedType = \"undefined\";\n    var isIE = (typeof window !== undefinedType) && (typeof window.navigator !== undefinedType) && (\n        /Trident\\/|MSIE /.test(window.navigator.userAgent)\n    );\n\n    var logMethods = [\n        \"trace\",\n        \"debug\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ];\n\n    var _loggersByName = {};\n    var defaultLogger = null;\n\n    // Cross-browser bind equivalent that works at least back to IE6\n    function bindMethod(obj, methodName) {\n        var method = obj[methodName];\n        if (typeof method.bind === 'function') {\n            return method.bind(obj);\n        } else {\n            try {\n                return Function.prototype.bind.call(method, obj);\n            } catch (e) {\n                // Missing bind shim or IE8 + Modernizr, fallback to wrapping\n                return function() {\n                    return Function.prototype.apply.apply(method, [obj, arguments]);\n                };\n            }\n        }\n    }\n\n    // Trace() doesn't print the message in IE, so for that case we need to wrap it\n    function traceForIE() {\n        if (console.log) {\n            if (console.log.apply) {\n                console.log.apply(console, arguments);\n            } else {\n                // In old IE, native console methods themselves don't have apply().\n                Function.prototype.apply.apply(console.log, [console, arguments]);\n            }\n        }\n        if (console.trace) console.trace();\n    }\n\n    // Build the best logging method possible for this env\n    // Wherever possible we want to bind, not wrap, to preserve stack traces\n    function realMethod(methodName) {\n        if (methodName === 'debug') {\n            methodName = 'log';\n        }\n\n        if (typeof console === undefinedType) {\n            return false; // No method possible, for now - fixed later by enableLoggingWhenConsoleArrives\n        } else if (methodName === 'trace' && isIE) {\n            return traceForIE;\n        } else if (console[methodName] !== undefined) {\n            return bindMethod(console, methodName);\n        } else if (console.log !== undefined) {\n            return bindMethod(console, 'log');\n        } else {\n            return noop;\n        }\n    }\n\n    // These private functions always need `this` to be set properly\n\n    function replaceLoggingMethods() {\n        /*jshint validthis:true */\n        var level = this.getLevel();\n\n        // Replace the actual methods.\n        for (var i = 0; i < logMethods.length; i++) {\n            var methodName = logMethods[i];\n            this[methodName] = (i < level) ?\n                noop :\n                this.methodFactory(methodName, level, this.name);\n        }\n\n        // Define log.log as an alias for log.debug\n        this.log = this.debug;\n\n        // Return any important warnings.\n        if (typeof console === undefinedType && level < this.levels.SILENT) {\n            return \"No console available for logging\";\n        }\n    }\n\n    // In old IE versions, the console isn't present until you first open it.\n    // We build realMethod() replacements here that regenerate logging methods\n    function enableLoggingWhenConsoleArrives(methodName) {\n        return function () {\n            if (typeof console !== undefinedType) {\n                replaceLoggingMethods.call(this);\n                this[methodName].apply(this, arguments);\n            }\n        };\n    }\n\n    // By default, we use closely bound real methods wherever possible, and\n    // otherwise we wait for a console to appear, and then try again.\n    function defaultMethodFactory(methodName, _level, _loggerName) {\n        /*jshint validthis:true */\n        return realMethod(methodName) ||\n               enableLoggingWhenConsoleArrives.apply(this, arguments);\n    }\n\n    function Logger(name, factory) {\n      // Private instance variables.\n      var self = this;\n      /**\n       * The level inherited from a parent logger (or a global default). We\n       * cache this here rather than delegating to the parent so that it stays\n       * in sync with the actual logging methods that we have installed (the\n       * parent could change levels but we might not have rebuilt the loggers\n       * in this child yet).\n       * @type {number}\n       */\n      var inheritedLevel;\n      /**\n       * The default level for this logger, if any. If set, this overrides\n       * `inheritedLevel`.\n       * @type {number|null}\n       */\n      var defaultLevel;\n      /**\n       * A user-specific level for this logger. If set, this overrides\n       * `defaultLevel`.\n       * @type {number|null}\n       */\n      var userLevel;\n\n      var storageKey = \"loglevel\";\n      if (typeof name === \"string\") {\n        storageKey += \":\" + name;\n      } else if (typeof name === \"symbol\") {\n        storageKey = undefined;\n      }\n\n      function persistLevelIfPossible(levelNum) {\n          var levelName = (logMethods[levelNum] || 'silent').toUpperCase();\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage[storageKey] = levelName;\n              return;\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=\" + levelName + \";\";\n          } catch (ignore) {}\n      }\n\n      function getPersistedLevel() {\n          var storedLevel;\n\n          if (typeof window === undefinedType || !storageKey) return;\n\n          try {\n              storedLevel = window.localStorage[storageKey];\n          } catch (ignore) {}\n\n          // Fallback to cookies if local storage gives us nothing\n          if (typeof storedLevel === undefinedType) {\n              try {\n                  var cookie = window.document.cookie;\n                  var cookieName = encodeURIComponent(storageKey);\n                  var location = cookie.indexOf(cookieName + \"=\");\n                  if (location !== -1) {\n                      storedLevel = /^([^;]+)/.exec(\n                          cookie.slice(location + cookieName.length + 1)\n                      )[1];\n                  }\n              } catch (ignore) {}\n          }\n\n          // If the stored level is not valid, treat it as if nothing was stored.\n          if (self.levels[storedLevel] === undefined) {\n              storedLevel = undefined;\n          }\n\n          return storedLevel;\n      }\n\n      function clearPersistedLevel() {\n          if (typeof window === undefinedType || !storageKey) return;\n\n          // Use localStorage if available\n          try {\n              window.localStorage.removeItem(storageKey);\n          } catch (ignore) {}\n\n          // Use session cookie as fallback\n          try {\n              window.document.cookie =\n                encodeURIComponent(storageKey) + \"=; expires=Thu, 01 Jan 1970 00:00:00 UTC\";\n          } catch (ignore) {}\n      }\n\n      function normalizeLevel(input) {\n          var level = input;\n          if (typeof level === \"string\" && self.levels[level.toUpperCase()] !== undefined) {\n              level = self.levels[level.toUpperCase()];\n          }\n          if (typeof level === \"number\" && level >= 0 && level <= self.levels.SILENT) {\n              return level;\n          } else {\n              throw new TypeError(\"log.setLevel() called with invalid level: \" + input);\n          }\n      }\n\n      /*\n       *\n       * Public logger API - see https://github.com/pimterry/loglevel for details\n       *\n       */\n\n      self.name = name;\n\n      self.levels = { \"TRACE\": 0, \"DEBUG\": 1, \"INFO\": 2, \"WARN\": 3,\n          \"ERROR\": 4, \"SILENT\": 5};\n\n      self.methodFactory = factory || defaultMethodFactory;\n\n      self.getLevel = function () {\n          if (userLevel != null) {\n            return userLevel;\n          } else if (defaultLevel != null) {\n            return defaultLevel;\n          } else {\n            return inheritedLevel;\n          }\n      };\n\n      self.setLevel = function (level, persist) {\n          userLevel = normalizeLevel(level);\n          if (persist !== false) {  // defaults to true\n              persistLevelIfPossible(userLevel);\n          }\n\n          // NOTE: in v2, this should call rebuild(), which updates children.\n          return replaceLoggingMethods.call(self);\n      };\n\n      self.setDefaultLevel = function (level) {\n          defaultLevel = normalizeLevel(level);\n          if (!getPersistedLevel()) {\n              self.setLevel(level, false);\n          }\n      };\n\n      self.resetLevel = function () {\n          userLevel = null;\n          clearPersistedLevel();\n          replaceLoggingMethods.call(self);\n      };\n\n      self.enableAll = function(persist) {\n          self.setLevel(self.levels.TRACE, persist);\n      };\n\n      self.disableAll = function(persist) {\n          self.setLevel(self.levels.SILENT, persist);\n      };\n\n      self.rebuild = function () {\n          if (defaultLogger !== self) {\n              inheritedLevel = normalizeLevel(defaultLogger.getLevel());\n          }\n          replaceLoggingMethods.call(self);\n\n          if (defaultLogger === self) {\n              for (var childName in _loggersByName) {\n                _loggersByName[childName].rebuild();\n              }\n          }\n      };\n\n      // Initialize all the internal levels.\n      inheritedLevel = normalizeLevel(\n          defaultLogger ? defaultLogger.getLevel() : \"WARN\"\n      );\n      var initialLevel = getPersistedLevel();\n      if (initialLevel != null) {\n          userLevel = normalizeLevel(initialLevel);\n      }\n      replaceLoggingMethods.call(self);\n    }\n\n    /*\n     *\n     * Top-level API\n     *\n     */\n\n    defaultLogger = new Logger();\n\n    defaultLogger.getLogger = function getLogger(name) {\n        if ((typeof name !== \"symbol\" && typeof name !== \"string\") || name === \"\") {\n            throw new TypeError(\"You must supply a name when creating a logger.\");\n        }\n\n        var logger = _loggersByName[name];\n        if (!logger) {\n            logger = _loggersByName[name] = new Logger(\n                name,\n                defaultLogger.methodFactory\n            );\n        }\n        return logger;\n    };\n\n    // Grab the current global log variable in case of overwrite\n    var _log = (typeof window !== undefinedType) ? window.log : undefined;\n    defaultLogger.noConflict = function() {\n        if (typeof window !== undefinedType &&\n               window.log === defaultLogger) {\n            window.log = _log;\n        }\n\n        return defaultLogger;\n    };\n\n    defaultLogger.getLoggers = function getLoggers() {\n        return _loggersByName;\n    };\n\n    // ES6 default export, for compatibility\n    defaultLogger['default'] = defaultLogger;\n\n    return defaultLogger;\n}));\n","import none = AmeMiniFunc.none;\nimport some = AmeMiniFunc.some;\nimport Option = AmeMiniFunc.Option;\n\nimport Cookies from 'js-cookie';\n\nconst geometryCookieName = 'ameQuickSearchGeometry';\n\ninterface GeometryCookieShape {\n\tsize?: { width: number, height: number };\n\tposition?: {\n\t\thorizontal: { side: 'left' | 'right', offset: number },\n\t\tvertical: { side: 'top' | 'bottom', offset: number }\n\t}\n}\n\nfunction parseGeometryCookie(cookieValue: string): Option<GeometryCookieShape> {\n\tfunction validatePositionAxis(value: unknown, axis: 'horizontal' | 'vertical'): boolean {\n\t\tif (!value || typeof value !== 'object') {\n\t\t\treturn false;\n\t\t}\n\t\tconst position = value as Record<string, unknown>;\n\t\tif (typeof position.side !== 'string' || typeof position.offset !== 'number') {\n\t\t\treturn false;\n\t\t}\n\t\tif (axis === 'horizontal') {\n\t\t\treturn position.side === 'left' || position.side === 'right';\n\t\t} else {\n\t\t\treturn position.side === 'top' || position.side === 'bottom';\n\t\t}\n\t}\n\n\ttry {\n\t\tconst parsed = JSON.parse(cookieValue);\n\t\tif (!parsed || typeof parsed !== 'object') {\n\t\t\treturn none;\n\t\t}\n\n\t\t//At least one of \"size\" and \"position\" must be present. The cookie can\n\t\t//technically be valid without either, but it would be useless.\n\t\tif (!parsed.size && !parsed.position) {\n\t\t\treturn none;\n\t\t}\n\n\t\t//If \"size\" is present, it must be an object with \"width\" and \"height\" properties.\n\t\tif (parsed.size) {\n\t\t\tconst size = parsed.size;\n\t\t\tif (typeof size === 'object' && size.width && size.height) {\n\t\t\t\tif (typeof size.width === 'number' && typeof size.height === 'number') {\n\t\t\t\t\t//Size is valid.\n\t\t\t\t} else {\n\t\t\t\t\treturn none;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn none;\n\t\t\t}\n\t\t}\n\n\t\t//If \"position\" is present, it must also have the correct shape.\n\t\tif (parsed.position) {\n\t\t\tconst position = parsed.position;\n\t\t\tif (\n\t\t\t\t!validatePositionAxis(position.horizontal, 'horizontal')\n\t\t\t\t|| !validatePositionAxis(position.vertical, 'vertical')\n\t\t\t) {\n\t\t\t\treturn none;\n\t\t\t}\n\t\t}\n\n\t\treturn some(parsed);\n\t} catch (e) {\n\t\treturn none;\n\t}\n}\n\nexport class PanelGeometryStore {\n\tconstructor(private readonly cookiePath: string) {\n\t}\n\n\tstoreSize(size: { width: number, height: number }) {\n\t\tconst value = this.getOrCreateGeometry();\n\t\tvalue.size = size;\n\t\tthis.updateCookie(value);\n\t}\n\n\tstorePosition(top: number, left: number, width: number, height: number) {\n\t\tconst value = this.getOrCreateGeometry();\n\t\tconst centerX = left + width / 2;\n\t\tconst centerY = top + height / 2;\n\n\t\tconst $window = jQuery(window);\n\t\tconst windowWidth = $window.width() || 0;\n\t\tconst windowHeight = $window.height() || 0;\n\n\t\tconst horizontalSide = centerX < windowWidth / 2 ? 'left' : 'right';\n\t\tconst horizontalOffset = (horizontalSide === 'left') ? left : -(windowWidth - left - width);\n\n\t\tconst verticalSide = centerY < windowHeight / 2 ? 'top' : 'bottom';\n\t\tconst verticalOffset = (verticalSide === 'top') ? top : -(windowHeight - top - height);\n\n\t\tvalue.position = {\n\t\t\thorizontal: {\n\t\t\t\tside: horizontalSide,\n\t\t\t\toffset: horizontalOffset\n\t\t\t},\n\t\t\tvertical: {\n\t\t\t\tside: verticalSide,\n\t\t\t\toffset: verticalOffset\n\t\t\t}\n\t\t};\n\t\tthis.updateCookie(value);\n\t}\n\n\tgetStoredSize(): Option<{ width: number, height: number }> {\n\t\tconst value = this.getStoredGeometry();\n\t\treturn value.flatMap(\n\t\t\t(geometry) => geometry.size ? some(geometry.size) : none\n\t\t);\n\t}\n\n\tgetStoredPositionForJQuery(): Option<{ my: string, at: string }> {\n\t\treturn this.getStoredGeometry()\n\t\t\t.flatMap(\n\t\t\t\t(geometry) => geometry.position ? some(geometry.position) : none\n\t\t\t)\n\t\t\t.map(\n\t\t\t\t(geometry) => {\n\t\t\t\t\tconst my = geometry.horizontal.side + ' ' + geometry.vertical.side;\n\n\t\t\t\t\tconst at: string = (\n\t\t\t\t\t\tgeometry.horizontal.side\n\t\t\t\t\t\t+ ((geometry.horizontal.offset >= 0) ? '+' : '-')\n\t\t\t\t\t\t+ Math.abs(geometry.horizontal.offset)\n\t\t\t\t\t\t+ ' '\n\n\t\t\t\t\t\t+ geometry.vertical.side\n\t\t\t\t\t\t+ ((geometry.vertical.offset >= 0) ? '+' : '-')\n\t\t\t\t\t\t+ Math.abs(geometry.vertical.offset)\n\t\t\t\t\t);\n\n\t\t\t\t\treturn {my, at};\n\t\t\t\t}\n\t\t\t);\n\t}\n\n\tprivate getStoredGeometry(): Option<GeometryCookieShape> {\n\t\tconst cookieValue = Cookies.get(geometryCookieName);\n\t\tif (cookieValue) {\n\t\t\tconst result = parseGeometryCookie(cookieValue);\n\t\t\tif (result.isDefined()) {\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\t//Delete invalid cookie.\n\t\t\t\tCookies.remove(geometryCookieName, {path: this.cookiePath});\n\t\t\t}\n\t\t}\n\t\treturn none;\n\t}\n\n\tprivate updateCookie(value: GeometryCookieShape) {\n\t\tconsole.log('Storing geometry:', value);\n\n\t\tCookies.set(geometryCookieName, JSON.stringify(value), {\n\t\t\texpires: 90,\n\t\t\tpath: this.cookiePath,\n\t\t\tsameSite: 'Lax'\n\t\t});\n\t}\n\n\tprivate getOrCreateGeometry(): GeometryCookieShape {\n\t\treturn this.getStoredGeometry().getOrElse(() => ({}));\n\t}\n}","import Option = AmeMiniFunc.Option;\nimport none = AmeMiniFunc.none;\nimport some = AmeMiniFunc.some;\n\nimport {DashboardItem, ItemLocation, ItemTargetType, SearchableItem} from './items';\nimport {builtinScanners, PageScanner, parseAdminMenuItems} from './scanner';\nimport {KoObservableSet} from './utils';\n\ninterface CrawlRequestResults {\n\trequest: CrawlRequest;\n\titems: SearchableItem[];\n}\n\ntype CrawlerState = 'idle' | 'running' | 'completed' | 'stopped';\n\nexport class Crawler {\n\tprivate loadNextCallNumber: number = 0;\n\n\tprivate readonly state: KnockoutObservable<CrawlerState> = ko.observable<CrawlerState>('idle');\n\tprivate stopWhenAllRequestsFinished: boolean = true;\n\n\tprivate readonly pendingCrawlRequests: KoObservableSet<CrawlRequest> = new KoObservableSet<CrawlRequest>();\n\tpublic readonly crawlRequestQueue: KoObservableSet<CrawlRequest> = new KoObservableSet<CrawlRequest>();\n\tpublic readonly finishedRequests: KoObservableSet<CrawlRequest> = new KoObservableSet<CrawlRequest>();\n\n\treadonly activeRequests: KnockoutComputed<CrawlRequest[]>;\n\n\tprivate readonly pendingTimeouts: Set<SkippableTimeout> = new Set<SkippableTimeout>();\n\tpublic readonly isRunning: KnockoutComputed<boolean>;\n\n\tprivate addedUrls: Set<string> = new Set<string>();\n\tprivate readonly crawlDepthLimit: number = 3;\n\n\tprivate itemsByMenuUrl: Map<string, Map<string, SearchableItem>> = new Map();\n\n\tconstructor(\n\t\tprivate readonly adminUrl: URL,\n\t\tprivate readonly currentUserId: number | null,\n\t\tprivate readonly removableQueryParams: string[],\n\t\tprivate readonly urlBlacklist: CrawlerUrlBlacklist,\n\t\tprivate readonly onRequestAdded: (request: CrawlRequest) => void = () => {\n\t\t}\n\t) {\n\t\tthis.activeRequests = ko.computed(() => {\n\t\t\tconst activeRequests: CrawlRequest[] = [];\n\t\t\tfor (const request of this.pendingCrawlRequests) {\n\t\t\t\tconst status = request.status();\n\t\t\t\tif ((status !== 'queued') && !request.isFinished) {\n\t\t\t\t\tactiveRequests.push(request);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn activeRequests;\n\t\t})\n\n\t\tthis.isRunning = ko.pureComputed(() => {\n\t\t\treturn this.state() === 'running';\n\t\t});\n\t}\n\n\tasync start() {\n\t\tif (this.isRunning()) {\n\t\t\tthrow new Error('Crawler is already running.');\n\t\t}\n\t\tthis.state('running');\n\n\t\tif (this.stopWhenAllRequestsFinished) {\n\t\t\tconsole.log('Creating stop subscription.');\n\t\t\tconst shouldStop = ko.computed(() => {\n\t\t\t\treturn (this.pendingCrawlRequests.size === 0);\n\t\t\t});\n\t\t\tif (!shouldStop()) {\n\t\t\t\tshouldStop.subscribe((value) => {\n\t\t\t\t\tif (value && this.isRunning()) {\n\t\t\t\t\t\tconsole.log('All requests finished, stopping the crawler.');\n\t\t\t\t\t\tshouldStop.dispose();\n\t\t\t\t\t\tthis.stopCrawler('completed');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconsole.log('All requests already finished upon start, stopping the crawler.');\n\t\t\t\tthis.stopCrawler('completed');\n\t\t\t}\n\t\t\tconsole.log('Stop subscription created.');\n\t\t}\n\n\t\tconsole.log('start(): Entering scanPages loop.');\n\t\tfor await (const request of this.scanPages()) {\n\t\t\tconsole.log('Crawl request completed:', request);\n\n\t\t\tif (!this.isRunning()) {\n\t\t\t\tconsole.log('Exiting scanPages loop due crawler being stopped.');\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (this.state() === 'running') {\n\t\t\tthis.stopCrawler('completed');\n\t\t}\n\t}\n\n\tprivate async* scanPages(): AsyncGenerator<CrawlRequest, void, undefined> {\n\t\tfor await (const page of this.batchLoadPages()) {\n\t\t\tif (!this.isRunning()) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst request = page.crawlRequest;\n\t\t\trequest.transitionStatus('scanning');\n\n\t\t\t//Detect the admin menu that's marked as active in the target page.\n\t\t\tconst adminMenuParserResult = parseAdminMenuItems(\n\t\t\t\tpage.$root,\n\t\t\t\trequest.adminUrl\n\t\t\t);\n\t\t\t//Use the detected menu URL if possible.\n\t\t\tlet menuUrl: string;\n\t\t\tif (adminMenuParserResult.currentMenuItem) {\n\t\t\t\tmenuUrl = adminMenuParserResult.currentMenuItem.getRelativeMenuUrl();\n\t\t\t} else {\n\t\t\t\tmenuUrl = request.menuUrl;\n\t\t\t}\n\n\t\t\t//If we end up on a different menu item, the location is probably no longer valid.\n\t\t\tlet location = request.location;\n\t\t\tif (menuUrl !== request.menuUrl) {\n\t\t\t\tlocation = [];\n\t\t\t}\n\n\t\t\tconst scanner = new PageScanner(builtinScanners);\n\t\t\tconst items = scanner.scan(\n\t\t\t\tpage.$root.find('body .wrap'),\n\t\t\t\tlocation,\n\t\t\t\trequest.pageUrl,\n\t\t\t\trequest.adminUrl,\n\t\t\t\tmenuUrl,\n\t\t\t\tthis.removableQueryParams,\n\t\t\t\tthis.currentUserId ? this.currentUserId.toString() : null\n\t\t\t);\n\n\t\t\tlet currentBatchStart = performance.now();\n\t\t\tconst maxBatchDuration = 1000 / 30;\n\n\t\t\tfor await (const item of items) {\n\t\t\t\trequest.addItem(item);\n\t\t\t\tthis.addFoundItem(menuUrl, item);\n\n\t\t\t\tif (!this.isRunning()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.maybeAddToQueue(item, request);\n\n\t\t\t\tif ((performance.now() - currentBatchStart) > maxBatchDuration) {\n\t\t\t\t\tawait this.nextAnimationFramePromise();\n\t\t\t\t\tcurrentBatchStart = performance.now();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tpage.$iframe.remove();\n\t\t\trequest.transitionStatus('completed');\n\n\t\t\tyield request;\n\t\t}\n\t}\n\n\tprivate async* batchLoadPages(maxConcurrentLoads: number = 3): AsyncGenerator<LoadedPage, void, undefined> {\n\t\tconsole.log('batchLoadPages(): Entering method.');\n\n\t\tinterface Wrapper {\n\t\t\tpageOption: Option<LoadedPage>\n\t\t\tkey: Object;\n\t\t}\n\n\t\tconst activePages: Map<Object, Promise<Wrapper>> = new Map();\n\t\tlet hasMorePages: boolean = true;\n\n\t\twhile (this.isRunning() && ((activePages.size > 0) || hasMorePages)) {\n\t\t\tconsole.log('batchLoadPages(): Inside main loop. Active pages:', activePages.size, 'Has more pages:', hasMorePages);\n\t\t\t//Load the next page(s) if we have room.\n\t\t\twhile ((activePages.size < maxConcurrentLoads) && hasMorePages) {\n\t\t\t\tconsole.log('batchLoadPages(): Adding another page to activePages.');\n\t\t\t\t//Since Promise.any() doesn't provide the resolved promise, we need this\n\t\t\t\t//hacky workaround to remove the promise when it resolves.\n\t\t\t\tconst nextPage = this.loadNextPage();\n\t\t\t\tconst key = {}\n\t\t\t\tactivePages.set(\n\t\t\t\t\tkey,\n\t\t\t\t\tnextPage.then(pageOption => {\n\t\t\t\t\t\treturn {pageOption, key};\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t//Wait for any page to finish.\n\t\t\tconsole.log('batchLoadPages(): Waiting for any page to finish.');\n\t\t\tconst waitOption = await this.withTimeout(300, Promise.any(activePages.values()));\n\t\t\tif (waitOption.isDefined()) {\n\t\t\t\tconst {pageOption, key} = waitOption.get();\n\t\t\t\tactivePages.delete(key);\n\t\t\t\tconsole.log('batchLoadPages(): Page finished loading.', pageOption);\n\n\t\t\t\tif (pageOption.isDefined()) {\n\t\t\t\t\tyield pageOption.get();\n\t\t\t\t} else {\n\t\t\t\t\thasMorePages = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async loadNextPage(): Promise<Option<LoadedPage>> {\n\t\tthis.loadNextCallNumber++;\n\t\tif (this.loadNextCallNumber > 100) {\n\t\t\tthrow new Error('loadNextPage(): Too many calls to loadNextPage(): ' + this.loadNextCallNumber);\n\t\t}\n\n\t\tconst thisCallNumber = this.loadNextCallNumber;\n\t\tlet totalLoops = 0;\n\n\t\twhile (this.isRunning()) {\n\t\t\ttotalLoops++;\n\t\t\tconsole.log('loadNextPage(): Top of main loop.', thisCallNumber, totalLoops);\n\n\t\t\tif (totalLoops > 100) {\n\t\t\t\tthrow new Error('loadNextPage(): Too many loop iterations. Call #' + thisCallNumber);\n\t\t\t}\n\n\t\t\tconst firstRequest = this.crawlRequestQueue.shift();\n\t\t\tif (!firstRequest) {\n\t\t\t\tconsole.log('loadNextPage(): No requests in the queue. Waiting.', thisCallNumber);\n\t\t\t\tconst start = performance.now();\n\t\t\t\tawait this.withTimeout(500);\n\t\t\t\tconst elapsed = performance.now() - start;\n\t\t\t\tconsole.log('loadNextPage(): Resuming after timeout.', thisCallNumber, elapsed);\n\t\t\t} else {\n\t\t\t\tconsole.log('loadNextPage(): Calling loadPageFor().', thisCallNumber);\n\t\t\t\tconst result = await this.loadPageFor(firstRequest);\n\t\t\t\tif (result.isDefined()) {\n\t\t\t\t\tconsole.log('loadNextPage(): Page loaded successfully.', thisCallNumber);\n\t\t\t\t\treturn result;\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log('loadNextPage(): Page failed to load.', thisCallNumber);\n\t\t\t\t}\n\t\t\t\t//Otherwise, move on and try the next request.\n\t\t\t}\n\t\t}\n\n\t\treturn none;\n\t}\n\n\tprivate async loadPageFor(request: CrawlRequest): Promise<Option<LoadedPage>> {\n\t\tconsole.log('Loading page:', request.pageUrl);\n\t\tif (!request.transitionStatus('loading')) {\n\t\t\tconsole.error('Failed to transition request to loading status', request);\n\t\t\treturn none;\n\t\t}\n\n\t\t//Load the page in a hidden iframe.\n\t\t//Note: The frame must be *technically* visible or all elements inside it will count as\n\t\t//hidden and the scanner will ignore all of them, finding no items.\n\t\tconst $iframe = jQuery('<iframe/>', {\n\t\t\tstyle: 'width: 1200; height: 800; position: absolute; top: -10000px; left: -10000px;'\n\t\t});\n\n\t\tconst frameLoadPromise = new Promise<JQuery>((resolve, reject) => {\n\t\t\t$iframe.on('load', () => {\n\t\t\t\tconsole.log('Frame loaded:', request.pageUrl);\n\t\t\t\tconst $root = $iframe.contents();\n\t\t\t\tif ($root.length === 0) {\n\t\t\t\t\treject(new Error('Failed to load page: no iframe content document.'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconsole.log('Page loaded:', request.pageUrl);\n\t\t\t\tconst $body = $root.find('body');\n\t\t\t\tif ($body.length === 0) {\n\t\t\t\t\treject(new Error('Failed to load page: no body element.'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//Currently, we only support scanning standard admin pages. All of them have\n\t\t\t\t//the \"wp-admin\" class on the body element since at least 2009.\n\t\t\t\t//For example, this check is helpful in cases where an admin menu item has\n\t\t\t\t//a syntactically valid but non-existent /wp-admin/... URL that shows a 404 page.\n\t\t\t\tif (!$body.hasClass('wp-admin')) {\n\t\t\t\t\treject(new Error('Failed to load page: not a standard WordPress admin page.'));\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//Give any page scripts a chance to run.\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tresolve($root);\n\t\t\t\t}, 150);\n\t\t\t});\n\t\t\t$iframe.on('error', () => {\n\t\t\t\tconsole.error('Frame error:', request.pageUrl);\n\t\t\t\treject(new Error('Failed to load page: error event on iframe.'));\n\t\t\t});\n\t\t})\n\n\t\t$iframe.prop('src', request.pageUrl);\n\t\tjQuery('body').append($iframe);\n\n\t\tconst timeout = this.createSkippableTimeout(10000);\n\n\t\t//If the request is aborted, cancel the timeout. This will immediately resolve the promise.\n\t\tconst koSubscription = request.status.subscribe(status => {\n\t\t\tif (status === 'aborted') {\n\t\t\t\tkoSubscription.dispose();\n\t\t\t\ttimeout.skip();\n\t\t\t}\n\t\t})\n\n\t\ttry {\n\t\t\tconsole.log('Waiting for frame load:', request.pageUrl);\n\t\t\tconst outcome = await Promise.any([frameLoadPromise, timeout.promise]);\n\t\t\tif (outcome === PromiseTimeoutMarker) {\n\t\t\t\tconsole.error('Frame load timed out:', request.pageUrl);\n\t\t\t\tif (request.status() === 'loading') {\n\t\t\t\t\trequest.markAsError(new Error('Failed to load page: timed out.'));\n\t\t\t\t}\n\t\t\t\t$iframe.remove();\n\t\t\t\treturn none;\n\t\t\t} else {\n\t\t\t\tconsole.log('Frame loaded:', request.pageUrl, outcome);\n\t\t\t\treturn some(new LoadedPage(request, outcome, $iframe));\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error('Frame load failed:', request.pageUrl, error);\n\t\t\tif (error instanceof Error) {\n\t\t\t\trequest.markAsError(error);\n\t\t\t} else {\n\t\t\t\trequest.markAsError(new Error('Unknown error'));\n\t\t\t}\n\t\t\t$iframe.remove();\n\t\t\treturn none;\n\t\t} finally {\n\t\t\tkoSubscription.dispose();\n\t\t}\n\t}\n\n\taddCrawlRequest(request: CrawlRequest): boolean {\n\t\tif (!this.canCrawlUrl(request.pageUrl)) {\n\t\t\tconsole.warn('Cannot add request to queue: URL is not allowed.', request.pageUrl);\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!request.transitionStatus('queued')) {\n\t\t\tthrow new Error('Cannot add request to queue: invalid request status \"' + request.status() + '\".');\n\t\t}\n\n\t\tthis.addedUrls.add(request.pageUrl);\n\n\t\tthis.pendingCrawlRequests.add(request);\n\t\tthis.crawlRequestQueue.add(request);\n\n\t\tthis.onRequestAdded(request);\n\n\t\tconst koSubscription = request.status.subscribe(status => {\n\t\t\tif (FinalCrawlRequestStatuses.includes(status)) {\n\t\t\t\tthis.finishedRequests.add(request);\n\t\t\t\tthis.crawlRequestQueue.delete(request);\n\t\t\t\tthis.pendingCrawlRequests.delete(request);\n\t\t\t\tkoSubscription.dispose();\n\t\t\t}\n\t\t});\n\t\treturn true;\n\t}\n\n\tprivate nextAnimationFramePromise(): Promise<number> {\n\t\treturn new Promise(resolve => requestAnimationFrame(resolve));\n\t}\n\n\tprivate async withTimeout<T>(timeout: number, promise?: Promise<T>): Promise<Option<T>> {\n\t\tconst timeoutInstance = this.createSkippableTimeout(timeout);\n\n\t\tconst promises: Promise<typeof PromiseTimeoutMarker | T>[] = [timeoutInstance.promise];\n\t\tif (promise) {\n\t\t\tpromises.push(promise);\n\t\t}\n\n\t\tconst promiseValue = await Promise.any(promises);\n\t\t//Stop the timeout if it hasn't already been finished.\n\t\ttimeoutInstance.skip();\n\n\t\tif (promiseValue === PromiseTimeoutMarker) {\n\t\t\treturn none;\n\t\t}\n\t\treturn some(promiseValue);\n\t}\n\n\tprivate createSkippableTimeout(duration: number): SkippableTimeout {\n\t\tconst timeout = new SkippableTimeout(duration);\n\t\tthis.pendingTimeouts.add(timeout);\n\t\ttimeout.promise.finally(() => {\n\t\t\tthis.pendingTimeouts.delete(timeout);\n\t\t});\n\t\treturn timeout;\n\t}\n\n\tprivate maybeAddToQueue(item: SearchableItem, originatingRequest: CrawlRequest) {\n\t\tif (!(item instanceof DashboardItem)) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (originatingRequest.depth >= this.crawlDepthLimit) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet reason: string = '';\n\n\t\t//For now, we only recognize tabs and filters. Admin menu items are handled elsewhere.\n\t\tconst targetType = item.getTargetType();\n\t\tconst allowedTargetTypes: ItemTargetType[] = ['tab', 'filter'];\n\t\tif (allowedTargetTypes.includes(targetType)) {\n\t\t\tconst displayLabel = item.ownLabel || item.label;\n\t\t\treason = 'Found ' + targetType + ' \"' + displayLabel + '\" on page ' + originatingRequest.relativePageUrl;\n\t\t} else {\n\t\t\treturn;\n\t\t}\n\n\t\tconst possiblyRelativeUrl = item.getEffectiveTargetUrl();\n\t\tif (!possiblyRelativeUrl) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetUrl = this.normalizeUrl(possiblyRelativeUrl, originatingRequest.pageUrl);\n\t\t// console.log('Checking target URL:', targetUrl);\n\t\tif (!this.canCrawlUrl(targetUrl)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst location = item.getLocation().slice();\n\t\t//Add the name of the tab or filter to the location. This will be used to display a more\n\t\t//detailed path in the search results. For example, \"Menu -> Submenu -> Tab Name\".\n\t\tif ((targetType === 'tab') || (targetType === 'filter')) {\n\t\t\tif (item.ownLabel) {\n\t\t\t\tlocation.push(item.ownLabel);\n\t\t\t}\n\t\t}\n\n\t\tconst newRequest = new CrawlRequest(\n\t\t\titem.getMenuUrl() || '',\n\t\t\ttargetUrl,\n\t\t\tthis.adminUrl,\n\t\t\tlocation,\n\t\t\toriginatingRequest.depth + 1,\n\t\t\treason\n\t\t);\n\n\t\tif (this.addCrawlRequest(newRequest)) {\n\t\t\toriginatingRequest.addChildRequest(newRequest);\n\t\t}\n\t}\n\n\tprivate normalizeUrl(url: string, baseUrl: string): string {\n\t\tconst parsed = new URL(url, baseUrl);\n\t\t//URLs that only differ by hash are considered the same.\n\t\tparsed.hash = '';\n\t\t//Remove known temporary query parameters.\n\t\tfor (const param of this.removableQueryParams) {\n\t\t\tparsed.searchParams.delete(param);\n\t\t}\n\t\treturn parsed.toString();\n\t}\n\n\tprivate canCrawlUrl(url: string | URL): boolean {\n\t\tif (typeof url === 'string') {\n\t\t\turl = new URL(url);\n\t\t}\n\n\t\t//Only HTTP(S) URLs are allowed.\n\t\tif (!['http:', 'https:'].includes(url.protocol)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//The URL should have the same origin as the admin URL.\n\t\tif (url.origin !== this.adminUrl.origin) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//And also the same path prefix (e.g. \"/wp-admin/\").\n\t\tif (!url.pathname.startsWith(this.adminUrl.pathname)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t//Check the blacklist.\n\t\tif (this.urlBlacklist.isBlacklisted(url.pathname)) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !this.addedUrls.has(url.toString());\n\t}\n\n\tprivate addFoundItem(menuUrl: string, item: SearchableItem) {\n\t\tif (item instanceof DashboardItem) {\n\t\t\tconst itemMenuUrl = item.getMenuUrl();\n\t\t\tif (itemMenuUrl) {\n\t\t\t\tmenuUrl = itemMenuUrl;\n\t\t\t}\n\t\t}\n\n\t\tlet menuItems = this.itemsByMenuUrl.get(menuUrl);\n\t\tif (!menuItems) {\n\t\t\tmenuItems = new Map();\n\t\t\tthis.itemsByMenuUrl.set(menuUrl, menuItems);\n\t\t}\n\n\t\tconst id = item.getUniqueId();\n\t\tif (!menuItems.has(id)) {\n\t\t\tmenuItems.set(id, item);\n\t\t}\n\t}\n\n\tgetFoundItems(menuUrl: string): Iterable<SearchableItem> {\n\t\tconst items = this.itemsByMenuUrl.get(menuUrl);\n\t\tif (items) {\n\t\t\treturn items.values();\n\t\t}\n\t\treturn [];\n\t}\n\n\tprivate stopCrawler(reason: 'completed' | 'stopped') {\n\t\tthis.state(reason);\n\n\t\tfor (const timeout of this.pendingTimeouts) {\n\t\t\ttimeout.skip();\n\t\t}\n\t\tfor (const request of this.crawlRequestQueue) {\n\t\t\trequest.abort();\n\t\t}\n\t\tfor (const request of this.pendingCrawlRequests) {\n\t\t\trequest.abort();\n\t\t}\n\t}\n\n\tstop() {\n\t\tthis.stopCrawler('stopped');\n\t}\n\n\tgetState(): CrawlerState {\n\t\treturn this.state();\n\t}\n\n\tgetFinishedRequestCount(): number {\n\t\treturn this.finishedRequests.size;\n\t}\n\n\tgetTotalRequestCount(): number {\n\t\treturn this.pendingCrawlRequests.size + this.finishedRequests.size;\n\t}\n}\n\n\nconst PromiseTimeoutMarker: unique symbol = Symbol('AmePromiseTimeoutMarker');\n\nclass SkippableTimeout {\n\tprivate timeoutId: ReturnType<typeof setTimeout> | null = null;\n\tpublic readonly promise: Promise<typeof PromiseTimeoutMarker>;\n\tprivate resolve: null | ((value: typeof PromiseTimeoutMarker) => void) = null;\n\n\tconstructor(duration: number) {\n\t\tthis.promise = new Promise(resolve => {\n\t\t\tthis.resolve = resolve;\n\t\t\tthis.timeoutId = setTimeout(() => {\n\t\t\t\tthis.timeoutId = null;\n\t\t\t\tthis.resolve = null;\n\t\t\t\tresolve(PromiseTimeoutMarker);\n\t\t\t}, duration);\n\t\t});\n\t}\n\n\tskip() {\n\t\tif (this.timeoutId) {\n\t\t\tclearTimeout(this.timeoutId);\n\t\t\tthis.timeoutId = null;\n\t\t}\n\t\tif (this.resolve) {\n\t\t\tthis.resolve(PromiseTimeoutMarker);\n\t\t\tthis.resolve = null;\n\t\t}\n\t}\n}\n\nexport type CrawlRequestStatus = 'queued' | 'loading' | 'loaded' | 'scanning' | 'error' | 'aborted' | 'completed';\nconst AllCrawlRequestStatuses: CrawlRequestStatus[] = ['queued', 'loading', 'loaded', 'scanning', 'error', 'aborted', 'completed'];\nconst RequestProgressSequence: CrawlRequestStatus[] = ['queued', 'loading', 'loaded', 'scanning'];\nexport const FinalCrawlRequestStatuses: CrawlRequestStatus[] = ['error', 'aborted', 'completed'];\n\ninterface RequestTreeStatusSummary {\n\tselfStopped: boolean;\n\ttreeStopped: boolean;\n\ttotalRequests: number;\n\tstatuses: Record<CrawlRequestStatus, number>;\n}\n\nconst EmptyStatusCounts: Record<CrawlRequestStatus, number> = {\n\tqueued: 0,\n\tloading: 0,\n\tloaded: 0,\n\tscanning: 0,\n\terror: 0,\n\taborted: 0,\n\tcompleted: 0\n};\n\nexport class CrawlRequest {\n\tprivate readonly internalStatus: KnockoutObservable<CrawlRequestStatus> = ko.observable<CrawlRequestStatus>('queued');\n\tpublic readonly status: KnockoutComputed<CrawlRequestStatus> = ko.pureComputed(() => {\n\t\treturn this.internalStatus();\n\t});\n\n\tprivate _currentError: Option<Error> = none;\n\n\tprivate readonly foundItems: KoObservableSet<SearchableItem> = new KoObservableSet<SearchableItem>();\n\tpublic readonly totalItems: KnockoutComputed<number> = ko.pureComputed(() => {\n\t\treturn this.foundItems.size;\n\t});\n\tpublic readonly totalTreeItems: KnockoutComputed<number> = ko.pureComputed(() => {\n\t\tlet total = this.totalItems();\n\t\tfor (const child of this.childRequests) {\n\t\t\ttotal += child.totalTreeItems();\n\t\t}\n\t\treturn total;\n\t});\n\n\tpublic readonly relativePageUrl: string;\n\tpublic readonly childRequests: KoObservableSet<CrawlRequest> = new KoObservableSet<CrawlRequest>();\n\tpublic readonly itemCssClass: KnockoutComputed<string>;\n\n\tpublic readonly statusSummary: KnockoutComputed<RequestTreeStatusSummary> = ko.pureComputed(() => {\n\t\tconst statuses = Object.assign({}, EmptyStatusCounts);\n\t\tstatuses[this.status()]++;\n\n\t\tconst selfStopped = this.isFinished;\n\t\tlet treeStopped = selfStopped;\n\t\tlet totalRequests = 1;\n\n\t\tfor (const child of this.childRequests) {\n\t\t\tconst childSummary = child.statusSummary();\n\t\t\tfor (const status of AllCrawlRequestStatuses) {\n\t\t\t\tstatuses[status] += childSummary.statuses[status];\n\t\t\t}\n\n\t\t\ttotalRequests += childSummary.totalRequests;\n\t\t\ttreeStopped = treeStopped && childSummary.treeStopped;\n\t\t}\n\n\t\treturn {\n\t\t\tselfStopped,\n\t\t\ttreeStopped,\n\t\t\ttotalRequests,\n\t\t\tstatuses\n\t\t};\n\t});\n\n\tpublic readonly isTreeInProgress: KnockoutComputed<boolean> = ko.pureComputed(() => {\n\t\tconst children = this.childRequests.items()();\n\t\treturn (!this.isFinished || children.some(child => child.isTreeInProgress()));\n\t});\n\n\tpublic readonly isTreeCompletedOrError: KnockoutComputed<boolean> = ko.pureComputed(() => {\n\t\t//Note that the \"aborted\" status is not included here. An aborted request is no longer\n\t\t//in progress, but it's not really \"done\" since it was stopped prematurely. Any results\n\t\t//should be considered incomplete.\n\n\t\tconst thisIsDone = ((this.status() === 'completed') || (this.status() === 'error'));\n\t\tconst children = this.childRequests.items()();\n\t\treturn thisIsDone && children.every(child => child.isTreeCompletedOrError());\n\t});\n\n\tconstructor(\n\t\t/**\n\t\t * Relative menu item URL.\n\t\t */\n\t\tpublic readonly menuUrl: string,\n\t\t/**\n\t\t * Full page URL.\n\t\t */\n\t\tpublic readonly pageUrl: string,\n\t\tpublic readonly adminUrl: URL,\n\t\tpublic readonly location: ItemLocation,\n\t\tpublic readonly depth: number = 0,\n\t\t/**\n\t\t * Human-readable reason for the request being created.\n\t\t * For example, it could mention that a tab or filter was found on a specific page.\n\t\t */\n\t\tpublic readonly reason: string = '',\n\t\tpublic readonly componentAndVersion: string | null = null\n\t) {\n\t\tthis.itemCssClass = ko.pureComputed(() => {\n\t\t\treturn 'ame-qs-crawl-request-is-' + this.internalStatus();\n\t\t});\n\n\t\tconst adminUrlString = adminUrl.toString();\n\t\tif (pageUrl.startsWith(adminUrlString)) {\n\t\t\tthis.relativePageUrl = pageUrl.slice(adminUrlString.length);\n\t\t} else {\n\t\t\tthis.relativePageUrl = pageUrl;\n\t\t}\n\t}\n\n\ttransitionStatus(newStatus: CrawlRequestStatus) {\n\t\tconst currentStatus = this.internalStatus();\n\t\tif (currentStatus === newStatus) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.isFinalStatus(currentStatus)) {\n\t\t\tconsole.error(\n\t\t\t\t`Cannot transition to new status \"${newStatus}\" after reaching final status \"${this.internalStatus()}\".`,\n\t\t\t\tthis\n\t\t\t);\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.isFinalStatus(newStatus)) {\n\t\t\tthis.internalStatus(newStatus);\n\t\t\treturn true;\n\t\t}\n\n\t\t//Both the current and new statuses are non-final. Is this a valid transition?\n\t\tconst currentStatusIndex = RequestProgressSequence.indexOf(currentStatus);\n\t\tconst newStatusIndex = RequestProgressSequence.indexOf(newStatus);\n\t\tif (newStatusIndex <= currentStatusIndex) {\n\t\t\tconsole.error(\n\t\t\t\t`Cannot transition from status \"${currentStatus}\" to new status \"${newStatus}\": out of order.`,\n\t\t\t\tthis\n\t\t\t);\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.internalStatus(newStatus);\n\t\treturn true;\n\t}\n\n\tabort() {\n\t\tthis.transitionStatus('aborted');\n\t}\n\n\tprivate isFinalStatus(status: CrawlRequestStatus): boolean {\n\t\treturn FinalCrawlRequestStatuses.includes(status);\n\t}\n\n\tmarkAsError(error: Error) {\n\t\tconst currentStatus = this.internalStatus();\n\t\tif (!this.isFinalStatus(currentStatus)) {\n\t\t\tthis._currentError = some(error);\n\t\t\tthis.transitionStatus('error');\n\t\t}\n\t}\n\n\tget currentError(): AmeMiniFunc.Option<Error> {\n\t\treturn this._currentError;\n\t}\n\n\tget errorMessage(): string {\n\t\treturn this._currentError.map(error => error.message).getOrElse(() => '');\n\t}\n\n\tget isFinished(): boolean {\n\t\treturn this.isFinalStatus(this.internalStatus());\n\t}\n\n\taddItem(item: SearchableItem) {\n\t\tthis.foundItems.add(item);\n\t}\n\n\tgetItems(): Iterable<SearchableItem> {\n\t\treturn this.foundItems;\n\t}\n\n\taddChildRequest(request: CrawlRequest) {\n\t\tthis.childRequests.add(request);\n\t}\n\n\tonceStatus(status: CrawlRequestStatus | CrawlRequestStatus[], callback: () => void) {\n\t\tif (!Array.isArray(status)) {\n\t\t\tstatus = [status];\n\t\t}\n\n\t\tif (status.includes(this.status())) {\n\t\t\tcallback();\n\t\t\treturn;\n\t\t}\n\n\t\tlet subscription: KnockoutSubscription | null = null;\n\t\tsubscription = this.status.subscribe(newStatus => {\n\t\t\tif (status.includes(newStatus)) {\n\t\t\t\tsubscription?.dispose();\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t}\n\n\tonceStopped(callback: () => void) {\n\t\tthis.onceStatus(['aborted', 'error', 'completed'], callback);\n\t}\n\n\tonceTreeStopped(callback: (anyRequestsAborted: boolean, summary: RequestTreeStatusSummary) => void) {\n\t\tlet isStopped = ko.computed(() => {\n\t\t\tconst summary = this.statusSummary();\n\t\t\tif (summary.treeStopped) {\n\t\t\t\tcallback(summary.statuses.aborted > 0, summary);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tif (isStopped()) {\n\t\t\tisStopped.dispose();\n\t\t} else {\n\t\t\tisStopped.subscribe(value => {\n\t\t\t\tif (value) {\n\t\t\t\t\tisStopped.dispose();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\nclass LoadedPage {\n\tconstructor(\n\t\tpublic readonly crawlRequest: CrawlRequest,\n\t\tpublic readonly $root: JQuery,\n\t\tpublic readonly $iframe: JQuery\n\t) {\n\t\tcrawlRequest.transitionStatus('loaded');\n\t}\n}\n\nexport class CrawlerUrlBlacklist {\n\tconstructor(private readonly blacklist: RegExp[]) {\n\t}\n\n\tisBlacklisted(relativeAdminUrl: string): boolean {\n\t\t//As of this writing, all WordPress admin page URLs I've seen point to PHP files.\n\t\t//If the URL doesn't contain \".php\", it's probably not a valid admin page.\n\t\tif (!this.containsPhpExtension(relativeAdminUrl)) {\n\t\t\treturn true;\n\t\t}\n\n\t\t//Check the blacklist.\n\t\treturn this.blacklist.some(pattern => pattern.test(relativeAdminUrl));\n\t}\n\n\tcontainsPhpExtension(input: string): boolean {\n\t\treturn input.includes('.php');\n\t}\n}\n\n","import {AdminMenuItem, DashboardItem, SearchableItem} from './items';\nimport {CrawlRequestStatus, FinalCrawlRequestStatuses} from './crawler';\nimport Option = AmeMiniFunc.Option;\nimport none = AmeMiniFunc.none;\nimport some = AmeMiniFunc.some;\nimport {PromiseQueueItem} from './utils';\nimport * as _ from 'lodash-es';\nimport Cookies from 'js-cookie';\nimport forEachObjectKey = AmeMiniFunc.forEachObjectKey;\n\ntype UsageStores = 'menuVisits' | 'pageVisits' | 'itemActions';\n\nexport class ItemUsageTracker {\n\tprivate readonly storeValues: Record<UsageStores, Map<string, number> | null> = {\n\t\tmenuVisits: null,\n\t\tpageVisits: null,\n\t\titemActions: null\n\t};\n\n\tprivate readonly hardSizeLimit: number;\n\n\tconstructor(\n\t\tprivate readonly storePrefix: string, //Should be unique to the site on the current domain.\n\t\tprivate readonly softSizeLimit: number,\n\t\tprivate readonly cookiePath: string\n\t) {\n\t\tif (softSizeLimit < 1) {\n\t\t\tthrow new Error('The soft size limit must be at least 1.');\n\t\t}\n\t\tthis.hardSizeLimit = softSizeLimit * 2 + 1;\n\t}\n\n\tasync populateUsageTimestamps(items: Iterable<SearchableItem>) {\n\t\t//Load all the caches at once to avoid having to use multiple async calls\n\t\t//for each item.\n\t\tconst caches = {\n\t\t\tmenuVisits: await this.getStore('menuVisits'),\n\t\t\tpageVisits: await this.getStore('pageVisits'),\n\t\t\titemActions: await this.getStore('itemActions')\n\t\t};\n\n\t\tfor (const item of items) {\n\t\t\tif (item.lastUsedAt < 0) {\n\t\t\t\tconst value = caches.itemActions.get(item.getUniqueId());\n\t\t\t\titem.lastUsedAt = (typeof value === 'number') ? value : 0;\n\t\t\t}\n\n\t\t\tif (item.lastVisitedAt < 0) {\n\t\t\t\tif (item instanceof AdminMenuItem) {\n\t\t\t\t\tconst value = caches.menuVisits.get(item.getRelativeMenuUrl());\n\t\t\t\t\titem.lastVisitedAt = (typeof value === 'number') ? value : 0;\n\t\t\t\t} else if (item instanceof DashboardItem) {\n\t\t\t\t\t//Does this item link to a page as a whole, not to a specific element?\n\t\t\t\t\t//In that case, we can use the \"last visited\" timestamp for the page.\n\t\t\t\t\tconst pageUrl = item.getEffectiveTargetUrl();\n\t\t\t\t\tif (pageUrl && !item.getSelector()) {\n\t\t\t\t\t\tconst value = caches.pageVisits.get(pageUrl);\n\t\t\t\t\t\titem.lastVisitedAt = (typeof value === 'number') ? value : 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tasync recordMenuVisit(relativeMenuUrl: string) {\n\t\tawait this.setTimestampInStore('menuVisits', relativeMenuUrl, Date.now());\n\t}\n\n\tasync recordPageVisit(relativePageUrl: string) {\n\t\tawait this.setTimestampInStore('pageVisits', relativePageUrl, Date.now());\n\t}\n\n\tasync recordItemAction(item: SearchableItem) {\n\t\tif (item instanceof DashboardItem) {\n\t\t\t/*\n\t\t\tIn addition to storing the last-used timestamp locally, let's also let the server know\n\t\t\twhen a dashboard item is used. The plugin will later use this to preload recent items\n\t\t\tso that they're available without waiting for an AJAX request.\n\n\t\t\tWe store timestamps in a session cookie. The PHP script will read the cookie and update\n\t\t\tthe database on the next page load, then delete the cookie.\n\t\t\t*/\n\t\t\tlet pendingUpdates: Record<string, number> = {};\n\n\t\t\tconst cookieName = 'ame-qs-used-db-items';\n\t\t\tconst serializedUpdates = Cookies.get(cookieName);\n\t\t\tif (serializedUpdates) {\n\t\t\t\ttry {\n\t\t\t\t\tpendingUpdates = JSON.parse(serializedUpdates);\n\t\t\t\t\tif (!pendingUpdates || (typeof pendingUpdates !== 'object')) {\n\t\t\t\t\t\tpendingUpdates = {};\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Failed to parse pending item updates:', e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst key = item.getMenuUrl() + '\\n' + item.getRelativeId();\n\t\t\tpendingUpdates[key] = Math.round(Date.now() / 1000);\n\t\t\tCookies.set(cookieName, JSON.stringify(pendingUpdates), {sameSite: 'Lax', path: this.cookiePath});\n\t\t}\n\n\t\tawait this.setTimestampInStore('itemActions', item.getUniqueId(), Date.now());\n\t}\n\n\tprivate async getStore(store: UsageStores): Promise<Map<string, number>> {\n\t\tlet cache = this.storeValues[store];\n\t\tif (!cache) {\n\t\t\t//Try to load from local storage.\n\t\t\tconst serialized = localStorage.getItem(this.getFullStoreKey(store));\n\t\t\tif (serialized) {\n\t\t\t\ttry {\n\t\t\t\t\tconst parsed = JSON.parse(serialized);\n\t\t\t\t\tif (parsed && (typeof parsed === 'object')) {\n\t\t\t\t\t\tcache = new Map<string, number>(Object.entries(parsed));\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error('Failed to parse usage store:', e);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!cache) {\n\t\t\t\tcache = new Map<string, number>();\n\t\t\t\tthis.storeValues[store] = cache;\n\t\t\t}\n\t\t}\n\t\treturn cache;\n\t}\n\n\tprivate async getTimestampFromStore(store: UsageStores, key: string): Promise<number> {\n\t\tconst cache = await this.getStore(store);\n\t\tconst value = cache.get(key);\n\t\tif ((typeof value === 'number') && (value > 0)) {\n\t\t\treturn value;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprivate async setTimestampInStore(store: UsageStores, key: string, timestamp: number) {\n\t\tconst cache = await this.getStore(store);\n\t\tcache.set(key, timestamp);\n\n\t\t//Prune old entries if over the hard limit.\n\t\tif (cache.size > this.hardSizeLimit) {\n\t\t\tconst entries = Array.from(cache.entries());\n\t\t\tentries.sort((a, b) => a[1] - b[1]);\n\t\t\tconst toDelete = entries.slice(0, entries.length - this.softSizeLimit);\n\t\t\tfor (const [key] of toDelete) {\n\t\t\t\tcache.delete(key);\n\t\t\t}\n\t\t}\n\n\t\t//Save to local storage.\n\t\tconst serialized = JSON.stringify(Object.fromEntries(cache.entries()));\n\t\tlocalStorage.setItem(this.getFullStoreKey(store), serialized);\n\t}\n\n\tprivate getFullStoreKey(store: UsageStores): string {\n\t\treturn 'ameQsTs:' + this.storePrefix + ':' + store;\n\t}\n}\n\nexport interface UrlCrawlRecord {\n\turl: string;\n\tisMenuItem: boolean;\n\n\tlastAttemptAt: number;\n\tlastAttemptStatus: CrawlRequestStatus | null;\n\tlastFinishedAttemptAt: number;\n\tlastFinishedAttemptStatus: CrawlRequestStatus | null;\n\n\t//These properties are for the last attempt.\n\tdepth: number;\n\treason: string | null;\n\tcomponentAndVersion: string | null; //E.g. \"plugin:foo/bar.php:1.2.3\"\n\terrorMessage: string | null;\n}\n\nexport class DashboardCrawlerDb {\n\tprivate readonly records: Map<string, Option<UrlCrawlRecord>> = new Map();\n\n\tconstructor(\n\t\tprivate readonly ajaxUrl: string,\n\t\tprivate readonly ajaxNonceMap: Record<string, string>,\n\t\tpreloadedRecords?: Record<string, UrlCrawlRecord | null>\n\t) {\n\t\tif (preloadedRecords) {\n\t\t\tforEachObjectKey(preloadedRecords, (url, record) => {\n\t\t\t\tif (record) {\n\t\t\t\t\tthis.records.set(url, some(record));\n\t\t\t\t} else {\n\t\t\t\t\tthis.records.set(url, none);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tasync prefetchUrlRecords(urls: string[]) {\n\t\tconst uniqueUrls = Array.from(new Set(urls));\n\n\t\tconst missingUrls = uniqueUrls.filter(url => !this.records.has(url));\n\t\tif (missingUrls.length > 0) {\n\t\t\tconsole.log('Prefetching URL records:', missingUrls);\n\t\t\tconst promises = missingUrls.map(url => this.getRecord(url));\n\t\t\tconst results = await Promise.all(promises);\n\t\t\tconsole.log('Prefetched URL records:', missingUrls, results);\n\t\t}\n\t}\n\n\tasync getRecord(url: string): Promise<Option<UrlCrawlRecord>> {\n\t\tconst record = this.records.get(url);\n\t\tif (record) {\n\t\t\treturn record;\n\t\t}\n\n\t\tconst fetched = await this.fetchCrawlRecord(url);\n\t\t//Check if the record was already fetched by another call while we were waiting.\n\t\tconst existing = this.records.get(url);\n\t\tif (existing) {\n\t\t\treturn existing;\n\t\t} else {\n\t\t\t//Cache the fetched record.\n\t\t\tthis.records.set(url, fetched);\n\t\t\treturn fetched;\n\t\t}\n\t}\n\n\tasync setRecord(record: UrlCrawlRecord) {\n\t\tthis.records.set(record.url, some(record));\n\t\tthis.queueCrawlRecordSave(record.url);\n\t}\n\n\t/**\n\t * Returns the time since the last finished crawl attempt for the given URL.\n\t *\n\t * @param url\n\t * @returns Time in milliseconds, or Infinity if the URL has never been crawled.\n\t */\n\tasync getTimeSinceLastFinishedCrawl(url: string): Promise<number> {\n\t\tconst record = await this.getRecord(url);\n\t\tif (record.isDefined()) {\n\t\t\treturn Date.now() - (record.get().lastFinishedAttemptAt * 1000);\n\t\t}\n\t\treturn Number.POSITIVE_INFINITY;\n\t}\n\n\tasync getTimeSinceLastAttempt(url: string): Promise<number> {\n\t\tconst record = await this.getRecord(url);\n\t\tif (record.isDefined()) {\n\t\t\treturn Date.now() - (record.get().lastAttemptAt * 1000);\n\t\t}\n\t\treturn Number.POSITIVE_INFINITY;\n\t}\n\n\tasync getComponentVersion(url: string): Promise<string | null> {\n\t\tconst record = await this.getRecord(url);\n\t\tif (record.isDefined()) {\n\t\t\treturn record.get().componentAndVersion;\n\t\t}\n\t\treturn null;\n\t}\n\n\tasync getLastAttemptDate(url: string): Promise<Date | null> {\n\t\tconst recordOption = await this.getRecord(url);\n\t\tif (recordOption.isDefined()) {\n\t\t\tconst record = recordOption.get();\n\t\t\tif (record.lastAttemptAt > 0) {\n\t\t\t\treturn new Date(record.lastAttemptAt * 1000);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns the last attempt date for the given URL, if it's cached.\n\t * Does not fetch the record from the server, so it's synchronous and fast.\n\t *\n\t * @param url\n\t */\n\tgetCachedLastAttemptDate(url: string): Date | null {\n\t\tconst recordOption = this.records.get(url);\n\t\tif (recordOption && recordOption.isDefined()) {\n\t\t\tconst record = recordOption.get();\n\t\t\tif (record.lastAttemptAt > 0) {\n\t\t\t\treturn new Date(record.lastAttemptAt * 1000);\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\treturn null;\n\t}\n\n\tasync recordMenuAttemptStart(\n\t\turl: string,\n\t\tdepth: number = 0,\n\t\treason: string | null,\n\t\tcomponentAndVersion: string | null\n\t) {\n\t\tlet record = (await this.getRecord(url)).getOrElse(() => {\n\t\t\treturn {\n\t\t\t\turl: url,\n\t\t\t\tisMenuItem: true,\n\t\t\t\tlastAttemptAt: 0,\n\t\t\t\tlastAttemptStatus: null,\n\t\t\t\tlastFinishedAttemptAt: 0,\n\t\t\t\tlastFinishedAttemptStatus: null,\n\t\t\t\tdepth: 0,\n\t\t\t\treason: null,\n\t\t\t\tcomponentAndVersion: null,\n\t\t\t\terrorMessage: null\n\t\t\t} satisfies UrlCrawlRecord;\n\t\t});\n\n\t\trecord.isMenuItem = true;\n\t\trecord.lastAttemptAt = Math.round(Date.now() / 1000);\n\t\trecord.lastAttemptStatus = null;\n\t\trecord.depth = depth;\n\t\trecord.reason = reason;\n\t\trecord.componentAndVersion = componentAndVersion;\n\t\trecord.errorMessage = null;\n\n\t\tawait this.setRecord(record);\n\t}\n\n\tasync recordMenuAttemptEnd(\n\t\turl: string,\n\t\tstatus: CrawlRequestStatus,\n\t\terrorMessage: string = '',\n\t\tfinished: boolean | null = null\n\t) {\n\t\tif (finished === null) {\n\t\t\tfinished = (status !== 'aborted') && FinalCrawlRequestStatuses.includes(status);\n\t\t}\n\n\t\tconst maybeRecord = await this.getRecord(url);\n\t\tif (maybeRecord.isEmpty()) {\n\t\t\tconsole.error('Cannot record attempt end for a previously unsaved URL:', url, status);\n\t\t\treturn;\n\t\t}\n\t\tconst record = maybeRecord.get();\n\n\t\trecord.lastAttemptStatus = status;\n\t\trecord.errorMessage = errorMessage;\n\n\t\tif (finished) {\n\t\t\trecord.lastFinishedAttemptAt = Math.round(Date.now() / 1000);\n\t\t\trecord.lastFinishedAttemptStatus = status;\n\t\t}\n\n\t\tawait this.setRecord(record);\n\t}\n\n\tprivate readonly pendingCrawlRecordFetches: Map<string, PromiseQueueItem<Option<UrlCrawlRecord>>[]> = new Map();\n\n\tprivate fetchPendingCrawlRecords() {\n\t\tconst queue = new Map(this.pendingCrawlRecordFetches.entries());\n\t\tthis.pendingCrawlRecordFetches.clear();\n\n\t\tif (queue.size === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst urls = Array.from(queue.keys());\n\t\tconsole.log('Fetching crawl records for URLs:', urls);\n\n\t\tconst request = jQuery.ajax({\n\t\t\turl: this.ajaxUrl,\n\t\t\tmethod: 'POST', //GET would be more appropriate, but we may have too many URLs.\n\t\t\tdata: {\n\t\t\t\taction: 'ws-ame-qs-get-crawl-records',\n\t\t\t\t_ajax_nonce: this.ajaxNonceMap['ws-ame-qs-get-crawl-records'],\n\t\t\t\turls: JSON.stringify(urls)\n\t\t\t},\n\t\t\tdataType: 'json'\n\t\t});\n\n\t\trequest.done((response: any) => {\n\t\t\tif (!response.success) {\n\t\t\t\tconsole.error('Failed to fetch crawl records (response.success is not true):', response);\n\t\t\t\tconst error = new Error('Failed to fetch crawl records.');\n\t\t\t\tqueue.forEach((items) => {\n\t\t\t\t\titems.forEach(item => item.reject(error));\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst data: Record<string, UrlCrawlRecord> = response.data;\n\t\t\tqueue.forEach((items, urls) => {\n\t\t\t\tconst record = data[urls];\n\t\t\t\tif (record) {\n\t\t\t\t\titems.forEach(item => item.resolve(some(record)));\n\t\t\t\t} else {\n\t\t\t\t\titems.forEach(item => item.resolve(none));\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\n\t\trequest.fail((_, textStatus, errorThrown) => {\n\t\t\tconsole.error('Failed to fetch crawl records:', textStatus, errorThrown);\n\t\t\tconst error = new Error('Failed to fetch crawl records.');\n\t\t\tqueue.forEach((items) => {\n\t\t\t\titems.forEach(item => item.reject(error));\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate readonly throttledFetchCrawlRecords = _.debounce(\n\t\t_.throttle(\n\t\t\t() => this.fetchPendingCrawlRecords(),\n\t\t\t2000,\n\t\t\t{leading: true, trailing: true}\n\t\t),\n\t\t200,\n\t\t{leading: false, trailing: true}\n\t);\n\n\tprivate fetchCrawlRecord(urls: string): Promise<Option<UrlCrawlRecord>> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst queueItem: PromiseQueueItem<Option<UrlCrawlRecord>> = {\n\t\t\t\tresolve: resolve,\n\t\t\t\treject: reject\n\t\t\t};\n\n\t\t\tconst queue = this.pendingCrawlRecordFetches.get(urls);\n\t\t\tif (queue) {\n\t\t\t\tqueue.push(queueItem);\n\t\t\t} else {\n\t\t\t\tthis.pendingCrawlRecordFetches.set(urls, [queueItem]);\n\t\t\t}\n\n\t\t\tthis.throttledFetchCrawlRecords();\n\t\t});\n\t}\n\n\tprivate readonly pendingCrawlRecordSaves: Set<string> = new Set();\n\n\tprivate storePendingCrawlRecords() {\n\t\tconst urls = Array.from(this.pendingCrawlRecordSaves);\n\t\tthis.pendingCrawlRecordSaves.clear();\n\n\t\tconst records: Record<string, UrlCrawlRecord> = {};\n\t\tlet anyRecordsFound: boolean = false;\n\t\turls.forEach(url => {\n\t\t\tconst record = this.records.get(url);\n\t\t\tif (record && record.isDefined()) {\n\t\t\t\trecords[url] = record.get();\n\t\t\t\tanyRecordsFound = true;\n\t\t\t}\n\t\t});\n\n\t\tif (!anyRecordsFound) {\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.log('Saving modified crawl records:', records);\n\n\t\tconst request = jQuery.ajax({\n\t\t\turl: this.ajaxUrl,\n\t\t\tmethod: 'POST',\n\t\t\tdata: {\n\t\t\t\taction: 'ws-ame-qs-set-crawl-records',\n\t\t\t\t_ajax_nonce: this.ajaxNonceMap['ws-ame-qs-set-crawl-records'],\n\t\t\t\trecords: JSON.stringify(records)\n\t\t\t},\n\t\t\tdataType: 'json'\n\t\t});\n\n\t\trequest.done((response: any) => {\n\t\t\tif (!response.success) {\n\t\t\t\tconsole.error('Failed to save crawl records (response.success is not true):', response);\n\t\t\t}\n\t\t});\n\n\t\trequest.fail((_, textStatus, errorThrown) => {\n\t\t\tconsole.error('Failed to save crawl records:', textStatus, errorThrown);\n\t\t});\n\t}\n\n\tprivate readonly throttledSaveCrawlRecords = _.throttle(\n\t\t() => this.storePendingCrawlRecords(),\n\t\t2000,\n\t\t{leading: true, trailing: true}\n\t);\n\n\tprivate queueCrawlRecordSave(ur: string) {\n\t\tthis.pendingCrawlRecordSaves.add(ur);\n\t\tthis.throttledSaveCrawlRecords();\n\t}\n}","import {Selector} from './utils';\n\nexport type ItemTargetType = 'menu' | 'page' | 'tab' | 'filter' | 'section' | 'group' | 'control';\n\nexport type ItemLocation = string[];\nexport type RequestNavigation = (url: string, targetSelector: ItemSelector) => void;\n\nexport type ItemSelector = Selector;\n\nlet itemInstanceCounter = 0;\n\nexport abstract class SearchableItem {\n\tprivate readonly instanceId: number;\n\n\tpublic readonly label: string;\n\tprotected readonly location: ItemLocation = [];\n\n\tpublic lastUsedAt: number = -1;\n\tpublic lastVisitedAt: number = -1;\n\n\tprotected constructor(props: BaseItemProps) {\n\t\tthis.instanceId = itemInstanceCounter++;\n\n\t\tthis.label = props.label;\n\t\tif (props.location) {\n\t\t\tthis.location = props.location;\n\t\t}\n\t}\n\n\tgetUniqueId(): string {\n\t\treturn this.constructor.name + '-' + this.instanceId;\n\t}\n\n\tgetSearchableText(): string {\n\t\treturn this.label;\n\t}\n\n\tperformAction(requestNavigation: RequestNavigation): boolean {\n\t\tconsole.log('Action performed for item:', this);\n\t\treturn true;\n\t}\n\n\tgetMetaLabel(): string {\n\t\treturn '';\n\t}\n\n\tgetLocation(): ItemLocation {\n\t\treturn this.location;\n\t}\n\n\tgetStatusBarText(urlFormatter: (url: string) => string): string  {\n\t\treturn '';\n\t}\n\n\ttoJs(): UnknownSerializedItem {\n\t\treturn {\n\t\t\ttype: this.getSerializedType(),\n\t\t\tlabel: this.label,\n\t\t\tlocation: this.location,\n\t\t};\n\t}\n\n\tprotected abstract getSerializedType(): SerializedItemType;\n}\n\nexport class DashboardItem extends SearchableItem {\n\tprivate readonly origin: DashboardItemProps['origin'];\n\tprivate readonly relativeId: string;\n\tprivate readonly target: DashboardItemProps['target'];\n\tpublic readonly ownLabel: string | null;\n\n\tconstructor(props: DashboardItemProps) {\n\t\tsuper(props);\n\n\t\tthis.origin = props.origin;\n\t\tthis.relativeId = props.relativeId;\n\t\tthis.target = props.target;\n\t\tthis.ownLabel = props.ownLabel || null;\n\t}\n\n\tprotected getSerializedType(): SerializedItemType {\n\t\treturn 'dashboardItem';\n\t}\n\n\tgetUniqueId(): string {\n\t\tconst originUrl = this.origin.menuUrl;\n\t\t/* ^ pageUrl may seem more appropriate here, but then we run into problems with items\n\t\t * that appear on multiple sub-pages of the same menu item, like post type filters.\n\t\t * Each filter has its own URL, and when you go to that URL, the page shows all the filters\n\t\t * again. So by using the page URL in the ID, you would end up with duplicate items.\n\t\t *\n\t\t * Instead, we use the menu URL, which is the same for all the filters (etc) on the same\n\t\t * page. The downside is that genuinely different sub-pages (e.g. tabs) could have different\n\t\t * items that have the same ID. Hopefully, that will be rare.\n\t\t *\n\t\t * If that becomes an issue, maybe the ID registry could be managed at the menu item level,\n\t\t * not the page level. That way similar IDs on different pages under the same menu item\n\t\t * would get deduplicated.\n\t\t */\n\t\treturn 'p:' + originUrl + ':' + this.relativeId;\n\t}\n\n\tperformAction(requestNavigation: RequestNavigation): boolean {\n\t\tconsole.log('Navigating to dashboard item:', this.origin, this.target);\n\n\t\tconst targetUrl = this.getEffectiveTargetUrl();\n\t\trequestNavigation(targetUrl, this.target.selector || '');\n\t\treturn true;\n\t}\n\n\tgetEffectiveTargetUrl(): string {\n\t\treturn this.target.url || this.origin.pageUrl || this.origin.menuUrl;\n\t}\n\n\tgetMenuUrl(): string | null {\n\t\treturn this.origin.menuUrl;\n\t}\n\n\tgetStatusBarText(urlFormatter: (url: string) => string): string {\n\t\tconst targetUrl = this.getEffectiveTargetUrl();\n\t\tif (targetUrl) {\n\t\t\treturn urlFormatter(targetUrl);\n\t\t}\n\t\treturn '';\n\t}\n\n\tgetSelector(): ItemSelector | null {\n\t\treturn this.target.selector || null;\n\t}\n\n\tgetTargetType(): ItemTargetType {\n\t\treturn this.target.type;\n\t}\n\n\tgetRelativeId(): string {\n\t\treturn this.relativeId;\n\t}\n\n\ttoJs(): UnknownSerializedItem {\n\t\tconst result = super.toJs();\n\n\t\t//Serialize the origin and target properties. Filter out redundant URL properties.\n\t\tconst origin: DashboardItemProps['origin'] = {\n\t\t\tmenuUrl: this.origin.menuUrl\n\t\t};\n\t\tif (this.origin.pageUrl && (this.origin.pageUrl !== this.origin.menuUrl)) {\n\t\t\torigin.pageUrl = this.origin.pageUrl;\n\t\t}\n\t\tconst originUrl = origin.pageUrl || origin.menuUrl;\n\n\t\tconst target: DashboardItemProps['target'] = {\n\t\t\ttype: this.target.type\n\t\t};\n\t\tif (this.target.url && (this.target.url !== originUrl)) {\n\t\t\ttarget.url = this.target.url;\n\t\t}\n\t\tif (this.target.selector) {\n\t\t\ttarget.selector = this.target.selector;\n\t\t}\n\n\t\tresult.origin = origin;\n\t\tresult.target = target;\n\t\tresult.relativeId = this.relativeId;\n\n\t\treturn result;\n\t}\n}\n\nexport class AdminMenuItem extends SearchableItem {\n\tprivate readonly menuItemId: string | null = null;\n\tprivate readonly url: string;\n\n\tconstructor(\n\t\tprops: AdminMenuItemProps,\n\t\tprivate readonly titleParts: string[],\n\t\tpublic readonly targetElement: JQuery | null = null,\n\t\tprivate readonly relativeUrl: string | null = null,\n\t\trelativeParentUrl: string | null = null\n\t) {\n\t\tsuper(props);\n\n\t\tthis.url = props.url;\n\t\tif (this.relativeUrl) {\n\t\t\tlet id = this.relativeUrl;\n\t\t\tif (relativeParentUrl) {\n\t\t\t\tid = relativeParentUrl + '>' + id;\n\t\t\t}\n\t\t\tthis.menuItemId = 'adminMenu/' + id;\n\t\t}\n\t}\n\n\tperformAction(requestNavigation: RequestNavigation): boolean {\n\t\tif (this.targetElement && this.targetElement.is('a')) {\n\t\t\t//Follow the link. Counterintuitively, triggering a \"click\" event in jQuery doesn't\n\t\t\t//actually do this. We need to get the DOM element and call click() on it.\n\t\t\tconst link = this.targetElement.get(0);\n\t\t\tconsole.log('Clicking target link:', link);\n\t\t\tlink.click();\n\t\t}\n\n\t\tif (this.url) {\n\t\t\tconsole.log('Navigating to URL:', this.url);\n\t\t\twindow.location.href = this.url;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn super.performAction(requestNavigation);\n\t}\n\n\tgetMetaLabel(): string {\n\t\treturn 'Admin Menu';\n\t}\n\n\tgetUniqueId(): string {\n\t\tif (this.menuItemId) {\n\t\t\treturn this.menuItemId;\n\t\t}\n\t\treturn super.getUniqueId();\n\t}\n\n\tgetTitleParts(): string[] {\n\t\treturn this.titleParts;\n\t}\n\n\tgetUrl(): string {\n\t\treturn this.url;\n\t}\n\n\tgetRelativeMenuUrl(): string {\n\t\treturn this.relativeUrl || '';\n\t}\n\n\tgetStatusBarText(urlFormatter: (url: string) => string): string {\n\t\tif (this.relativeUrl) {\n\t\t\treturn urlFormatter(this.relativeUrl);\n\t\t}\n\t\treturn '';\n\t}\n\n\tprotected getSerializedType(): SerializedItemType {\n\t\treturn 'adminMenuItem';\n\t}\n}\n\nexport class LoadingPlaceholderItem extends SearchableItem {\n\tconstructor() {\n\t\tsuper({\n\t\t\tlabel: 'Loading...',\n\t\t});\n\t}\n\n\tperformAction(_: RequestNavigation): boolean {\n\t\treturn false; //Do nothing and don't close the search box.\n\t}\n\n\tprotected getSerializedType(): SerializedItemType {\n\t\tthrow new Error('Placeholder items cannot be serialized');\n\t}\n}\n\nexport type SerializedItemType = 'link' | 'element' | 'command' | 'adminMenuItem' | 'dashboardItem';\n\ninterface BaseItemProps {\n\tlabel: string;\n\tlocation?: string[];\n}\n\n/**\n * Properties for an item found in the WordPress Dashboard, such as a form field,\n * a button, a link, and so on.\n *\n * This *does not* include admin menu items. Those are parsed on the fly and don't\n * need to be serialized.\n */\nexport interface DashboardItemProps extends BaseItemProps {\n\torigin: {\n\t\t/**\n\t\t * Admin menu URL that the item is associated with. Relative to the wp-admin URL.\n\t\t */\n\t\tmenuUrl: string;\n\t\t/**\n\t\t * URL of the page that the item is on, if different from the menu URL.\n\t\t */\n\t\tpageUrl?: string | null;\n\t};\n\trelativeId: string;\n\n\ttarget: {\n\t\t/**\n\t\t * Link URL for items that link to a different page, like filters and admin page tabs.\n\t\t */\n\t\turl?: string | null;\n\t\t/**\n\t\t * CSS selector for items that target an element on the page, like form fields and buttons.\n\t\t */\n\t\tselector?: ItemSelector;\n\t\ttype: ItemTargetType;\n\t};\n\n\t/**\n\t * Label of just the item itself, not including its parent section, container, etc.\n\t *\n\t * In some cases, the general \"label\" property can include the parent's label, e.g. to help\n\t * make it unique. The \"ownLabel\" property is useful for items like tabs and navigation links\n\t * that might be added ot the \"location\" array.\n\t */\n\townLabel?: string;\n}\n\ninterface PageChildItemProps extends BaseItemProps {\n\tpageUrl?: string; //Can be omitted if menuUrl is provided and matches the page URL.\n\trelativeId: string;\n}\n\ninterface OnPageLinkItemProps extends PageChildItemProps {\n\ttargetUrl: string;\n}\n\ninterface ElementItemProps extends PageChildItemProps {\n\tselector: ItemSelector;\n}\n\ninterface LinkItemProps extends BaseItemProps {\n\turl?: string; //The URL can be omitted if the menuUrl is provided.\n}\n\ninterface AdminMenuItemProps extends BaseItemProps {\n\turl: string;\n}\n\ninterface SerializedDashboardItem extends DashboardItemProps {\n\ttype: 'dashboardItem';\n}\n\ninterface SerializedLinkItem extends LinkItemProps {\n\ttype: 'link';\n}\n\ninterface SerializedElementItem extends LinkItemProps {\n\ttype: 'element';\n\tselector: ItemSelector;\n\tclickSelectors?: string[];\n}\n\ninterface SerializedCommandItem extends BaseItemProps {\n\ttype: 'command';\n}\n\ninterface SerializedAdminMenuItem extends LinkItemProps {\n\ttype: 'adminMenuItem';\n}\n\nexport type SerializedItem =\n\tSerializedDashboardItem\n\t| SerializedLinkItem\n\t| SerializedElementItem\n\t| SerializedCommandItem\n\t| SerializedAdminMenuItem;\n\nexport interface UnknownSerializedItem extends BaseItemProps, Record<string, unknown> {\n\ttype: SerializedItemType;\n}\n\nexport function unserializeItem(data: SerializedItem): SearchableItem {\n\tswitch (data.type) {\n\t\tcase 'dashboardItem':\n\t\t\treturn new DashboardItem(data);\n\t\tdefault:\n\t\t\tconst invalidType = data.type;\n\t\t\tthrow new Error(`Unsupported item type: ${invalidType}`);\n\t}\n}","'use strict';\n\nimport Mousetrap from 'mousetrap';\nimport * as _ from 'lodash-es';\nimport log from 'loglevel';\n\nimport {builtinScanners, PageScanner, parseAdminMenuItems, userIdQueryPlaceholder} from './scanner';\nimport {\n\tescapeRegExp,\n\tgetRelativeAdminPageUrl,\n\tisAdminPageUrl,\n\tlazy,\n\tLRUCache,\n\tPromiseQueueItem,\n\tqueryAdvancedSelector\n} from './utils';\nimport {\n\tAdminMenuItem,\n\tDashboardItem,\n\tItemSelector,\n\tLoadingPlaceholderItem,\n\tRequestNavigation,\n\tSearchableItem,\n\tSerializedItem,\n\tUnknownSerializedItem,\n\tunserializeItem\n} from './items';\nimport {Crawler, CrawlerUrlBlacklist, CrawlRequest} from './crawler';\n\nimport {PanelGeometryStore} from './app-geometry';\nimport {DashboardCrawlerDb, ItemUsageTracker, UrlCrawlRecord} from './db';\n\n/*\nThis annoying js-cookie library doesn't seem to work with any import syntax that doesn't\nrequire allowSyntheticDefaultImports to be enabled in tsconfig.json.\n\nFor example, \"import * as Cookies from 'js-cookie';\" compiles, but the types are wrong.\nThe real export is at Cookies.default, while TypeScript thinks Cookies itself is the default\nexport. Importing as below works, for some reason.\n */\nimport Cookies from 'js-cookie';\n\ndeclare const wsAmeMousetrap: Mousetrap.MousetrapStatic;\ndeclare const wsAmeQuickSearchData: AmeQuickSearchTool.ScriptData;\ndeclare var wsAmeQuickSearchPageStats: Array<[string, any]> | AmeQuickSearchTool.PageStats;\n\nnamespace AmeQuickSearchTool {\n\timport Either = AmeMiniFunc.Either;\n\timport Left = AmeMiniFunc.Left;\n\timport Right = AmeMiniFunc.Right;\n\n\ttype FindMenuTitle = (menuUrl: string) => string[] | null;\n\n\tconst logger = log.getLogger('AmeQuickSearchTool');\n\n\texport class SearchResult {\n\t\tpublic readonly item: SearchableItem;\n\t\tpublic score: number;\n\n\t\tpublic readonly iconClass: string = 'ame-fa ame-fa-puzzle-piece';\n\t\tpublic readonly itemClass: string = '';\n\n\t\tconstructor(item: SearchableItem, score: number, private readonly findMenuTitle: FindMenuTitle = () => null) {\n\t\t\tthis.item = item;\n\t\t\tthis.score = score;\n\n\t\t\tif (item instanceof DashboardItem) {\n\t\t\t\tswitch (item.getTargetType()) {\n\t\t\t\t\tcase 'menu':\n\t\t\t\t\t\tthis.iconClass = 'ame-fa ame-fa-bars';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'tab':\n\t\t\t\t\t\tthis.iconClass = 'ame-fa ame-fa-folder-o';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'section':\n\t\t\t\t\t\tthis.iconClass = 'ame-fa ame-fa-sliders';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'filter':\n\t\t\t\t\t\tthis.iconClass = 'ame-fa ame-fa-filter';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'group':\n\t\t\t\t\t\tthis.iconClass = 'ame-fa ame-fa-list-ul';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'control':\n\t\t\t\t\t\tthis.iconClass = 'ame-fa ame-fa-pencil-square-o';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else if (item instanceof AdminMenuItem) {\n\t\t\t\tthis.iconClass = 'ame-fa ame-fa-bars';\n\t\t\t}\n\n\t\t\tif (item instanceof LoadingPlaceholderItem) {\n\t\t\t\tthis.itemClass = 'ame-qs-loading-placeholder';\n\t\t\t}\n\t\t}\n\n\t\tget metaLabel(): string {\n\t\t\tlet label = this.item.getMetaLabel();\n\t\t\tif (label !== '') {\n\t\t\t\treturn label;\n\t\t\t}\n\n\t\t\tlet location = this.item.getLocation();\n\t\t\tif (this.item instanceof DashboardItem) {\n\t\t\t\tconst menuUrl = this.item.getMenuUrl();\n\t\t\t\tif (menuUrl && this.findMenuTitle) {\n\t\t\t\t\tconst title = this.findMenuTitle(menuUrl);\n\t\t\t\t\tif (title) {\n\t\t\t\t\t\tlocation = title.concat(location);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn location.join('  ');\n\t\t}\n\t}\n\n\tclass ResultPool {\n\t\tprivate readonly resultCache: LRUCache<string, SearchResult> = new LRUCache<string, SearchResult>(200);\n\n\t\tconstructor(private readonly findMenuTitle: FindMenuTitle) {\n\n\t\t}\n\n\t\tmakeResultForItem(\n\t\t\titem: SearchableItem,\n\t\t\tscore: number = 1\n\t\t): SearchResult {\n\t\t\tconst itemId = item.getUniqueId();\n\t\t\tconst cachedResult = this.resultCache.get(itemId);\n\t\t\tif (cachedResult) {\n\t\t\t\tcachedResult.score = score;\n\t\t\t\treturn cachedResult;\n\t\t\t}\n\n\t\t\tconst result = new SearchResult(item, score, this.findMenuTitle);\n\t\t\tthis.resultCache.put(itemId, result);\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tinterface AugmentedQuery {\n\t\toriginalQuery: string;\n\t\tnormalizedQuery: string;\n\t\twords: string[];\n\t}\n\n\tinterface ServerSearchQueryResponse {\n\t\titems: SearchableItem[];\n\t\thasMore: boolean;\n\t}\n\n\tclass SearchEngine {\n\t\tprivate readonly itemCache: LRUCache<string, SearchableItem>;\n\t\tpublic readonly resultPool: ResultPool;\n\n\t\tprivate readonly maxLengthLimit: number = 5000;\n\n\t\tprivate currentQuery: AugmentedQuery | null = null;\n\n\t\tconstructor(\n\t\t\tinitialItems: SearchableItem[],\n\t\t\tprivate readonly initialResultsCallback: (results: SearchResult[]) => void,\n\t\t\tprivate readonly fullResultsCallback: (results: SearchResult[]) => void,\n\t\t\tfindMenuTitle: FindMenuTitle,\n\t\t\tprivate readonly relativeMenuUrls: Set<string>,\n\t\t\tprivate readonly ajaxUrl: string,\n\t\t\tprivate readonly searchNonce: string,\n\t\t\tcacheCapacity: number = 2000\n\t\t) {\n\t\t\tthis.itemCache = new LRUCache<string, SearchableItem>(cacheCapacity);\n\t\t\tthis.resultPool = new ResultPool(findMenuTitle);\n\n\t\t\tfor (const item of initialItems) {\n\t\t\t\tconst itemId = item.getUniqueId();\n\t\t\t\tif (!this.itemCache.has(itemId)) {\n\t\t\t\t\tthis.itemCache.put(itemId, item);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsearch(\n\t\t\tquery: string,\n\t\t\tmaxResults: number = Number.POSITIVE_INFINITY\n\t\t): SearchResult[] {\n\t\t\tconst searchStart = performance.now();\n\n\t\t\tconst queryWords = query.toLowerCase().trim().split(/\\s+/);\n\t\t\tconst augmentedQuery: AugmentedQuery = {\n\t\t\t\toriginalQuery: query,\n\t\t\t\tnormalizedQuery: queryWords.join(' '),\n\t\t\t\twords: queryWords\n\t\t\t};\n\t\t\tthis.currentQuery = augmentedQuery;\n\n\t\t\tconst results: SearchResult[] = [];\n\n\t\t\tconst mainLoopStart = performance.now();\n\t\t\tthis.itemCache.forEach((item) => {\n\t\t\t\tconst score = this.calculateScore(item, augmentedQuery);\n\t\t\t\tif (score > 0) {\n\t\t\t\t\tconst result = this.resultPool.makeResultForItem(item, score);\n\t\t\t\t\tresults.push(result);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst mainLoopTime = performance.now() - mainLoopStart;\n\n\t\t\tconst sortStart = performance.now();\n\t\t\tresults.sort((a, b) => b.score - a.score);\n\t\t\tconst sortTime = performance.now() - sortStart;\n\n\t\t\tif (results.length > maxResults) {\n\t\t\t\tresults.length = maxResults;\n\t\t\t}\n\n\t\t\tconst resultUpdateStart = performance.now();\n\t\t\tthis.initialResultsCallback(results);\n\t\t\tconst resultUpdateTime = performance.now() - resultUpdateStart;\n\n\t\t\tconst searchEnd = performance.now();\n\t\t\tlogger.log(\n\t\t\t\t'Search time: ' + (searchEnd - searchStart), 'ms. ('\n\t\t\t\t+ 'main loop: ' + mainLoopTime + 'ms, '\n\t\t\t\t+ 'sort: ' + sortTime + 'ms, '\n\t\t\t\t+ 'update results: ' + resultUpdateTime + 'ms'\n\t\t\t\t+ ')'\n\t\t\t);\n\n\t\t\t//Exception: If the query is empty, we don't need to ask the server for recent items.\n\t\t\t//Those should already be preloaded together with other script data.\n\t\t\tif (augmentedQuery.normalizedQuery === '') {\n\t\t\t\tthis.fullResultsCallback(results);\n\t\t\t\treturn results;\n\t\t\t}\n\n\t\t\t//Query the server for more results.\n\t\t\tthis.queryServer(augmentedQuery).then((response) => {\n\t\t\t\tlogger.log(\n\t\t\t\t\t'Server response received after ' + (performance.now() - searchEnd) + 'ms '\n\t\t\t\t\t+ 'for query:', augmentedQuery\n\t\t\t\t);\n\n\t\t\t\tif (this.currentQuery !== augmentedQuery) {\n\t\t\t\t\t//The query has changed since the server request was sent so we don't\n\t\t\t\t\t//need to update the results.\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst alreadyIncludedItems = new Set(results.map((result) => result.item.getUniqueId()));\n\t\t\t\tlet foundNewItems = false;\n\n\t\t\t\tfor (const item of response.items) {\n\t\t\t\t\t//Skip items that are already in the results. This can happen because items\n\t\t\t\t\t//are cached in memory.\n\t\t\t\t\tif (alreadyIncludedItems.has(item.getUniqueId())) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst score = this.calculateScore(item, augmentedQuery);\n\t\t\t\t\tif (score > 0) {\n\t\t\t\t\t\tfoundNewItems = true;\n\t\t\t\t\t\tresults.push(this.resultPool.makeResultForItem(item, score));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (foundNewItems) {\n\t\t\t\t\tresults.sort((a, b) => b.score - a.score);\n\t\t\t\t\tif (results.length > maxResults) {\n\t\t\t\t\t\tresults.length = maxResults;\n\t\t\t\t\t}\n\t\t\t\t\tthis.fullResultsCallback(results);\n\t\t\t\t}\n\t\t\t}).catch((error) => {\n\t\t\t\tif (error instanceof QueryCancelledError) {\n\t\t\t\t\t//The query was cancelled, likely because the user typed a new query.\n\t\t\t\t\t//This is fine and doesn't need to be reported.\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//Errors just mean the results won't be updated.\n\t\t\t\tlogger.error('Server query failed:', error, augmentedQuery);\n\t\t\t});\n\n\t\t\treturn results;\n\t\t}\n\n\t\tprivate calculateScore(item: SearchableItem, query: AugmentedQuery): number {\n\t\t\tlet score = this.calculateMatchScore(item, query);\n\t\t\tif (score > 0) {\n\t\t\t\t//Bonus for recently used or visited items.\n\t\t\t\tconst recencyMultiplier = Math.max(\n\t\t\t\t\tthis.calculateRecencyBonus(item.lastVisitedAt, Date.now()),\n\t\t\t\t\t2 * this.calculateRecencyBonus(item.lastUsedAt, Date.now())\n\t\t\t\t);\n\t\t\t\tscore = score * (1 + recencyMultiplier);\n\n\t\t\t\tif (recencyMultiplier > 0) {\n\t\t\t\t\t//logger.log('Recency bonus for item:', item, 'is', recencyMultiplier);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn score;\n\t\t}\n\n\t\tprivate calculateMatchScore(item: SearchableItem, query: AugmentedQuery): number {\n\t\t\t//Empty query matches everything.\n\t\t\tif (query.originalQuery === '') {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tconst searchableText = item.getSearchableText().toLowerCase();\n\n\t\t\tconst simpleScore = this.scoreFullMatch(searchableText, query);\n\t\t\tif (simpleScore > 0) {\n\t\t\t\treturn simpleScore;\n\t\t\t}\n\t\t\treturn this.scoreWordMatch(searchableText, query);\n\t\t}\n\n\t\tprivate scoreFullMatch(text: string, query: AugmentedQuery): number {\n\t\t\tconst position = text.indexOf(query.normalizedQuery);\n\t\t\tif (position < 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tconst distanceFromStartScore = 1 - this.mapTextLengthToScoreRange(position);\n\t\t\tconst coverageScore = query.normalizedQuery.length / text.length;\n\t\t\treturn (distanceFromStartScore + coverageScore) / 2;\n\t\t}\n\n\t\tprivate scoreWordMatch(text: string, query: AugmentedQuery): number {\n\t\t\tlet firstMatchStart = -1;\n\t\t\tlet lastMatchEnd = -1;\n\t\t\tlet totalCoverage = 0;\n\t\t\tlet positionSum = 0;\n\n\t\t\tfor (const word of query.words) {\n\t\t\t\tconst position = text.indexOf(word, lastMatchEnd + 1);\n\t\t\t\tif (position < 0) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\tpositionSum += position;\n\n\t\t\t\tif (firstMatchStart < 0) {\n\t\t\t\t\tfirstMatchStart = position;\n\t\t\t\t}\n\t\t\t\tlastMatchEnd = position + word.length;\n\t\t\t\ttotalCoverage += word.length;\n\t\t\t}\n\n\t\t\tconst distanceFromStartScore = 1 - this.mapTextLengthToScoreRange(firstMatchStart);\n\t\t\tconst coverageScore = totalCoverage / text.length;\n\n\t\t\tconst averagePosition = positionSum / query.words.length;\n\t\t\tconst averagePositionScore = 1 - this.mapTextLengthToScoreRange(averagePosition);\n\n\t\t\tconst startPositionWeight = 0.5;\n\t\t\tconst avgPositionWeight = 0.3;\n\t\t\tconst coverageWeight = 0.2;\n\t\t\tconst weightSum = startPositionWeight + avgPositionWeight + coverageWeight;\n\n\t\t\treturn (startPositionWeight * distanceFromStartScore\n\t\t\t\t+ coverageWeight * coverageScore\n\t\t\t\t+ avgPositionWeight * averagePositionScore\n\t\t\t) / weightSum;\n\t\t}\n\n\t\tprivate mapTextLengthToScoreRange(value: number): number {\n\t\t\tconst maxValue = this.maxLengthLimit;\n\t\t\tif (value <= 0) {\n\t\t\t\treturn 0.0;\n\t\t\t}\n\t\t\tif (value >= maxValue) {\n\t\t\t\treturn 1.0;\n\t\t\t}\n\n\t\t\t//Linear part: f(100) = 0.9\n\t\t\tconst linearThreshold = 100;\n\t\t\tconst linearMaxOutput = 0.9;\n\n\t\t\tif (value <= linearThreshold) {\n\t\t\t\treturn (value / linearThreshold) * linearMaxOutput;\n\t\t\t}\n\n\t\t\t//Asymptotic part.\n\t\t\tconst remainingValue = value - linearThreshold;\n\t\t\tconst remainingRange = maxValue - linearThreshold;\n\t\t\tconst asymptoteBase = 0.5; //Adjust this to control the curve. Higher values make it steeper.\n\n\t\t\treturn linearMaxOutput + (1 - linearMaxOutput) * (1 - Math.exp(-asymptoteBase * remainingValue / remainingRange));\n\t\t}\n\n\t\tprivate calculateRecencyBonus(itemTimestampMs: number, nowMs: number): number {\n\t\t\tif (itemTimestampMs <= 0) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tconst elapsedDays = (nowMs - itemTimestampMs) / (24 * 60 * 60 * 1000);\n\t\t\tif (elapsedDays >= 365) {\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tconst halfLifeInDays = 30;\n\t\t\tconst decayRate = Math.log(2) / halfLifeInDays;\n\t\t\treturn Math.exp(-decayRate * elapsedDays);\n\t\t}\n\n\t\taddItem(item: SearchableItem): void {\n\t\t\tthis.itemCache.put(item.getUniqueId(), item);\n\t\t}\n\n\t\t/**\n\t\t * Add an item if there is room in the cache.\n\t\t * @param item\n\t\t */\n\t\tofferItem(item: SearchableItem): void {\n\t\t\tif (!this.itemCache.isFull()) {\n\t\t\t\tthis.itemCache.put(item.getUniqueId(), item);\n\t\t\t}\n\t\t}\n\n\t\tprivate currentPendingServerQuery: AugmentedQuery | null = null;\n\t\tprivate serverQueryQueue: Map<string, PromiseQueueItem<ServerSearchQueryResponse>[]> = new Map();\n\t\tprivate readonly queryResponseCache: LRUCache<string, ServerSearchQueryResponse> = new LRUCache(20);\n\t\tpublic readonly activeServerQueries: KnockoutObservable<number> = ko.observable(0);\n\n\t\tprivate async queryServer(query: AugmentedQuery): Promise<ServerSearchQueryResponse> {\n\t\t\tconst cachedResponse = this.queryResponseCache.get(query.normalizedQuery);\n\t\t\tif (cachedResponse) {\n\t\t\t\treturn cachedResponse;\n\t\t\t}\n\n\t\t\treturn new Promise<ServerSearchQueryResponse>((resolve, reject) => {\n\t\t\t\tconst queryKey = query.normalizedQuery;\n\t\t\t\tconst queue = this.serverQueryQueue.get(queryKey);\n\t\t\t\tif (queue) {\n\t\t\t\t\tqueue.push({resolve, reject});\n\t\t\t\t} else {\n\t\t\t\t\tthis.serverQueryQueue.set(queryKey, [{resolve, reject}]);\n\t\t\t\t}\n\t\t\t\tthis.currentPendingServerQuery = query;\n\n\t\t\t\tthis.throttledServerQuery();\n\t\t\t});\n\t\t}\n\n\t\tprivate sendPendingServerQuery() {\n\t\t\tconst query = this.currentPendingServerQuery;\n\t\t\tif (query === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst responseHandlers = this.serverQueryQueue.get(query.normalizedQuery) || [];\n\t\t\tthis.serverQueryQueue.delete(query.normalizedQuery);\n\n\t\t\t//Cancel and fail all other requests that are still in the queue.\n\t\t\t//We will only send the most recent query to the server.\n\t\t\tconst cancelError = new QueryCancelledError();\n\t\t\tfor (const queueItems of this.serverQueryQueue.values()) {\n\t\t\t\tfor (const item of queueItems) {\n\t\t\t\t\titem.reject(cancelError);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//UI: When this is non-zero, a loading indicator will be shown.\n\t\t\tthis.activeServerQueries(this.activeServerQueries() + 1);\n\n\t\t\tjQuery.post(\n\t\t\t\tthis.ajaxUrl,\n\t\t\t\t{\n\t\t\t\t\taction: 'ws-ame-qs-quick-search',\n\t\t\t\t\t_ajax_nonce: this.searchNonce,\n\t\t\t\t\tquery: query.originalQuery,\n\t\t\t\t\tpresentMenuUrls: JSON.stringify(Array.from(this.relativeMenuUrls))\n\t\t\t\t},\n\t\t\t\tundefined,\n\t\t\t\t'json'\n\t\t\t).done((response) => {\n\t\t\t\tlogger.log('Server query response:', response);\n\n\t\t\t\tconst items: SearchableItem[] = [];\n\t\t\t\tfor (const itemData of response.data.items) {\n\t\t\t\t\tconst item = unserializeItem(itemData);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\t//Exclude items associated with missing menu items.\n\t\t\t\t\t\tif (item instanceof DashboardItem) {\n\t\t\t\t\t\t\tconst menuUrl = item.getMenuUrl();\n\t\t\t\t\t\t\tif (menuUrl && !this.relativeMenuUrls.has(menuUrl)) {\n\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t//Cache items, and reuse the existing instance if we get the same item again.\n\t\t\t\t\t\tconst existingItem = this.itemCache.get(item.getUniqueId());\n\t\t\t\t\t\tif (existingItem) {\n\t\t\t\t\t\t\titems.push(existingItem);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\titems.push(item);\n\t\t\t\t\t\t\tthis.itemCache.put(item.getUniqueId(), item);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst serverResponse: ServerSearchQueryResponse = {\n\t\t\t\t\titems: items,\n\t\t\t\t\thasMore: !!response.data.hasMore\n\t\t\t\t};\n\n\t\t\t\tthis.queryResponseCache.put(query.normalizedQuery, serverResponse);\n\t\t\t\tfor (const item of responseHandlers) {\n\t\t\t\t\titem.resolve(serverResponse);\n\t\t\t\t}\n\t\t\t}).fail((_, textStatus, error) => {\n\t\t\t\tlogger.error('AJAX error:', textStatus, error);\n\t\t\t\tlet errorInstance: Error;\n\t\t\t\tif (error instanceof Error) {\n\t\t\t\t\terrorInstance = error;\n\t\t\t\t} else {\n\t\t\t\t\terrorInstance = new Error((error ? '' : 'AJAX error: ') + error);\n\t\t\t\t}\n\n\t\t\t\tfor (const item of responseHandlers) {\n\t\t\t\t\titem.reject(errorInstance);\n\t\t\t\t}\n\t\t\t}).always(() => {\n\t\t\t\tconst activeQueries = this.activeServerQueries();\n\t\t\t\tthis.activeServerQueries(Math.max(0, activeQueries - 1));\n\t\t\t});\n\t\t}\n\n\t\tprivate readonly throttledServerQuery = _.throttle(\n\t\t\tthis.sendPendingServerQuery,\n\t\t\t1000,\n\t\t\t{leading: true, trailing: true}\n\t\t);\n\t}\n\n\tclass QueryCancelledError extends Error {\n\t\tconstructor() {\n\t\t\tsuper('Query cancelled');\n\t\t}\n\t}\n\n\t/**\n\t * Query parameter used to pass the target selector to the next page.\n\t * Must match the value in our PHP module.\n\t * @private\n\t */\n\texport const NavigationSelectorParam = 'ame-qs-target-selector';\n\n\texport function completeNavigation(targetSelector: ItemSelector) {\n\t\tif (!targetSelector) {\n\t\t\treturn;\n\t\t}\n\n\t\t//Unmark the previous target, if any.\n\t\tconst highlightClass = 'ame-qs-navigation-target';\n\t\tjQuery('.' + highlightClass).removeClass(highlightClass);\n\n\t\t//Find the new target.\n\t\tlet $target: JQuery = queryAdvancedSelector(targetSelector);\n\t\tif ($target.length < 1) {\n\t\t\treturn;\n\t\t}\n\n\t\t//If it's a form control inside a label, use the label instead.\n\t\t//Or, if it has a separate label, highlight both.\n\t\tconst $ancestorLabel = $target.closest('label');\n\t\tif ($ancestorLabel.length > 0) {\n\t\t\t$target = $ancestorLabel;\n\t\t} else {\n\t\t\tconst id = $target.prop('id');\n\t\t\tif (id) {\n\t\t\t\tconst $label = jQuery('label[for=\"' + id + '\"]');\n\t\t\t\tif ($label.length > 0) {\n\t\t\t\t\t$target = $target.add($label);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//Highlight the target and scroll it into view.\n\t\t$target.addClass(highlightClass);\n\t\t$target.get(0).scrollIntoView({block: 'center'});\n\t}\n\n\tclass MenuItemCrawlerInfo {\n\t\tpublic readonly totalUniqueItems: KnockoutObservable<number | null> = ko.observable(null);\n\n\t\tconstructor(\n\t\t\tpublic readonly menuItem: AdminMenuItem,\n\t\t\tpublic readonly reason: string,\n\t\t\tpublic readonly request: CrawlRequest | null = null,\n\t\t\tpublic readonly previousCrawlAttempt: Date | null = null\n\t\t) {\n\t\t}\n\t}\n\n\texport class PageStats {\n\t\tpublic readonly phpPeakMemoryUsage: KnockoutObservable<number> = ko.observable(-1);\n\t\tpublic readonly phpMemoryLimit: KnockoutObservable<string> = ko.observable('');\n\t\tpublic readonly pageGenerationTime: KnockoutObservable<number> = ko.observable(-1);\n\n\t\tpublic readonly formattedPeakMemoryUsage: KnockoutComputed<string> = ko.pureComputed(() => {\n\t\t\tconst usage = this.phpPeakMemoryUsage();\n\t\t\tif (usage <= 0) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\tconst usageInMb = usage / (1024 * 1024);\n\t\t\treturn usageInMb.toFixed(1);\n\t\t});\n\n\t\tpublic readonly formattedPageGenerationTime: KnockoutComputed<string> = ko.pureComputed(() => {\n\t\t\tconst time = this.pageGenerationTime();\n\t\t\tif (time <= 0) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn time.toFixed(3);\n\t\t});\n\n\t\tpublic readonly memoryUsageTitle: KnockoutComputed<string> = ko.pureComputed(() => {\n\t\t\tconst basicTitle = 'Peak PHP memory usage';\n\n\t\t\tconst usage = this.phpPeakMemoryUsage();\n\t\t\tconst memoryLimit = this.phpMemoryLimit();\n\n\t\t\tif ((usage <= 0) || (memoryLimit === '') || (memoryLimit === '-1')) {\n\t\t\t\treturn basicTitle;\n\t\t\t}\n\n\t\t\t//Convert the memory limit to bytes.\n\t\t\tconst limitMatch = memoryLimit.match(/^(\\d+)([KMG]?)$/);\n\t\t\tif (!limitMatch) {\n\t\t\t\treturn basicTitle;\n\t\t\t}\n\n\t\t\tlet limitInBytes = parseInt(limitMatch[1]);\n\t\t\tswitch (limitMatch[2]) {\n\t\t\t\tcase 'K':\n\t\t\t\t\tlimitInBytes *= 1024;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'M':\n\t\t\t\t\tlimitInBytes *= 1024 * 1024;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'G':\n\t\t\t\t\tlimitInBytes *= 1024 * 1024 * 1024;\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst usageInMb = usage / (1024 * 1024);\n\t\t\tconst limitInMb = limitInBytes / (1024 * 1024);\n\t\t\tconst percentageUsed = (usageInMb / limitInMb) * 100;\n\n\t\t\tconst formattedLimit = (Math.floor(limitInMb) === limitInMb) ? limitInMb.toFixed(0) : limitInMb.toFixed(1);\n\n\t\t\treturn basicTitle + '\\n' + percentageUsed.toFixed(1) + '% of ' + formattedLimit + ' MiB';\n\t\t});\n\n\t\tpush(data: [string, any]) {\n\t\t\tswitch (data[0]) {\n\t\t\t\tcase 'phpPeakMemoryUsage':\n\t\t\t\t\tthis.phpPeakMemoryUsage(parseInt(data[1]));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'phpMemoryLimit':\n\t\t\t\t\tthis.phpMemoryLimit('' + data[1]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'pageGenerationTime':\n\t\t\t\t\tthis.pageGenerationTime(parseFloat(data[1]));\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\texport interface ScriptData {\n\t\tkeyboardShortcut: string;\n\t\tpreloadedItems: SerializedItem[];\n\t\trecencyTracking: 'enabled' | 'disabled' | 'enableOnFirstUse';\n\n\t\tajaxUrl: string;\n\t\tsearchNonce: string;\n\t\tindexUpdateNonce: string;\n\t\tsetCrawlerEnabledNonce: string;\n\t\tjsLogLevel?: 'debug' | 'info' | 'warn' | 'error' | 'silent';\n\n\t\tnavigationNonce: string;\n\t\tnavigationTargetSelector: null | ItemSelector;\n\n\t\tadminUrl: string;\n\t\tadminCookiePath: string;\n\t\tsiteCookiePath: string;\n\t\tcurrentUserId: number;\n\t\tremovableQueryArgs: string[];\n\n\t\tcrawlerConfig: {\n\t\t\tenabled: 'ask' | 'disabled' | 'enabled';\n\t\t\tajaxNonces: Record<string, string>;\n\t\t\tpreloadedRecords: Record<string, UrlCrawlRecord | null>;\n\t\t\tunknownComponentCrawlIntervalInDays: number;\n\t\t\tknownComponentCrawlIntervalInDays: number;\n\t\t\tmenuComponents: Record<string, string | null>;\n\t\t\tminCrawlIntervalInHours: number;\n\t\t\tcrawlerTabVisible: boolean;\n\t\t};\n\t}\n\n\texport class QuickSearchApp {\n\t\tprivate readonly searchEngine: SearchEngine;\n\t\tpublic readonly searchInput: KnockoutObservable<string> = ko.observable('');\n\t\tpublic readonly searchResults: KnockoutObservableArray<SearchResult> = ko.observableArray([] as SearchResult[]);\n\n\t\tprivate readonly maxResults: number = 100;\n\t\tprivate readonly recentItemsLimit: number = 30;\n\n\t\tpublic readonly isVisible: KnockoutObservable<boolean> = ko.observable(false);\n\t\tpublic readonly isSearchBoxFocused: KnockoutObservable<boolean> = ko.observable(false);\n\n\t\tpublic readonly selectedResult: KnockoutObservable<SearchResult | null> = ko.observable(null);\n\t\tprivate selectedResultIndex: number = -1;\n\n\t\tpublic readonly adminUrl: URL;\n\t\tprivate readonly currentAdminMenuItem: AdminMenuItem | null = null;\n\t\t/**\n\t\t * Admin menu items that are present on the current page.\n\t\t * @private\n\t\t */\n\t\tprivate readonly presentAdminMenuItems: AdminMenuItem[] = [];\n\n\t\t/**\n\t\t * Relative menu URLs filtered to exclude non-admin page links and blacklisted URLs.\n\t\t *\n\t\t * The intent is to use these to filter DashboardItem instances. Items that correspond\n\t\t * to missing menu items should be excluded because they're probably gone or the current\n\t\t * user can't access them.\n\t\t *\n\t\t * Technically, we could probably skip checking URLs against the crawler blacklist because\n\t\t * there should be no items with those URLs anyway. However, keeping blacklisted URLs out\n\t\t * of this list helps reduce the number of URLs sent to the server for search queries,\n\t\t * and reduces the length of DB queries.\n\t\t *\n\t\t * @private\n\t\t */\n\t\tprivate readonly presentFilteredMenuUrls: Set<string>;\n\n\t\tpublic readonly tabs: AmeKnockoutTabCollection = new AmeKnockoutTabCollection([\n\t\t\t{\n\t\t\t\ttitle: 'Search',\n\t\t\t\tslug: 'search',\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Crawler',\n\t\t\t\tslug: 'crawler',\n\t\t\t},\n\t\t]);\n\n\t\tprivate readonly requestNavigation: RequestNavigation;\n\n\t\tprivate readonly crawler: KnockoutObservable<Crawler | null> = ko.observable(null);\n\t\tprivate readonly crawlerConfig: ScriptData['crawlerConfig'];\n\t\tpublic readonly menuCrawlerMeta: KnockoutObservableArray<MenuItemCrawlerInfo> = ko.observableArray<MenuItemCrawlerInfo>([]);\n\n\t\tpublic readonly isCrawlerRunning: KnockoutComputed<boolean> = ko.pureComputed(() => {\n\t\t\tconst crawler = this.crawler();\n\t\t\tif (crawler) {\n\t\t\t\treturn crawler.isRunning();\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tpublic readonly crawlerOfferVisible: KnockoutObservable<boolean>;\n\n\t\tpublic readonly crawlerTabs = new AmeKnockoutTabCollection([\n\t\t\t{\n\t\t\t\ttitle: 'Menus',\n\t\t\t\tslug: 'menus',\n\t\t\t\tcount: ko.pureComputed(() => this.menuCrawlerMeta().length),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Active',\n\t\t\t\tslug: 'active',\n\t\t\t\tcount: ko.pureComputed(() => this.crawler()?.activeRequests().length || 0),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Queue',\n\t\t\t\tslug: 'queue',\n\t\t\t\tcount: ko.pureComputed(() => this.crawler()?.crawlRequestQueue.size || 0),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: 'Finished',\n\t\t\t\tslug: 'finished',\n\t\t\t\tcount: ko.pureComputed(() => this.crawler()?.finishedRequests.size || 0),\n\t\t\t}\n\t\t]);\n\n\t\tprivate readonly removableQueryArgs: string[];\n\t\tprivate readonly currentUserId: number | null;\n\t\tprivate readonly ajaxUrl: string;\n\n\t\tpublic readonly geometryStore: PanelGeometryStore;\n\t\tprivate readonly itemUsageTracker: ItemUsageTracker;\n\t\tprivate recencyTracking: ScriptData['recencyTracking'];\n\n\t\tpublic readonly pageStats: PageStats;\n\t\tprivate readonly pageStatsEnabled: KnockoutObservable<boolean> = ko.observable(true);\n\t\tpublic readonly pageStatsVisible: KnockoutObservable<boolean> = ko.pureComputed(() => {\n\t\t\treturn this.pageStatsEnabled() && (this.pageStats.phpPeakMemoryUsage() >= 0);\n\t\t});\n\n\t\tconstructor(private readonly deps: AppDependencyFactory) {\n\t\t\tconst scriptData: ScriptData = deps.scriptData;\n\t\t\tthis.adminUrl = deps.adminUrl;\n\t\t\tthis.pageStats = deps.pageStats();\n\n\t\t\tthis.ajaxUrl = scriptData.ajaxUrl;\n\t\t\tthis.currentUserId = scriptData.currentUserId;\n\t\t\tthis.crawlerConfig = {...scriptData.crawlerConfig};\n\t\t\tthis.geometryStore = new PanelGeometryStore(scriptData.siteCookiePath);\n\t\t\tthis.recencyTracking = scriptData.recencyTracking;\n\n\t\t\tthis.requestNavigation = (url: string, targetSelector: ItemSelector) => {\n\t\t\t\t//If it's a relative URL, make it absolute.\n\t\t\t\tif (!url.startsWith('http')) {\n\t\t\t\t\turl = new URL(url, this.adminUrl).toString();\n\t\t\t\t}\n\n\t\t\t\turl = this.replaceUserPlaceholderInUrl(url);\n\n\t\t\t\tlogger.log(\n\t\t\t\t\t'New url:', url,\n\t\t\t\t\t'Target selector:', targetSelector,\n\t\t\t\t\t'Current url:', window.location.href\n\t\t\t\t);\n\t\t\t\tif (url === window.location.href) {\n\t\t\t\t\tcompleteNavigation(targetSelector);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t//Pass the target selector to the next page. Then use completeNavigation() on\n\t\t\t\t//the next page to highlight the target and scroll it into view.\n\t\t\t\tconst targetUrl = new URL(url, window.location.href);\n\t\t\t\tif (targetSelector) {\n\t\t\t\t\ttargetUrl.searchParams.set(\n\t\t\t\t\t\tNavigationSelectorParam,\n\t\t\t\t\t\tJSON.stringify({selector: targetSelector, nonce: scriptData.navigationNonce})\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\twindow.location.href = targetUrl.toString();\n\t\t\t};\n\n\t\t\t//Show a large placeholder item while recent items are being loaded asynchronously.\n\t\t\t//This gives the app a reasonable initial height and mitigates some layout and positioning\n\t\t\t//issues caused by the height changing dramatically after the results finish loading.\n\t\t\t//If the user resizes the app this becomes unnecessary, but it's harmless.\n\t\t\tthis.searchResults.push(new SearchResult(new LoadingPlaceholderItem(), 1));\n\n\t\t\tconst adminMenuParserResult = this.parseAdminMenuItems();\n\t\t\tthis.currentAdminMenuItem = adminMenuParserResult.currentMenuItem;\n\t\t\t//Save admin menu items - they'll be used by the crawler.\n\t\t\tadminMenuParserResult.items.forEach((item) => {\n\t\t\t\tif (item instanceof AdminMenuItem) {\n\t\t\t\t\tthis.presentAdminMenuItems.push(item)\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst initialItems = adminMenuParserResult.items;\n\t\t\tconst findItemByRelativeUrl: FindMenuTitle = (url: string) => {\n\t\t\t\tif (url in adminMenuParserResult.itemsByRelativeUrl) {\n\t\t\t\t\tconst item = adminMenuParserResult.itemsByRelativeUrl[url];\n\t\t\t\t\treturn item.getTitleParts();\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t};\n\n\t\t\tconst blacklist = this.crawlerUrlBlacklist();\n\t\t\tthis.presentFilteredMenuUrls = new Set(this.presentAdminMenuItems\n\t\t\t\t.map((item) => item.getRelativeMenuUrl())\n\t\t\t\t.filter((url) => {\n\t\t\t\t\tif (!url) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn !blacklist.isBlacklisted(url);\n\t\t\t\t}));\n\n\t\t\t//Add preloaded items.\n\t\t\tfor (const itemData of scriptData.preloadedItems) {\n\t\t\t\tconst item = unserializeItem(itemData);\n\t\t\t\t//Drop items that reference missing or blacklisted menus.\n\t\t\t\tif (item instanceof DashboardItem) {\n\t\t\t\t\tconst menuUrl = item.getMenuUrl();\n\t\t\t\t\tif (menuUrl && !this.presentFilteredMenuUrls.has(menuUrl)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tinitialItems.push(item);\n\t\t\t}\n\n\t\t\t//Populate item used/visited timestamps.\n\t\t\tthis.itemUsageTracker = deps.itemUsageTracker()\n\t\t\tconst populateTimestamps = this.itemUsageTracker.populateUsageTimestamps(initialItems);\n\n\t\t\tthis.searchEngine = new SearchEngine(\n\t\t\t\tinitialItems,\n\t\t\t\tthis.updateInitialResults,\n\t\t\t\tthis.updateFullResults,\n\t\t\t\tfindItemByRelativeUrl,\n\t\t\t\tthis.presentFilteredMenuUrls,\n\t\t\t\tscriptData.ajaxUrl,\n\t\t\t\tscriptData.searchNonce\n\t\t\t);\n\n\t\t\t//Prepopulate the search results with recent items. We do this by searching for\n\t\t\t//and empty string. However, since timestamps are populated asynchronously, it's\n\t\t\t//theoretically possible that the user could have searched for something before\n\t\t\t//timestamps are done, so we need a \"first request\" check.\n\t\t\tpopulateTimestamps.finally(() => {\n\t\t\t\t//The search box starts out empty. Or, if the user has already searched for\n\t\t\t\t//something, this will refresh the results taking timestamps into account.\n\t\t\t\tthis.runCurrentQuery();\n\t\t\t});\n\n\t\t\tthis.searchInput.subscribe(() => {\n\t\t\t\tthis.runCurrentQuery();\n\t\t\t});\n\n\t\t\tthis.searchResults.subscribe((newValue) => {\n\t\t\t\t//Try to maintain the previous selection if it was the result of user input.\n\t\t\t\t//We assume that if the user moves selection away (down) from the first result,\n\t\t\t\t//they are likely to want to keep that selection.\n\t\t\t\tconst previousSelectedResult = this.selectedResult();\n\t\t\t\tif (previousSelectedResult && (this.selectedResultIndex > 0)) {\n\t\t\t\t\tconst index = newValue.findIndex((result) => result.item === previousSelectedResult.item);\n\t\t\t\t\tif (index >= 0) {\n\t\t\t\t\t\t//The selection is still valid, just update the index.\n\t\t\t\t\t\tthis.selectedResultIndex = index;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t//Fall through to the default selection logic.\n\t\t\t\t}\n\n\t\t\t\t//Select the first result by default.\n\t\t\t\tif (newValue.length > 0) {\n\t\t\t\t\tthis.selectedResultIndex = 0;\n\t\t\t\t\tthis.selectedResult(newValue[0]);\n\t\t\t\t} else {\n\t\t\t\t\tthis.selectedResultIndex = -1;\n\t\t\t\t\tthis.selectedResult(null);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.removableQueryArgs = scriptData.removableQueryArgs;\n\n\t\t\t//Enable \"last visited\" and \"last used\" tracking when the user interacts with\n\t\t\t//the app for the first time.\n\t\t\tif (this.recencyTracking === 'enableOnFirstUse') {\n\t\t\t\tlet searchSubscription: KnockoutSubscription | null = null;\n\t\t\t\tsearchSubscription = this.searchInput.subscribe((query) => {\n\t\t\t\t\tif (query !== '') {\n\t\t\t\t\t\tsearchSubscription?.dispose();\n\t\t\t\t\t\tthis.recencyTracking = 'enabled';\n\n\t\t\t\t\t\t//This temporary cookie tells the server to enable recency tracking\n\t\t\t\t\t\t//in module settings. Once done, the module will delete the cookie.\n\t\t\t\t\t\tCookies.set('ame-qs-recency-tracking', 'enabled', {\n\t\t\t\t\t\t\texpires: 30,\n\t\t\t\t\t\t\tsameSite: 'Lax',\n\t\t\t\t\t\t\tpath: scriptData.adminCookiePath\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// noinspection JSIgnoredPromiseFromCall\n\t\t\t\t\t\tdeps.recordCurrentVisit().then(() => {\n\t\t\t\t\t\t\tlogger.log('First use visit recorded, recency tracking enabled.');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.crawlerOfferVisible = ko.observable(this.crawlerConfig.enabled === 'ask');\n\t\t\tif (!this.crawlerConfig.crawlerTabVisible) {\n\t\t\t\tthis.tabs.hideTab('crawler');\n\t\t\t}\n\n\t\t\t//Automatically run an incremental crawl when the user opens the app.\n\t\t\tif (this.crawlerConfig.enabled === 'enabled') {\n\t\t\t\t//Add a small delay so as not to interfere with the initial search, if any.\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.runIncrementalCrawl();\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t}\n\n\t\tdisplay(): void {\n\t\t\t//Select the \"Search\" tab. This is usually the default tab, but if the user\n\t\t\t//has switched to another tab and then presses the hotkey again, we switch back.\n\t\t\tthis.tabs.switchToTabBySlug('search');\n\n\t\t\t//Display the app.\n\t\t\tif (!this.isVisible()) {\n\t\t\t\tthis.isVisible(true);\n\t\t\t}\n\n\t\t\t//Focus the search box.\n\t\t\tthis.isSearchBoxFocused(true);\n\t\t}\n\n\t\tupdateInitialResults = (results: SearchResult[]): void => {\n\t\t\tthis.searchResults(results);\n\t\t};\n\n\t\tupdateFullResults = (results: SearchResult[]): void => {\n\t\t\tthis.searchResults(results);\n\t\t\t// logger.log('Full results:', results);\n\t\t}\n\n\t\tprivate runCurrentQuery(onlyIfNonEmpty: boolean = false): void {\n\t\t\tconst query = this.searchInput();\n\t\t\tconst isEmpty = (query.trim() === '');\n\n\t\t\tif (onlyIfNonEmpty && isEmpty) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.searchEngine.search(\n\t\t\t\tquery,\n\t\t\t\tisEmpty ? this.recentItemsLimit : this.maxResults\n\t\t\t);\n\t\t}\n\n\t\thandleAppKeyDown(_: unknown, event: KeyboardEvent): boolean {\n\t\t\t// logger.log('App Key down', event);\n\t\t\tif (event.key === 'Escape') {\n\t\t\t\t// logger.log('Escape key pressed', event);\n\t\t\t\tthis.isVisible(false);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\thandleSearchBoxKeyDown(_: unknown, event: KeyboardEvent): boolean {\n\t\t\tswitch (event.key) {\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\tthis.moveSelection(1);\n\t\t\t\t\treturn false;\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\tthis.moveSelection(-1);\n\t\t\t\t\treturn false;\n\t\t\t\tcase 'Enter':\n\t\t\t\t\t// logger.log('Enter key pressed', event);\n\t\t\t\t\tthis.performSelectionAction();\n\t\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\tprivate performSelectionAction(): void {\n\t\t\tconst selection = this.selectedResult();\n\t\t\tif (selection) {\n\t\t\t\tif (this.recencyTracking !== 'disabled') {\n\t\t\t\t\t//To save time for the user, we don't wait for the timestamp update to complete.\n\t\t\t\t\t// noinspection JSIgnoredPromiseFromCall\n\t\t\t\t\tthis.itemUsageTracker.recordItemAction(selection.item);\n\t\t\t\t}\n\n\t\t\t\tconst done = selection.item.performAction(this.requestNavigation);\n\t\t\t\tif (done) {\n\t\t\t\t\tthis.isVisible(false);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprivate moveSelection(direction: number): void {\n\t\t\tconst currentResults = this.searchResults();\n\t\t\tif (currentResults.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.selectedResultIndex = (this.selectedResultIndex + direction + currentResults.length) % currentResults.length;\n\t\t\tthis.selectedResult(currentResults[this.selectedResultIndex]);\n\t\t}\n\n\t\tpublic handleResultClick(result: SearchResult): void {\n\t\t\tthis.selectedResult(result);\n\t\t\tthis.performSelectionAction();\n\t\t}\n\n\t\tprivate readonly itemUrlFormatter = (url: string): string => {\n\t\t\turl = this.replaceUserPlaceholderInUrl(url);\n\t\t\tif (url.startsWith('http')) {\n\t\t\t\t//Try to make the URL relative to the admin dashboard URL.\n\t\t\t\tconst adminBase = this.adminUrl.origin + this.adminUrl.pathname;\n\t\t\t\tif (url.startsWith(adminBase)) {\n\t\t\t\t\turl = url.substring(adminBase.length);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn url;\n\t\t};\n\n\t\tpublic readonly selectedResultDisplayUrl: KnockoutComputed<string> = ko.pureComputed(() => {\n\t\t\tconst selection = this.selectedResult();\n\t\t\tif (!selection) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn selection.item.getStatusBarText(this.itemUrlFormatter);\n\t\t});\n\n\t\tpublic readonly searchProgressIndicatorVisible: KnockoutComputed<boolean> = ko.pureComputed(() => {\n\t\t\treturn this.searchEngine.activeServerQueries() > 0;\n\t\t});\n\n\t\tprivate replaceUserPlaceholderInUrl(url: string): string {\n\t\t\tif (this.currentUserId && url.includes(userIdQueryPlaceholder)) {\n\t\t\t\treturn url.replace(userIdQueryPlaceholder, this.currentUserId.toString());\n\t\t\t}\n\t\t\treturn url;\n\t\t}\n\n\t\tprivate parseAdminMenuItems(): {\n\t\t\tcurrentMenuItem: AdminMenuItem | null,\n\t\t\titems: SearchableItem[],\n\t\t\titemsByRelativeUrl: { [url: string]: AdminMenuItem }\n\t\t} {\n\t\t\tconst parserResult = this.deps.adminMenuParserResult();\n\n\t\t\treturn {\n\t\t\t\tcurrentMenuItem: parserResult.currentMenuItem,\n\t\t\t\titems: parserResult.items,\n\t\t\t\titemsByRelativeUrl: parserResult.itemsByRelativeUrl\n\t\t\t};\n\t\t}\n\n\t\tgetCurrentAdminMenuItem(): AdminMenuItem | null {\n\t\t\treturn this.currentAdminMenuItem;\n\t\t}\n\n\t\t// noinspection JSUnusedGlobalSymbols -- Called from the KO template.\n\t\tstopCrawler() {\n\t\t\tconst crawler = this.crawler();\n\t\t\tif (!crawler) {\n\t\t\t\talert('Crawler not available.');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcrawler.stop();\n\t\t}\n\n\t\t// noinspection JSUnusedGlobalSymbols -- Also called from the KO template.\n\t\tcrawlCurrentPage() {\n\t\t\tconst currentMenuItem = this.getCurrentAdminMenuItem();\n\t\t\tif (!currentMenuItem) {\n\t\t\t\talert('Error: Could not find the current admin menu item.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.updateDashboardItemIndex([currentMenuItem], true)\n\t\t\t\t.then(r => logger.log('Current page crawl done:', r));\n\t\t}\n\n\t\t// noinspection JSUnusedGlobalSymbols - More KO template stuff.\n\t\trunIncrementalCrawl() {\n\t\t\tthis.updateDashboardItemIndex(this.presentAdminMenuItems)\n\t\t\t\t.then(r => logger.log('Incremental crawl done:', r));\n\t\t}\n\n\t\tprivate readonly isIndexUpdateRunning: KnockoutObservable<boolean> = ko.observable(false);\n\t\tpublic readonly canStartIndexUpdate: KnockoutComputed<boolean> = ko.pureComputed(() => {\n\t\t\tif (this.isIndexUpdateRunning()) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst crawler = this.crawler();\n\t\t\treturn !(crawler && crawler.isRunning());\n\n\t\t});\n\n\t\tprivate readonly lastIndexUpdateError: KnockoutObservable<string> = ko.observable('');\n\t\tprivate readonly lastIndexUpdateResult: KnockoutObservable<number | null> = ko.observable(null);\n\n\t\tpublic readonly crawlerStatusMessage: KnockoutComputed<string> = ko.pureComputed(() => {\n\t\t\tconst crawler = this.crawler();\n\t\t\tlet state: ReturnType<Crawler['getState']> | null = null;\n\t\t\tif (crawler) {\n\t\t\t\tstate = crawler.getState();\n\t\t\t\tif (state === 'running') {\n\t\t\t\t\treturn ('Indexing admin pages (' + crawler.getFinishedRequestCount()\n\t\t\t\t\t\t+ ' of ' + crawler.getTotalRequestCount() + ')...');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.isIndexUpdateRunning()) {\n\t\t\t\tif ((state === 'idle') || !state) {\n\t\t\t\t\treturn 'Index update starting...';\n\t\t\t\t} else {\n\t\t\t\t\treturn 'Index update finishing...';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.lastIndexUpdateError()) {\n\t\t\t\treturn 'Error: ' + this.lastIndexUpdateError();\n\t\t\t}\n\n\t\t\tconst lastResult = this.lastIndexUpdateResult();\n\t\t\tif (lastResult !== null) {\n\t\t\t\treturn 'Index update completed. ' + lastResult + ' pages crawled.';\n\t\t\t}\n\n\t\t\tif (crawler) {\n\t\t\t\treturn 'Crawler status: ' + crawler.getState();\n\t\t\t} else {\n\t\t\t\treturn 'Crawler not started yet.';\n\t\t\t}\n\t\t});\n\n\t\tpublic readonly showCrawlerStatusInStatusBar: KnockoutComputed<boolean> = ko.pureComputed(() => {\n\t\t\treturn this.isIndexUpdateRunning();\n\t\t});\n\n\t\tprivate async updateDashboardItemIndex(\n\t\t\tmenuItems: AdminMenuItem[],\n\t\t\tbypassSchedulingChecks: boolean = false\n\t\t): Promise<Either<Error, number>> {\n\t\t\tthis.isIndexUpdateRunning(true);\n\t\t\tthis.lastIndexUpdateError('');\n\t\t\tthis.lastIndexUpdateResult(null);\n\n\t\t\treturn this._updateDashboardItemIndexInternal(menuItems, bypassSchedulingChecks)\n\t\t\t\t.then((result) => {\n\t\t\t\t\tif (result.isRight()) {\n\t\t\t\t\t\tthis.lastIndexUpdateResult(result.value);\n\t\t\t\t\t} else if (result.isLeft()) {\n\t\t\t\t\t\tthis.lastIndexUpdateError(result.value.message);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tif (err instanceof Error) {\n\t\t\t\t\t\tthis.lastIndexUpdateError(err.message);\n\t\t\t\t\t\treturn Either.left<Error, number>(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlogger.error('An unknown error index update occurred:', err);\n\t\t\t\t\t\tthis.lastIndexUpdateError('An unknown error occurred.');\n\t\t\t\t\t\treturn Either.left<Error, number>(new Error('An unknown error occurred.'));\n\t\t\t\t\t}\n\t\t\t\t}).finally(() => {\n\t\t\t\t\tlogger.info('Index update finished.');\n\t\t\t\t\tthis.isIndexUpdateRunning(false);\n\t\t\t\t});\n\t\t}\n\n\t\tprivate async _updateDashboardItemIndexInternal(\n\t\t\tmenuItems: AdminMenuItem[],\n\t\t\tbypassSchedulingChecks: boolean = false\n\t\t): Promise<Either<Error, number>> {\n\t\t\tlogger.info(\n\t\t\t\t'Starting ' + (bypassSchedulingChecks ? '' : 'incremental ') + 'index update for',\n\t\t\t\tmenuItems.length, 'menu items...'\n\t\t\t);\n\n\t\t\tconst oldCrawler = this.crawler();\n\t\t\tif (oldCrawler && oldCrawler.isRunning()) {\n\t\t\t\treturn Either.left(new Error('Crawler is already running.'));\n\t\t\t}\n\n\t\t\t//To avoid overloading the site, don't start a new crawl if one is already running\n\t\t\t//in another tab. We use a short-lived cookie to track this.\n\t\t\tconst crawlerRunningCookie = 'ame-qs-crawler-running';\n\t\t\tif (Cookies.get(crawlerRunningCookie)) {\n\t\t\t\treturn Either.left(new Error('Skipping index update because another crawl is already running.'));\n\t\t\t}\n\n\t\t\tconst expirationInMinutes = 45;\n\t\t\tCookies.set(crawlerRunningCookie, '1', {\n\t\t\t\tsameSite: 'Lax',\n\t\t\t\texpires: new Date(Date.now() + expirationInMinutes * 60 * 1000)\n\t\t\t});\n\n\t\t\tthis.crawler(null);\n\n\t\t\tconst blacklist = this.crawlerUrlBlacklist();\n\t\t\tconst crawlerDb = new DashboardCrawlerDb(\n\t\t\t\tthis.ajaxUrl,\n\t\t\t\tthis.crawlerConfig.ajaxNonces,\n\t\t\t\tthis.crawlerConfig.preloadedRecords\n\t\t\t);\n\n\t\t\t//First, run checks that don't require network requests. This validates menu URLs,\n\t\t\t//checks them against the blacklist, and so on.\n\t\t\tconst maybeCrawl: AdminMenuItem[] = [];\n\t\t\tfor (const item of menuItems) {\n\t\t\t\tconst couldCrawl = this.couldCrawlMenuItem(item, blacklist);\n\t\t\t\tif (couldCrawl.isRight()) {\n\t\t\t\t\tmaybeCrawl.push(item);\n\t\t\t\t} else if (couldCrawl.isLeft()) {\n\t\t\t\t\tconst menuUrl = item.getRelativeMenuUrl();\n\t\t\t\t\tthis.menuCrawlerMeta.push(new MenuItemCrawlerInfo(\n\t\t\t\t\t\titem,\n\t\t\t\t\t\tcouldCrawl.value,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tmenuUrl ? crawlerDb.getCachedLastAttemptDate(menuUrl) : null\n\t\t\t\t\t));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Prefetch crawl records for all remaining URLs in one go.\n\t\t\tawait crawlerDb.prefetchUrlRecords(\n\t\t\t\tmaybeCrawl\n\t\t\t\t\t.map(item => item.getRelativeMenuUrl())\n\t\t\t\t\t.filter(url => !!url)\n\t\t\t);\n\n\t\t\t//Now determine which of the valid items we want to crawl right now.\n\t\t\tconst potentialRequests: Array<[CrawlRequest, MenuItemCrawlerInfo]> = [];\n\t\t\t//Prevent duplicate requests. Multiple menu items can have the same URL.\n\t\t\tconst usedMenuUrls: Set<string> = new Set();\n\t\t\tfor (const item of maybeCrawl) {\n\t\t\t\tconst menuUrl = item.getRelativeMenuUrl();\n\t\t\t\tif (usedMenuUrls.has(menuUrl)) {\n\t\t\t\t\tthis.menuCrawlerMeta.push(new MenuItemCrawlerInfo(\n\t\t\t\t\t\titem,\n\t\t\t\t\t\t'Duplicate URL'\n\t\t\t\t\t));\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst reason = await this.shouldCrawlMenuItemNow(item, crawlerDb, bypassSchedulingChecks);\n\t\t\t\tconst previousAttemptDate = crawlerDb.getCachedLastAttemptDate(menuUrl);\n\n\t\t\t\tif (reason.isLeft()) {\n\t\t\t\t\tthis.menuCrawlerMeta.push(new MenuItemCrawlerInfo(\n\t\t\t\t\t\titem,\n\t\t\t\t\t\treason.value,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\tpreviousAttemptDate\n\t\t\t\t\t));\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (reason.isRight()) {\n\t\t\t\t\tconst request = new CrawlRequest(\n\t\t\t\t\t\tmenuUrl,\n\t\t\t\t\t\titem.getUrl(),\n\t\t\t\t\t\tthis.adminUrl,\n\t\t\t\t\t\titem.getLocation(),\n\t\t\t\t\t\t0,\n\t\t\t\t\t\treason.value,\n\t\t\t\t\t\tthis.getMenuComponent(menuUrl)\n\t\t\t\t\t);\n\n\t\t\t\t\tconst meta = new MenuItemCrawlerInfo(\n\t\t\t\t\t\titem,\n\t\t\t\t\t\treason.value,\n\t\t\t\t\t\trequest,\n\t\t\t\t\t\tpreviousAttemptDate\n\t\t\t\t\t);\n\n\t\t\t\t\tpotentialRequests.push([request, meta]);\n\t\t\t\t\tusedMenuUrls.add(menuUrl);\n\n\t\t\t\t\tthis.menuCrawlerMeta.push(meta);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (potentialRequests.length < 1) {\n\t\t\t\tCookies.remove(crawlerRunningCookie, {sameSite: 'Lax'});\n\t\t\t\treturn Either.right(0);\n\t\t\t}\n\n\t\t\tconst crawler = new Crawler(\n\t\t\t\tthis.adminUrl,\n\t\t\t\tthis.currentUserId,\n\t\t\t\tthis.removableQueryArgs,\n\t\t\t\tblacklist\n\t\t\t);\n\t\t\tthis.crawler(crawler);\n\t\t\tlet crawledPageCount = 0;\n\n\t\t\tfor (const [request, meta] of potentialRequests) {\n\t\t\t\tif (crawler.addCrawlRequest(request)) {\n\t\t\t\t\trequest.onceStatus('loading', () => {\n\t\t\t\t\t\tcrawlerDb.recordMenuAttemptStart(\n\t\t\t\t\t\t\trequest.relativePageUrl,\n\t\t\t\t\t\t\trequest.depth,\n\t\t\t\t\t\t\trequest.reason,\n\t\t\t\t\t\t\trequest.componentAndVersion\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\n\t\t\t\t\trequest.onceTreeStopped((anyRequestsAborted, summary) => {\n\t\t\t\t\t\tconst isFinished = !anyRequestsAborted;\n\t\t\t\t\t\tlogger.log('Tree stopped:', request.menuUrl, request.statusSummary());\n\n\t\t\t\t\t\tlet error = request.currentError\n\t\t\t\t\t\t\t.map((err) => err.message)\n\t\t\t\t\t\t\t.getOrElse(() => '');\n\n\t\t\t\t\t\tif (!isFinished) {\n\t\t\t\t\t\t\tconst abortError = summary.statuses['aborted'] + ' of ' + summary.totalRequests\n\t\t\t\t\t\t\t\t+ ' request(s) aborted. Found items will be discarded.';\n\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\terror = abortError + ' Additionally, there was a request error: ' + error;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\terror = abortError;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcrawlerDb.recordMenuAttemptEnd(\n\t\t\t\t\t\t\trequest.relativePageUrl,\n\t\t\t\t\t\t\trequest.status(),\n\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t\tisFinished\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (isFinished) {\n\t\t\t\t\t\t\tconst allItems = [...crawler.getFoundItems(request.menuUrl)];\n\t\t\t\t\t\t\tlogger.log('All items for menu URL \"' + request.menuUrl + '\":', allItems);\n\t\t\t\t\t\t\tthis.storeFoundItemsForMenu(request.menuUrl, allItems);\n\n\t\t\t\t\t\t\tmeta.totalUniqueItems(allItems.length);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tcrawledPageCount += summary.statuses.completed;\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\trequest.markAsError(new Error('Could not add request to the crawl queue'));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tawait crawler.start();\n\n\t\t\tCookies.remove(crawlerRunningCookie, {sameSite: 'Lax'});\n\t\t\treturn Either.right(crawledPageCount);\n\t\t}\n\n\t\tprivate readonly crawlerUrlBlacklist = lazy(() => new CrawlerUrlBlacklist([\n\t\t\t/^(post-new|media-new|link-add|user-new)\\.php/,\n\t\t\t/^(update-core|plugin-install|plugin-editor|theme-editor|customize|site-editor|widgets)\\.php/,\n\t\t\t/^(import|export|site-health)\\.php$/,\n\t\t\t/^(erase-personal-data|export-personal-data)\\.php/,\n\n\t\t\t//Some table view links, like the \"Mine\" link on the \"Posts\" page, contain a user ID.\n\t\t\t//Let's exclude all links like that. Otherwise, we would get a lot of duplicate pages.\n\t\t\t/[?&](author|user_id)=\\d+/,\n\n\t\t\t//Some scanners will replace the current user ID with a placeholder. Skip those as well.\n\t\t\tnew RegExp(escapeRegExp(userIdQueryPlaceholder)),\n\n\t\t\t//The Admin Customizer is not a normal admin page.\n\t\t\t/page=ame-admin-customizer/,\n\t\t]));\n\n\t\tprivate couldCrawlMenuItem(menuItem: AdminMenuItem, blacklist: CrawlerUrlBlacklist): Either<string, boolean> {\n\t\t\tconst menuUrl = menuItem.getRelativeMenuUrl();\n\t\t\tif (!menuUrl) {\n\t\t\t\treturn new Left('Menu URL is not a local admin page');\n\t\t\t}\n\t\t\tif (blacklist.isBlacklisted(menuUrl)) {\n\t\t\t\treturn new Left('Menu URL matches the blacklist');\n\t\t\t}\n\n\t\t\t//The fully qualified URL must point to a page in the WordPress admin dashboard.\n\t\t\t//This is just a sanity check, as this should always be true for menu items that\n\t\t\t//have a non-empty relative URL property.\n\t\t\tconst fullUrl = new URL(menuItem.getUrl(), window.location.href);\n\t\t\tif (!isAdminPageUrl(fullUrl, this.adminUrl)) {\n\t\t\t\treturn new Left('Menu URL is not a local admin page (sanity check failed)');\n\t\t\t}\n\n\t\t\t//Exclude forms of relative links that would be different on every page.\n\t\t\tif (menuItem.targetElement) {\n\t\t\t\tconst href = menuItem.targetElement.attr('href');\n\t\t\t\t//Empty hrefs link to the current page, so they're always duplicates.\n\t\t\t\tif (href === '') {\n\t\t\t\t\treturn new Left('Menu URL is an empty string');\n\t\t\t\t}\n\t\t\t\t//Relative links that only contain a query string or fragment would have\n\t\t\t\t//a different URL on every page.\n\t\t\t\tif (href && (href.startsWith('?') || href.startsWith('#'))) {\n\t\t\t\t\treturn new Left('Menu URL is only a query string or a fragment');\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn new Right(true);\n\t\t}\n\n\t\tprivate async shouldCrawlMenuItemNow(\n\t\t\tmenuItem: AdminMenuItem,\n\t\t\tcrawlerDb: DashboardCrawlerDb,\n\t\t\tbypassSchedulingChecks: boolean = false\n\t\t): Promise<Either<string, string>> {\n\t\t\t/*\n\t\t\tScan the item if:\n\t\t\t- It has never been scanned before.\n\t\t\t- The plugin or theme that added it has been updated.\n\t\t\t- A different plugin or theme is now associated with it.\n\t\t\t- We don't know which plugin added it, and more than N days have passed since the last scan.\n\t\t\t  (This should also apply to themes.)\n\t\t\tDo not scan if:\n\t\t\t- The URL is already in the scan queue (checked outside this function).\n\t\t\t- We tried to crawl the URL less than N hours ago (just in case something goes wrong with\n\t\t\t  the other checks, this will prevent excessive crawling).\n\t\t\t */\n\n\t\t\tif (bypassSchedulingChecks) {\n\t\t\t\treturn new Right('User triggered crawl job');\n\t\t\t}\n\n\t\t\tconst menuUrl = menuItem.getRelativeMenuUrl();\n\t\t\tconst timeSinceLastAttempt = await crawlerDb.getTimeSinceLastAttempt(menuUrl);\n\t\t\tconst minIntervalInMs = this.crawlerConfig.minCrawlIntervalInHours * 60 * 60 * 1000;\n\t\t\tif (timeSinceLastAttempt < minIntervalInMs) {\n\t\t\t\treturn new Left(\n\t\t\t\t\t'Time since last crawl attempt is less than the minimum interval of '\n\t\t\t\t\t+ this.crawlerConfig.minCrawlIntervalInHours + ' hours'\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tconst timeSinceLastFinishedCrawl = await crawlerDb.getTimeSinceLastFinishedCrawl(menuUrl);\n\t\t\tif (!Number.isFinite(timeSinceLastFinishedCrawl)) {\n\t\t\t\treturn new Right('Menu URL has never been crawled');\n\t\t\t}\n\n\t\t\tconst dayInMs = 24 * 60 * 60 * 1000;\n\t\t\tconst elapsedInDays = Math.floor(timeSinceLastFinishedCrawl / dayInMs);\n\n\t\t\tconst component = this.getMenuComponent(menuUrl);\n\t\t\tif (component) {\n\t\t\t\tconst oldComponentVersion = await crawlerDb.getComponentVersion(menuUrl);\n\t\t\t\tconst normalizedNewVersion = component || '';\n\t\t\t\tconst normalizedOldVersion = oldComponentVersion || '';\n\t\t\t\tif (normalizedNewVersion !== normalizedOldVersion) {\n\t\t\t\t\treturn new Right('Component version changed from ' + JSON.stringify(oldComponentVersion)\n\t\t\t\t\t\t+ ' to ' + JSON.stringify(component));\n\t\t\t\t} else {\n\t\t\t\t\t//Crawl even if the version hasn't changed, just with a longer interval. There are\n\t\t\t\t\t//rare cases where the contents of a page can change without the version changing,\n\t\t\t\t\t//e.g. if the contents depend on changes in plugin settings.\n\t\t\t\t\t//The other main benefit of periodically crawling each menu is that it helps detect\n\t\t\t\t\t//and clean up removed menus. Their crawl timestamps will eventually get very old.\n\t\t\t\t\tconst thresholdInMs = this.crawlerConfig.knownComponentCrawlIntervalInDays * dayInMs;\n\t\t\t\t\tconst componentNote = 'Component version has not changed (' + JSON.stringify(component) + ').';\n\t\t\t\t\tif (timeSinceLastFinishedCrawl > thresholdInMs) {\n\t\t\t\t\t\treturn new Right('Time since last crawl is ' + elapsedInDays\n\t\t\t\t\t\t\t+ ' days, which is more than the threshold of '\n\t\t\t\t\t\t\t+ this.crawlerConfig.knownComponentCrawlIntervalInDays + ' days. ' + componentNote);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn new Left('Time since last crawl is only ~' + elapsedInDays + ' days'\n\t\t\t\t\t\t\t+ ', but the threshold is '\n\t\t\t\t\t\t\t+ this.crawlerConfig.knownComponentCrawlIntervalInDays + ' days. ' + componentNote);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst thresholdInMs = this.crawlerConfig.unknownComponentCrawlIntervalInDays * dayInMs;\n\t\t\t\tif (timeSinceLastFinishedCrawl > thresholdInMs) {\n\t\t\t\t\treturn new Right('Time since last crawl is ' + elapsedInDays\n\t\t\t\t\t\t+ ' days, which is more than the threshold of '\n\t\t\t\t\t\t+ this.crawlerConfig.unknownComponentCrawlIntervalInDays + ' days');\n\t\t\t\t} else {\n\t\t\t\t\treturn new Left('Time since last crawl is only ~' + elapsedInDays + ' days'\n\t\t\t\t\t\t+ ', but the threshold is '\n\t\t\t\t\t\t+ this.crawlerConfig.unknownComponentCrawlIntervalInDays + ' days');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprivate getMenuComponent(relativeMenuUrl: string): string | null {\n\t\t\tif (relativeMenuUrl in this.crawlerConfig.menuComponents) {\n\t\t\t\treturn this.crawlerConfig.menuComponents[relativeMenuUrl];\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\tprivate readonly pendingDashboardIndexUpdates: Map<string, SearchableItem[]> = new Map();\n\t\tprivate dashboardIndexUpdateTimeout: number | null = null;\n\n\t\tprivate storeFoundItemsForMenu(menuUrl: string, items: SearchableItem[]) {\n\t\t\tthis.pendingDashboardIndexUpdates.set(menuUrl, items);\n\n\t\t\t//Add the items to the cache if there's room.\n\t\t\tfor (const item of items) {\n\t\t\t\tthis.searchEngine.offerItem(item);\n\t\t\t}\n\n\t\t\t//Rerun the current query if the app is open. The results will be updated with the new items.\n\t\t\tif (this.isVisible()) {\n\t\t\t\tthis.runCurrentQuery(true);\n\t\t\t}\n\n\t\t\tif (this.dashboardIndexUpdateTimeout) {\n\t\t\t\tclearTimeout(this.dashboardIndexUpdateTimeout);\n\t\t\t}\n\t\t\tthis.dashboardIndexUpdateTimeout = window.setTimeout(() => {\n\t\t\t\tconst updates: Record<string, UnknownSerializedItem[]> = {};\n\t\t\t\tfor (const [url, items] of this.pendingDashboardIndexUpdates) {\n\t\t\t\t\tupdates[url] = items.map((item) => item.toJs());\n\t\t\t\t}\n\t\t\t\tthis.pendingDashboardIndexUpdates.clear();\n\n\t\t\t\tjQuery.post(\n\t\t\t\t\tthis.ajaxUrl,\n\t\t\t\t\t{\n\t\t\t\t\t\taction: 'ws-ame-qs-update-dashboard-index',\n\t\t\t\t\t\t_ajax_nonce: wsAmeQuickSearchData.indexUpdateNonce,\n\t\t\t\t\t\tupdates: JSON.stringify(updates)\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tlogger.log('Dashboard index update response:', response);\n\t\t\t\t\t},\n\t\t\t\t\t'json'\n\t\t\t\t);\n\t\t\t}, 1000);\n\t\t}\n\n\t\t// noinspection JSUnusedGlobalSymbols -- For debugging purposes; not used by the app itself.\n\t\tdebugScanCurrentPage() {\n\t\t\tif (!this.currentAdminMenuItem || !this.currentUserId) {\n\t\t\t\tlogger.error('No current admin menu item found.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlogger.log('Current admin menu item:', this.currentAdminMenuItem);\n\t\t\tconst scanStart = performance.now();\n\t\t\tconst testScanner = new PageScanner(builtinScanners);\n\t\t\tconst adminUrl = this.adminUrl;\n\t\t\tconst testItemGenerator = testScanner.scan(\n\t\t\t\tjQuery('body .wrap'),\n\t\t\t\tthis.currentAdminMenuItem.getLocation(),\n\t\t\t\twindow.location.href,\n\t\t\t\tadminUrl,\n\t\t\t\tthis.currentAdminMenuItem.getRelativeMenuUrl(),\n\t\t\t\tthis.removableQueryArgs,\n\t\t\t\tthis.currentUserId.toString()\n\t\t\t);\n\n\t\t\tconst testItems: SearchableItem[] = [];\n\t\t\tfor (const item of testItemGenerator) {\n\t\t\t\ttestItems.push(item);\n\t\t\t}\n\n\t\t\tlogger.log('Scanner test items:', testItems);\n\t\t\tconst scanEnd = performance.now();\n\t\t\tlogger.log('Scan time:', scanEnd - scanStart, 'ms');\n\n\t\t\t//Specifically highlight items with long selectors.\n\t\t\tconst suspiciousItems = testItems.filter((item) => {\n\t\t\t\tif (item instanceof DashboardItem) {\n\t\t\t\t\tconst selector = item.getSelector();\n\t\t\t\t\treturn selector && (selector.length > 50);\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t\tlogger.log('Suspicious items:', suspiciousItems);\n\n\t\t\tthis.itemUsageTracker.populateUsageTimestamps(testItems).finally(() => {\n\t\t\t\t//Add the scanned items to the search index.\n\t\t\t\tfor (const item of testItems) {\n\t\t\t\t\tthis.searchEngine.addItem(item);\n\t\t\t\t}\n\t\t\t\t//Re-run the search to include the new items.\n\t\t\t\tthis.runCurrentQuery();\n\t\t\t});\n\t\t}\n\n\t\tpublic readonly crawlerOfferDetailsVisible: KnockoutObservable<boolean> = ko.observable(false);\n\n\t\ttoggleCrawlerOfferDetails() {\n\t\t\tthis.crawlerOfferDetailsVisible(!this.crawlerOfferDetailsVisible());\n\t\t}\n\n\t\tprivate firstAutoCrawlStarted = false;\n\n\t\tenableIncrementalCrawl() {\n\t\t\tconst oldSetting = this.crawlerConfig.enabled;\n\t\t\tthis.updateCrawlerEnabledSetting(true);\n\n\t\t\t//When the user enables the crawler, start the first crawl automatically.\n\t\t\tif ((oldSetting !== 'enabled') && !this.firstAutoCrawlStarted) {\n\t\t\t\tthis.firstAutoCrawlStarted = true;\n\t\t\t\tthis.runIncrementalCrawl();\n\t\t\t}\n\t\t}\n\n\t\tdisableIncrementalCrawl() {\n\t\t\tthis.updateCrawlerEnabledSetting(false);\n\t\t}\n\n\t\tprivate updateCrawlerEnabledSetting(enabled: boolean) {\n\t\t\tconst setting: ScriptData['crawlerConfig']['enabled'] = enabled ? 'enabled' : 'disabled';\n\t\t\tthis.crawlerConfig.enabled = setting;\n\t\t\tthis.crawlerOfferVisible(false);\n\n\t\t\tjQuery.post(\n\t\t\t\tthis.ajaxUrl,\n\t\t\t\t{\n\t\t\t\t\taction: 'ws-ame-qs-set-crawler-enabled',\n\t\t\t\t\t_ajax_nonce: this.deps.scriptData.setCrawlerEnabledNonce,\n\t\t\t\t\tenabled: setting\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\texport class AppDependencyFactory {\n\t\tpublic readonly adminUrl: URL;\n\n\t\tconstructor(public readonly scriptData: ScriptData) {\n\t\t\tif (scriptData.adminUrl) {\n\t\t\t\tthis.adminUrl = new URL(scriptData.adminUrl);\n\t\t\t} else {\n\t\t\t\tif (window.location.pathname.includes('/wp-admin/')) {\n\t\t\t\t\tconst pathParts = window.location.pathname.split('/wp-admin/', 2);\n\t\t\t\t\tthis.adminUrl = new URL(pathParts[0] + '/wp-admin/', window.location.origin);\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error('Admin URL not found.');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpublic readonly adminMenuParserResult = lazy(() => parseAdminMenuItems(\n\t\t\tjQuery('body'),\n\t\t\tthis.adminUrl,\n\t\t\tthis.scriptData.removableQueryArgs\n\t\t));\n\n\t\tpublic readonly itemUsageTracker = lazy(() => {\n\t\t\t//Get the site path from the admin URL. WordPress might be installed in a subdirectory,\n\t\t\t//and we want to include that in the store name to avoid conflicts with other sites\n\t\t\t//on the same domain.\n\t\t\tconst sitePath = this.adminUrl.pathname.replace(/\\/wp-admin\\/?$/, '');\n\t\t\treturn new ItemUsageTracker(sitePath, 200, this.scriptData.adminCookiePath);\n\t\t});\n\n\t\tpublic readonly recordCurrentVisit = lazy(() => {\n\t\t\tconst promises: Promise<void>[] = [];\n\n\t\t\tconst tracker = this.itemUsageTracker();\n\t\t\tconst currentMenuItem = this.adminMenuParserResult().currentMenuItem;\n\t\t\tif (currentMenuItem) {\n\t\t\t\tconst relativeMenuUrl = currentMenuItem.getRelativeMenuUrl();\n\t\t\t\tif (relativeMenuUrl) {\n\t\t\t\t\tpromises.push(tracker.recordMenuVisit(relativeMenuUrl));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst currentPageUrl = getRelativeAdminPageUrl(\n\t\t\t\twindow.location.href,\n\t\t\t\tthis.adminUrl,\n\t\t\t\t'',\n\t\t\t\tthis.scriptData.removableQueryArgs\n\t\t\t);\n\t\t\tif (currentPageUrl) {\n\t\t\t\tpromises.push(tracker.recordPageVisit(currentPageUrl));\n\t\t\t}\n\n\t\t\treturn Promise.all(promises);\n\t\t});\n\n\t\tpublic readonly pageStats = lazy(() => {\n\t\t\tconst stats = new PageStats();\n\n\t\t\t//Load any stats that were added to the global array before the app was initialized.\n\t\t\tif ((typeof wsAmeQuickSearchPageStats !== 'undefined') && Array.isArray(wsAmeQuickSearchPageStats)) {\n\t\t\t\tfor (const entry of wsAmeQuickSearchPageStats) {\n\t\t\t\t\tstats.push(entry);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//Replace the global array with the actual object. This still allows other scripts\n\t\t\t//to add entries by calling the push() method.\n\t\t\t(window as any)['wsAmeQuickSearchPageStats'] = stats;\n\n\t\t\treturn stats;\n\t\t});\n\t}\n\n\tko.bindingHandlers['ameQuickSearchVisible'] = {\n\t\tupdate: function (\n\t\t\telement: HTMLElement,\n\t\t\tvalueAccessor: () => { visible: KnockoutObservable<boolean>, store: PanelGeometryStore }\n\t\t) {\n\t\t\tconst value = valueAccessor();\n\t\t\tconst visible = value.visible;\n\n\t\t\tif (ko.unwrap(visible)) {\n\t\t\t\t//Show the search panel in the center of the screen.\n\t\t\t\tconst $panel = jQuery(element).show();\n\n\t\t\t\t//Restore the previous position if available.\n\t\t\t\tconst store = ko.unwrap(value.store);\n\t\t\t\tconst position = store.getStoredPositionForJQuery()\n\t\t\t\t\t.getOrElse(() => ({\n\t\t\t\t\t\tmy: 'center',\n\t\t\t\t\t\tat: 'center center-10%'\n\t\t\t\t\t}));\n\n\t\t\t\t$panel.position({\n\t\t\t\t\tmy: position.my,\n\t\t\t\t\tat: position.at,\n\t\t\t\t\tof: window,\n\t\t\t\t\tcollision: 'fit'\n\t\t\t\t});\n\n\t\t\t\t//Ensure it doesn't overlap the Admin Bar.\n\t\t\t\tconst adminBarHeight = jQuery('#wpadminbar').outerHeight() || 0;\n\t\t\t\tconst panelTop = parseInt($panel.css('top'), 10);\n\t\t\t\tif (panelTop < adminBarHeight) {\n\t\t\t\t\t$panel.css('top', adminBarHeight);\n\t\t\t\t}\n\n\t\t\t\t//Close the panel when the user clicks outside of it.\n\t\t\t\tif (ko.isObservable(visible)) {\n\t\t\t\t\tjQuery(document).on('mousedown.ameQcSearchPanelHide', function (event) {\n\t\t\t\t\t\tif (!jQuery(event.target).closest($panel).length) {\n\t\t\t\t\t\t\tvisible(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tjQuery(element).hide();\n\n\t\t\t\t//Remove the click outside listener.\n\t\t\t\tjQuery(document).off('mousedown.ameQcSearchPanelHide');\n\t\t\t}\n\t\t}\n\t};\n\n\tko.bindingHandlers['ameQuickSearchInputFocused'] = {\n\t\tinit: function (element: HTMLElement, valueAccessor: () => KnockoutObservable<boolean>) {\n\t\t\tconst value = valueAccessor();\n\t\t\tif (ko.isObservable(value)) {\n\t\t\t\tjQuery(element).on('focus.ameQSFocusBinding', function () {\n\t\t\t\t\tvalue(true);\n\t\t\t\t}).on('blur.ameQSFocusBinding', function () {\n\t\t\t\t\tvalue(false);\n\t\t\t\t});\n\t\t\t}\n\t\t\tko.utils.domNodeDisposal.addDisposeCallback(element, function () {\n\t\t\t\tjQuery(element).off('focus.ameQSFocusBinding').off('blur.ameQSFocusBinding');\n\t\t\t});\n\t\t},\n\t\tupdate: function (element: HTMLElement, valueAccessor: () => KnockoutObservable<boolean>) {\n\t\t\tconst value = ko.unwrap(valueAccessor());\n\t\t\tif (value) {\n\t\t\t\tconst $element = jQuery(element);\n\t\t\t\tif (!$element.is(':focus')) {\n\t\t\t\t\t$element.trigger('focus').trigger('select');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tko.bindingHandlers['ameAutoScrollToChild'] = {\n\t\tupdate: function (element: HTMLElement, valueAccessor: () => KnockoutObservable<unknown>) {\n\t\t\tconst value = ko.unwrap(valueAccessor());\n\t\t\tif (value === null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//Find the child that has the value as its KO data.\n\t\t\tconst $child = jQuery(element).children().filter(function (_, child) {\n\t\t\t\treturn ko.dataFor(child) === value;\n\t\t\t});\n\t\t\t//Scroll the child into view.\n\t\t\tif ($child.length > 0) {\n\t\t\t\t$child.get(0).scrollIntoView({block: 'nearest'});\n\t\t\t}\n\t\t}\n\t};\n}\n\njQuery(function () {\n\tlet app: AmeQuickSearchTool.QuickSearchApp | null = null;\n\tconst appDeps = new AmeQuickSearchTool.AppDependencyFactory(wsAmeQuickSearchData);\n\n\tconst logger = log.getLogger('AmeQuickSearchTool');\n\tif (appDeps.scriptData.jsLogLevel) {\n\t\tlogger.setDefaultLevel(appDeps.scriptData.jsLogLevel);\n\t}\n\n\tif (appDeps.scriptData.recencyTracking === 'enabled') {\n\t\t// noinspection JSIgnoredPromiseFromCall\n\t\tappDeps.recordCurrentVisit();\n\t}\n\n\t//Navigate to the target element if a selector was passed in the URL. The server-side script\n\t//will have verified the nonce and added the selector to scriptData.\n\tif (appDeps.scriptData.navigationTargetSelector) {\n\t\tAmeQuickSearchTool.completeNavigation(appDeps.scriptData.navigationTargetSelector);\n\t}\n\t//Remove the selector query parameter from the URL. Note that we do this even if the selector\n\t//was invalid and navigation didn't happen. This is to prevent potential conflicts with adding\n\t//unnecessary parameters to the URL.\n\tconst url = new URL(window.location.href);\n\tif (url.searchParams.has(AmeQuickSearchTool.NavigationSelectorParam)) {\n\t\turl.searchParams.delete(AmeQuickSearchTool.NavigationSelectorParam);\n\t\twindow.history.replaceState({}, '', url.toString());\n\t}\n\n\tfunction handleSearchTrigger() {\n\t\tif (!app) {\n\t\t\tconst $appRoot = jQuery('#ame-quick-search-root');\n\n\t\t\tapp = new AmeQuickSearchTool.QuickSearchApp(appDeps);\n\t\t\tko.applyBindings(app, $appRoot.get(0));\n\n\t\t\t//Make the app resizable.\n\t\t\tconst minSize = {\n\t\t\t\twidth: 200,\n\t\t\t\theight: 100\n\t\t\t};\n\t\t\tconst windowSize = {\n\t\t\t\twidth: window.innerWidth,\n\t\t\t\theight: window.innerHeight\n\t\t\t};\n\n\t\t\t//Load the previous custom size from a cookie, limiting it to the window size.\n\t\t\tapp.geometryStore.getStoredSize().map((size) => {\n\t\t\t\tlet hasAnyCustomSize = false;\n\t\t\t\tif (size.width && (size.width >= minSize.width) && (size.width <= windowSize.width)) {\n\t\t\t\t\t$appRoot.width(Math.round(size.width));\n\t\t\t\t\thasAnyCustomSize = true;\n\t\t\t\t}\n\t\t\t\tif (size.height && (size.height >= minSize.height) && (size.height <= windowSize.height)) {\n\t\t\t\t\t$appRoot.height(Math.round(size.height));\n\t\t\t\t\thasAnyCustomSize = true;\n\t\t\t\t}\n\t\t\t\tif (hasAnyCustomSize) {\n\t\t\t\t\t$appRoot.addClass('ame-qs-has-custom-size');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$appRoot.resizable({\n\t\t\t\tminWidth: minSize.width,\n\t\t\t\tminHeight: minSize.height,\n\t\t\t\tstop: function (_, ui) {\n\t\t\t\t\tapp?.geometryStore.storeSize(ui.size);\n\t\t\t\t\t$appRoot.addClass('ame-qs-has-custom-size');\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//Also make the app draggable.\n\t\t\t$appRoot.draggable({\n\t\t\t\thandle: '.ame-qs-header',\n\t\t\t\tcancel: '.ame-qs-tab-nav li, .ame-qs-stats-property',\n\t\t\t\tcontainment: 'window',\n\t\t\t\tscroll: false,\n\t\t\t\tstop: function (_, ui) {\n\t\t\t\t\tapp?.geometryStore.storePosition(\n\t\t\t\t\t\tui.position.top,\n\t\t\t\t\t\tui.position.left,\n\t\t\t\t\t\tui.helper.outerWidth(),\n\t\t\t\t\t\tui.helper.outerHeight()\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//Handle clicks on items in the search results.\n\t\t\t$appRoot.find('.ame-qs-search-results').on('click', '.ame-qs-search-result', function (event) {\n\t\t\t\tif (app) {\n\t\t\t\t\tconst item = ko.dataFor(event.target);\n\t\t\t\t\tif (item) {\n\t\t\t\t\t\tapp.handleResultClick(item);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tlogger.log('Displaying app');\n\t\tapp.display();\n\t\treturn false;\n\t}\n\n\t//The default action seems to be \"keypress\" which works for most shortcuts. However,\n\t//for some like \"shift shift\", we need to use \"keyup\" instead so that it doesn't\n\t//trigger when the key is just held down.\n\tconst keyboardShortcut = wsAmeQuickSearchData.keyboardShortcut;\n\tconst shortcutAction = keyboardShortcut.indexOf(' ') >= 0 ? 'keyup' : 'keypress';\n\n\tfunction toggleKeyboardShortcut(enabled: boolean) {\n\t\tif (enabled) {\n\t\t\twsAmeMousetrap.bind(keyboardShortcut, handleSearchTrigger, shortcutAction);\n\t\t} else {\n\t\t\twsAmeMousetrap.unbind(keyboardShortcut, shortcutAction);\n\t\t}\n\t}\n\n\ttoggleKeyboardShortcut(true);\n\n\t//Let the settings tab script turn off the live hotkey while testing shortcut settings.\n\tjQuery(document).on('adminMenuEditor:qsDisableHotkey', function () {\n\t\ttoggleKeyboardShortcut(false);\n\t}).on('adminMenuEditor:qsReEnableHotkey', function () {\n\t\ttoggleKeyboardShortcut(true);\n\t});\n\n\t//Handle the Toolbar button.\n\tjQuery('#wp-admin-bar-ame-quick-search-tb')\n\t\t.on('click', handleSearchTrigger)\n\t\t.addClass('ame-qs-tb-ready');\n});\n","import {getCssSelector} from 'css-selector-generator';\nimport {condenseWhitespace, getElementTextForItemLabel, getRelativeAdminPageUrl, queryAdvancedSelector} from './utils';\nimport {AdminMenuItem, DashboardItem, DashboardItemProps, ItemLocation, ItemSelector, SearchableItem} from './items';\n\nconst $ = jQuery;\n\ninterface ScannerContext {\n\t$container: JQuery;\n\tlocation: ItemLocation;\n\n\tpageUrl: URL;\n\trelativePageUrl: string;\n\tadminUrl: URL;\n\tremovableQueryArgs: string[];\n\tcurrentUserId: string | null;\n\tidRegistry: ItemIdRegistry;\n\n\tdashboardItemOrigin: DashboardItemProps['origin'];\n\n\tisElementFound: ($element: JQuery) => boolean;\n\tmarkElementAsFound: ($element: JQuery) => void;\n\tisInBlacklistedContainer: ($element: JQuery) => boolean;\n\tfindParentSection: ($element: JQuery, $context?: JQuery) => PotentialSection | null;\n}\n\ntype ItemScanner = (context: ScannerContext) => Generator<SearchableItem, void, undefined>;\n\ninterface PotentialSection {\n\telement: Element;\n\theaderText: string;\n\tisContainer: boolean;\n\tdetectedItemCount: number;\n\tgenericContainerSelector?: string;\n}\n\n/**\n * Generate a unique CSS selector or traversal path for the given element.\n *\n * The optional childItems parameter can be used to generate more complex selector chains\n * that traverse the DOM from a child item to the parent element.\n *\n * @param $element\n * @param childItems Optional. This list should only include actual descendants (and not, for\n *                   example, items that follow a heading but are not its children in the DOM).\n * @param generalContainerSelector\n */\nfunction generateCssSelectorFor(\n\t$element: JQuery,\n\tchildItems: SearchableItem[] = [],\n\tgeneralContainerSelector?: string\n): ItemSelector {\n\t//While getCssSelector() is generally good at generating unique selectors, it can be\n\t//slow, and it tends to overuse nth-child selectors. We try a few other methods first\n\t//and try to constrain the behavior of getCssSelector().\n\n\t//Just use the ID if available.\n\tconst id = $element.prop('id');\n\tif (id) {\n\t\treturn `#${id}`;\n\t}\n\n\t//\"css-selector-generator\" tends to overuse nth-child selectors for form controls that\n\t//don't have IDs. Instead, we could use the name and value attributes for checkbox and\n\t//radio inputs.\n\tconst $root = $element.closest('body');\n\tif ($element.is('input[type=\"checkbox\"], input[type=\"radio\"]')) {\n\t\tconst name = $element.prop('name');\n\t\tconst value = $element.prop('value');\n\t\tif (name && value) {\n\t\t\tconst possibleSelector = `input[name=\"${name}\"][value=\"${value}\"]`;\n\t\t\tif ($root.find(possibleSelector).length === 1) {\n\t\t\t\treturn possibleSelector;\n\t\t\t}\n\t\t}\n\t} else if ($element.is('select')) {\n\t\t//Select elements could also be identified by their name attribute.\n\t\tconst name = $element.prop('name');\n\t\tif (name) {\n\t\t\tconst possibleSelector = `select[name=\"${name}\"]`;\n\t\t\tif ($root.find(possibleSelector).length === 1) {\n\t\t\t\treturn possibleSelector;\n\t\t\t}\n\t\t}\n\t}\n\n\t//Note: I've tried to improve performance by finding a unique parent with an ID first\n\t//and passing it to getCssSelector() as the root element, but this seems to occasionally\n\t//cause getCssSelector() fall back to \":root\" followed by a long selector chain.\n\t//Unclear why this happens, I'm not familiar with the internals of the library.\n\n\tlet selector = getCssSelector($element.get(0), {\n\t\tselectors: [\n\t\t\t'id', 'class', 'attribute', 'tag',\n\t\t\t'nthchild'\n\t\t],\n\t\twhitelist: [\n\t\t\t'settings_page_*',\n\t\t\t'*-php',\n\t\t\t'[name=*]',\n\t\t\t'[value=*]',\n\t\t\t'.subsubsub'\n\t\t],\n\t\tblacklist: [\n\t\t\t'[checked]',\n\t\t\t'[selected]',\n\t\t\t'[disabled]',\n\t\t\t'[readonly]',\n\t\t\t'[type=\"hidden\"]',\n\t\t\t\"[checked='checked']\",\n\t\t\t'[data-*]',\n\t\t],\n\t\tmaxCombinations: 50,\n\t\tmaxCandidates: 10\n\t});\n\n\t//todo: Look into text fragments.\n\t// https://developer.mozilla.org/en-US/docs/Web/Text_fragments\n\n\tif (selector.includes('nth-child')) {\n\t\t//Avoid nth-child selectors if possible as they are likely to break if anything\n\t\t//is added to or removed from the page.\n\n\t\t//If the element contains any items with unique ID selectors, use those combined\n\t\t//with a \"closest\" operation to find the element.\n\t\tif ((childItems.length > 0) && generalContainerSelector) {\n\t\t\tfor (const item of childItems) {\n\t\t\t\tif (item instanceof DashboardItem) {\n\t\t\t\t\tconst selector = item.getSelector();\n\t\t\t\t\tif ((typeof selector === 'string') && selector.startsWith('#')) {\n\t\t\t\t\t\tconst potentialPath: ItemSelector = [\n\t\t\t\t\t\t\t{selector, operation: 'find'},\n\t\t\t\t\t\t\t{selector: generalContainerSelector, operation: 'closest'}\n\t\t\t\t\t\t];\n\n\t\t\t\t\t\t//Check if the path actually leads to the element,\n\t\t\t\t\t\t//and *only* to this element.\n\t\t\t\t\t\tconst $found = queryAdvancedSelector(potentialPath);\n\t\t\t\t\t\tif (($found.length === 1) && $found.is($element)) {\n\t\t\t\t\t\t\treturn potentialPath;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//contains() is also an option since selectors are passed to jQuery,\n\t\t//but it's likely slower and more likely to get duplicate matches.\n\t}\n\n\treturn selector;\n}\n\nfunction findLabelElementFor($field: JQuery, $container?: JQuery, ignoreParentLabel: boolean = false): JQuery {\n\tif (!ignoreParentLabel) {\n\t\tconst $label = $field.closest('label');\n\t\tif ($label.length > 0) {\n\t\t\treturn $label;\n\t\t}\n\t}\n\n\tconst id = $field.prop('id');\n\tif (id) {\n\t\tconst selector = `label[for=\"${id}\"]`;\n\t\tconst $label = $container ? $container.find(selector) : jQuery(selector);\n\t\tif ($label.length > 0) {\n\t\t\treturn $label;\n\t\t}\n\t}\n\n\treturn jQuery();\n}\n\nfunction getFormFieldLabel($field: JQuery, $container: JQuery, ignoreParentLabel: boolean = false): string {\n\tlet text: string = '';\n\tif ($field.is('input[type=\"button\"]')) {\n\t\ttext = $field.val() || '';\n\t} else {\n\t\tconst $label = findLabelElementFor($field, $container, ignoreParentLabel);\n\t\tif ($label.length < 1) {\n\t\t\treturn '';\n\t\t}\n\t\ttext = getElementTextForItemLabel($label, ' ');\n\t}\n\n\treturn condenseWhitespace(text);\n\t//todo: Limit max label length.\n}\n\ninterface ComplexControlSpec {\n\tselector: string;\n\tdescription: string;\n\tgetLabelElement?: ($control: JQuery, $container: JQuery) => JQuery;\n}\n\nconst complexControls: ComplexControlSpec[] = [\n\t{\n\t\tselector: '.wp-picker-container',\n\t\tdescription: 'Color picker',\n\t\tgetLabelElement: ($control, $container) => {\n\t\t\tconst hiddenInput = $control.find('input[type=\"text\"].wp-color-picker').first();\n\t\t\tconst id = hiddenInput.prop('id');\n\t\t\tif (id) {\n\t\t\t\tconst labelSelector = `label[for=\"${id}\"]`;\n\t\t\t\treturn $container.find(labelSelector);\n\t\t\t}\n\t\t\treturn jQuery();\n\t\t}\n\t},\n\t{selector: '.CodeMirror, .CodeMirror-wrap', description: 'Code editor'},\n\t{selector: '.wp-editor-wrap', description: 'TinyMCE editor'},\n];\n\nconst complexControlSelectors = complexControls.map((control) => control.selector).join(', ');\n\ninterface FindControlsResult {\n\t$element: JQuery;\n\tlabel: string;\n}\n\nfunction findControls(\n\t$container: JQuery,\n\tcontext: ScannerContext,\n\tincludeUnlabelledControls: boolean = false\n): FindControlsResult[] {\n\t//Look for form controls in general. Skip already included controls.\n\tconst $controls = $container.find('input, select, textarea, .CodeMirror, .wp-editor-wrap')\n\t\t.not('[type=\"hidden\"], [type=\"submit\"], [type=\"reset\"], .button-primary');\n\tif ($controls.length === 0) {\n\t\treturn [];\n\t}\n\n\tconst acceptedCollapsibleContainers = [\n\t\t'.postbox',\n\t\t'.ws-ame-postbox',\n\t];\n\tconst acceptedCollapsibleSelectors = acceptedCollapsibleContainers.join(', ');\n\n\tconst foundElements: Set<Element> = new Set<Element>();\n\tconst results: FindControlsResult[] = [];\n\t$controls.each((_, control) => {\n\t\tlet $control = $(control);\n\t\tif (context.isElementFound($control) || context.isInBlacklistedContainer($control)) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet $customLabelElement: JQuery | null = null;\n\n\t\t//If the control is inside a complex control, select the complex control instead.\n\t\tconst $complexControl = $control.closest(complexControlSelectors);\n\t\tif ($complexControl.length > 0) {\n\t\t\t$control = $complexControl;\n\n\t\t\tconst complexControl = complexControls.find((spec) => $control.is(spec.selector));\n\t\t\tif (complexControl && complexControl.getLabelElement) {\n\t\t\t\t$customLabelElement = complexControl.getLabelElement($control, $container);\n\t\t\t}\n\t\t}\n\n\t\t//Skip controls that we've already included in the results during this run. This can\n\t\t//happen if a complex control - e.g. a color picker - contains multiple form controls.\n\t\tif (foundElements.has($control.get(0))) {\n\t\t\treturn;\n\t\t}\n\n\t\t//Skip explicitly hidden controls (\"display: none\" or \"visibility: hidden\").\n\t\tif (($control.css('display') === 'none') || ($control.css('visibility') === 'hidden')) {\n\t\t\t// console.log('Skipping explicitly hidden control:', $control);\n\t\t\treturn;\n\t\t}\n\n\t\t//Skip invisible controls unless they're inside a container that we know can be opened\n\t\t//by the user. Some invisible controls are used as templates or placeholders, so we don't\n\t\t//want to include all of them in the search results.\n\t\tif (!$control.is(':visible') && ($control.closest(acceptedCollapsibleSelectors).length === 0)) {\n\t\t\t// console.log('Skipping invisible control:', $control);\n\t\t\treturn;\n\t\t}\n\n\t\tlet label: string;\n\t\tif ($customLabelElement) {\n\t\t\tlabel = getElementTextForItemLabel($customLabelElement, ' ');\n\t\t} else {\n\t\t\tlabel = getFormFieldLabel($control, context.$container);\n\t\t}\n\t\tif ((label === '') && !includeUnlabelledControls) {\n\t\t\t// console.log('Skipping control with empty label:', $control);\n\t\t\treturn;\n\t\t}\n\n\t\tresults.push({$element: $control, label});\n\t\tfoundElements.add($control.get(0));\n\t});\n\n\treturn results;\n}\n\nconst userIdParams = ['user_id', 'user', 'author', 'author_id'];\nexport const userIdQueryPlaceholder = '_ame_qs_current_user_id_';\n\nfunction replaceUserIdWIthPlaceholder(relativeUrl: string, parsedUrl: URL, context: ScannerContext): string | null {\n\tif (!context.currentUserId) {\n\t\treturn relativeUrl;\n\t}\n\n\tconst foundParams = userIdParams.filter(\n\t\t(param) => parsedUrl.searchParams.has(param) && (parsedUrl.searchParams.get(param) === context.currentUserId)\n\t);\n\n\tif (foundParams.length === 0) {\n\t\treturn relativeUrl;\n\t}\n\n\tconst urlCopy = new URL(parsedUrl.href);\n\tfor (const param of foundParams) {\n\t\turlCopy.searchParams.set(param, userIdQueryPlaceholder);\n\t}\n\n\treturn getRelativeAdminPageUrl(\n\t\turlCopy.href,\n\t\tcontext.adminUrl,\n\t\tcontext.pageUrl,\n\t\tcontext.removableQueryArgs\n\t);\n}\n\n//region Scanner functions\n\n//I've defined these as separate, named functions to make it easier to jump to the relevant code\n//during development. They could be inline in the array below, but that's less convenient.\n\nfunction* scanClassicTabs(context: ScannerContext): Generator<SearchableItem, void, undefined> {\n\tconst items: SearchableItem[] = [];\n\n\tcontext.$container.find('.nav-tab-wrapper .nav-tab').each((_, element) => {\n\t\tconst $tab = $(element);\n\t\tif (context.isElementFound($tab) || context.isInBlacklistedContainer($tab)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst $link = $tab.is('a') ? $tab : $tab.find('a').first();\n\t\tconst label = $tab.text().trim();\n\t\tconst url = $link.prop('href') || '';\n\t\tif (url) {\n\t\t\tlet relativeUrl = getRelativeAdminPageUrl(\n\t\t\t\turl,\n\t\t\t\tcontext.adminUrl,\n\t\t\t\tcontext.pageUrl,\n\t\t\t\tcontext.removableQueryArgs\n\t\t\t);\n\t\t\tif (!relativeUrl) {\n\t\t\t\treturn; //Skip external and non-admin links.\n\t\t\t}\n\n\t\t\tconst parsedUrl = new URL(url, context.pageUrl);\n\t\t\trelativeUrl = replaceUserIdWIthPlaceholder(relativeUrl, parsedUrl, context);\n\t\t\tif (!relativeUrl) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = new DashboardItem({\n\t\t\t\tlabel: label,\n\t\t\t\townLabel: label,\n\t\t\t\ttarget: {\n\t\t\t\t\turl: relativeUrl,\n\t\t\t\t\ttype: 'tab',\n\t\t\t\t},\n\t\t\t\tlocation: context.location,\n\t\t\t\torigin: context.dashboardItemOrigin,\n\t\t\t\trelativeId: context.idRegistry.generateId({\n\t\t\t\t\tlabel,\n\t\t\t\t\turl: relativeUrl,\n\t\t\t\t\t$element: $tab,\n\t\t\t\t\ttypePrefix: 'tab:'\n\t\t\t\t})\n\t\t\t});\n\t\t\titems.push(item);\n\t\t\tcontext.markElementAsFound($tab);\n\t\t} else {\n\t\t\tconst item = new DashboardItem({\n\t\t\t\tlabel: label,\n\t\t\t\ttarget: {\n\t\t\t\t\turl: context.relativePageUrl,\n\t\t\t\t\tselector: generateCssSelectorFor($tab),\n\t\t\t\t\ttype: 'tab',\n\t\t\t\t},\n\t\t\t\torigin: context.dashboardItemOrigin,\n\t\t\t\tlocation: context.location,\n\t\t\t\trelativeId: context.idRegistry.generateId({\n\t\t\t\t\tlabel,\n\t\t\t\t\t$element: $tab,\n\t\t\t\t\ttypePrefix: 'tab:'\n\t\t\t\t})\n\t\t\t});\n\t\t\titems.push(item);\n\t\t\tcontext.markElementAsFound($tab);\n\t\t}\n\t});\n\tyield* items;\n}\n\nfunction* scanFormTableFields(context: ScannerContext): ReturnType<ItemScanner> {\n\tconst items: SearchableItem[] = [];\n\n\tcontext.$container.find('table.form-table').each((_, element) => {\n\t\tconst $table = $(element);\n\t\tif (context.isInBlacklistedContainer($table)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst section = context.findParentSection($table);\n\t\tconst tableLocation = context.location.slice();\n\t\tif (section) {\n\t\t\ttableLocation.push(section.headerText);\n\t\t}\n\n\t\t$table.find('> tbody > tr').each((_, row) => {\n\t\t\t// console.log('Row:', row);\n\t\t\t//We expect a <th> followed by a <td> in each row.\n\t\t\t//In rare cases, there can be a single <td> instead, like the \"Organize my\n\t\t\t//uploads into month- and year-based folders\" setting in \"Settings -> Media\".\n\t\t\tconst $row = $(row);\n\t\t\tconst $td = $row.find('> td').first();\n\t\t\tconst $th = $td.prev('th');\n\t\t\tif ($td.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst rowHeading = $th.text().trim();\n\n\t\t\tconst controls = findControls($td, context, true);\n\t\t\tif (controls.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst itemsInRow: SearchableItem[] = [];\n\t\t\tfor (const control of controls) {\n\t\t\t\tlet label: string = control.label;\n\t\t\t\tif (label === '') {\n\t\t\t\t\t//If there is only one control in the row, the row heading is the label.\n\t\t\t\t\tif (controls.length === 1) {\n\t\t\t\t\t\tlabel = rowHeading;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn; //Skip unlabeled controls.\n\t\t\t\t\t}\n\t\t\t\t} else if (rowHeading !== '') {\n\t\t\t\t\t//Add the row heading to the label unless the heading already contains the label.\n\t\t\t\t\t//Some admin pages do this; a field's <label> can be inside the <th>.\n\t\t\t\t\tif (!label.startsWith(rowHeading)) {\n\t\t\t\t\t\tlabel = rowHeading + ': ' + label;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst item = new DashboardItem({\n\t\t\t\t\tlabel: label,\n\t\t\t\t\ttarget: {\n\t\t\t\t\t\turl: context.relativePageUrl,\n\t\t\t\t\t\tselector: generateCssSelectorFor(control.$element),\n\t\t\t\t\t\ttype: 'control',\n\t\t\t\t\t},\n\t\t\t\t\tlocation: tableLocation,\n\t\t\t\t\torigin: context.dashboardItemOrigin,\n\t\t\t\t\trelativeId: context.idRegistry.generateId({\n\t\t\t\t\t\tlabel,\n\t\t\t\t\t\t$element: control.$element,\n\t\t\t\t\t\tsection\n\t\t\t\t\t})\n\t\t\t\t});\n\n\t\t\t\titems.push(item);\n\t\t\t\tcontext.markElementAsFound(control.$element);\n\t\t\t\titemsInRow.push(item);\n\n\t\t\t\tif (section) {\n\t\t\t\t\tsection.detectedItemCount++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//Add the row itself as an item if it contains multiple controls.\n\t\t\tif (itemsInRow.length > 1) {\n\t\t\t\tconst item = new DashboardItem({\n\t\t\t\t\tlabel: rowHeading,\n\t\t\t\t\ttarget: {\n\t\t\t\t\t\turl: context.relativePageUrl,\n\t\t\t\t\t\tselector: generateCssSelectorFor($row, itemsInRow, 'tr'),\n\t\t\t\t\t\ttype: 'group',\n\t\t\t\t\t},\n\t\t\t\t\tlocation: tableLocation,\n\t\t\t\t\torigin: context.dashboardItemOrigin,\n\t\t\t\t\trelativeId: context.idRegistry.generateId({\n\t\t\t\t\t\tlabel: rowHeading,\n\t\t\t\t\t\t$element: $row,\n\t\t\t\t\t\tsection,\n\t\t\t\t\t\ttypePrefix: 'row:'\n\t\t\t\t\t})\n\t\t\t\t});\n\t\t\t\titems.push(item);\n\t\t\t\tcontext.markElementAsFound($row);\n\t\t\t}\n\t\t});\n\t});\n\n\tyield* items;\n}\n\nfunction* scanGeneralFormControls(context: ScannerContext): ReturnType<ItemScanner> {\n\t//Look for form controls in general.\n\tconst controls = findControls(context.$container, context);\n\tif (controls.length === 0) {\n\t\treturn;\n\t}\n\n\tconst items: SearchableItem[] = [];\n\tconst foundSections: Map<PotentialSection, SearchableItem[]> = new Map();\n\n\tfor (const control of controls) {\n\t\tconst $control = control.$element;\n\n\t\tlet location = context.location.slice();\n\t\tconst section = context.findParentSection($control);\n\t\tif (section) {\n\t\t\tlocation.push(section.headerText);\n\t\t}\n\n\t\tconst item = new DashboardItem({\n\t\t\tlabel: control.label,\n\t\t\ttarget: {\n\t\t\t\turl: context.relativePageUrl,\n\t\t\t\tselector: generateCssSelectorFor($control),\n\t\t\t\ttype: 'control',\n\t\t\t},\n\t\t\tlocation: location,\n\t\t\torigin: context.dashboardItemOrigin,\n\t\t\trelativeId: context.idRegistry.generateId({\n\t\t\t\tlabel: control.label,\n\t\t\t\t$element: $control,\n\t\t\t\tsection\n\t\t\t})\n\t\t});\n\n\t\tcontext.markElementAsFound($control);\n\n\t\tif (section) {\n\t\t\tconst sectionItems = foundSections.get(section) || [];\n\t\t\tsectionItems.push(item);\n\t\t\tfoundSections.set(section, sectionItems);\n\t\t\tsection.detectedItemCount++;\n\t\t} else {\n\t\t\titems.push(item);\n\t\t}\n\t}\n\n\tfor (const [section, sectionItems] of foundSections.entries()) {\n\t\tif (sectionItems.length < 1) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t//Add non-empty sections as items.\n\t\tconst $sectionElement = jQuery(section.element);\n\t\tif (!context.isElementFound($sectionElement)) {\n\t\t\titems.push(new DashboardItem({\n\t\t\t\tlabel: section.headerText,\n\t\t\t\ttarget: {\n\t\t\t\t\turl: context.relativePageUrl,\n\t\t\t\t\tselector: generateCssSelectorFor($sectionElement, sectionItems, section.genericContainerSelector),\n\t\t\t\t\ttype: 'section',\n\t\t\t\t},\n\t\t\t\tlocation: context.location,\n\t\t\t\torigin: context.dashboardItemOrigin,\n\t\t\t\trelativeId: context.idRegistry.generateId({\n\t\t\t\t\tlabel: section.headerText,\n\t\t\t\t\t$element: $sectionElement,\n\t\t\t\t\tsection,\n\t\t\t\t\ttypePrefix: 's:'\n\t\t\t\t})\n\t\t\t}));\n\t\t\tcontext.markElementAsFound($sectionElement);\n\t\t}\n\n\t\t//If a section contains a large number of controls, the controls might not be individually\n\t\t//important. For example, it could be a list of checkboxes for all post categories, or\n\t\t//visibility settings for sidebar widgets, etc. In such cases, we should include the section\n\t\t//itself as an item but not the individual controls.\n\t\tconst controlsCount = sectionItems.length;\n\t\tconst bigSectionControlCountThreshold = 20;\n\t\t//Similarly, if most of the controls in a section have short labels, that's another\n\t\t//sign they're not individually important.\n\t\tconst shortLabelsControlCountThreshold = 5;\n\t\tconst shortLabelLength = 20;\n\t\tconst shortLabelItemFraction = 0.8;\n\n\t\tlet shortLabelsFound = 0;\n\t\tfor (const item of sectionItems) {\n\t\t\tif (item.label.length <= shortLabelLength) {\n\t\t\t\tshortLabelsFound++;\n\t\t\t}\n\t\t}\n\n\t\tconst shouldOnlyAddSection = (controlsCount > bigSectionControlCountThreshold)\n\t\t\t|| (\n\t\t\t\t(controlsCount > shortLabelsControlCountThreshold)\n\t\t\t\t&& ((shortLabelsFound / controlsCount) > shortLabelItemFraction)\n\t\t\t);\n\n\t\tif (shouldOnlyAddSection) {\n\t\t\tconsole.log('Controls in section will be skipped:', section.headerText);\n\t\t\tconsole.log('Control count:', controlsCount, 'Short labels:', shortLabelsFound);\n\t\t\tconsole.log(sectionItems);\n\t\t\tcontinue;\n\t\t}\n\n\t\t//Otherwise, include all the controls found in the section.\n\t\tfor (const item of sectionItems) {\n\t\t\titems.push(item);\n\t\t}\n\t}\n\n\tyield* items;\n}\n\nfunction* scanSubFilters(context: ScannerContext): ReturnType<ItemScanner> {\n\t//Find .subsubsub filters in the page.\n\tconst items: SearchableItem[] = [];\n\tcontext.$container.find('.subsubsub li a').each((_, element) => {\n\t\tconst $link = jQuery(element);\n\t\tif (context.isElementFound($link) || context.isInBlacklistedContainer($link)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst hrefAttr = $link.attr('href') || '';\n\t\tconst url = $link.prop('href') || '';\n\n\t\tlet label = $link.text().trim();\n\t\t//Remove the count bubble, if any.\n\t\tlabel = label.replace(/\\s*\\(\\d+\\)\\s*$/, '').trim();\n\t\tconst ownLabel = label;\n\n\t\t//The filter labels alone are usually not unique enough to identify the filter\n\t\t//at a glance. Let's add the  parent section, location, or page heading to the label.\n\t\tconst section = context.findParentSection($link);\n\t\tif (section) {\n\t\t\tlabel = section.headerText + ': ' + label;\n\t\t} else if (context.location.length > 0) {\n\t\t\tlabel = context.location[context.location.length - 1] + ': ' + label;\n\t\t} else {\n\t\t\tconst headingSelector = context.$container.is('.wrap') ? 'h1' : '.wrap h1';\n\t\t\tconst $firstHeading = context.$container.find(headingSelector).first();\n\t\t\tif ($firstHeading.length > 0) {\n\t\t\t\tconst headingText = $firstHeading.text().trim();\n\t\t\t\tif (headingText.length > 2) {\n\t\t\t\t\tlabel = headingText + ': ' + label;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ((hrefAttr === '') || hrefAttr.startsWith('#')) {\n\t\t\tconst selector = generateCssSelectorFor($link);\n\t\t\tconst item = new DashboardItem({\n\t\t\t\tlabel: label,\n\t\t\t\townLabel: ownLabel,\n\t\t\t\ttarget: {\n\t\t\t\t\turl: context.relativePageUrl,\n\t\t\t\t\tselector: selector,\n\t\t\t\t\ttype: 'filter',\n\t\t\t\t},\n\t\t\t\tlocation: context.location,\n\t\t\t\torigin: context.dashboardItemOrigin,\n\t\t\t\trelativeId: context.idRegistry.generateId({\n\t\t\t\t\tlabel,\n\t\t\t\t\t$element: $link,\n\t\t\t\t\ttypePrefix: 'f:'\n\t\t\t\t})\n\t\t\t});\n\t\t\titems.push(item);\n\t\t\tcontext.markElementAsFound($link);\n\t\t} else {\n\t\t\tlet relativeUrl = getRelativeAdminPageUrl(\n\t\t\t\turl,\n\t\t\t\tcontext.adminUrl,\n\t\t\t\tcontext.pageUrl,\n\t\t\t\tcontext.removableQueryArgs\n\t\t\t);\n\t\t\tif (!relativeUrl) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//Skip some useless/redundant filters, e.g. filters that effectively show the same thing\n\t\t\t//as clicking on the menu item. I don't see a reliable way to skip all filters like that -\n\t\t\t//for example, the \"All\" filter on the \"Plugins\" page doesn't have the same URL as the\n\t\t\t//menu item, but shows the same results. But we can skip some common cases.\n\n\t\t\t//Skip the \"All\" filter on \"Posts\", \"Pages\", and other post type item lists.\n\t\t\tconst parsedUrl = new URL(url, context.pageUrl);\n\t\t\tif (context.pageUrl.pathname.endsWith('edit.php') && relativeUrl.startsWith('edit.php')) {\n\t\t\t\tconst pagePostType = context.pageUrl.searchParams.get('post_type') || 'post';\n\t\t\t\tconst filterPostType = parsedUrl.searchParams.get('post_type') || 'post';\n\t\t\t\tconst paramsExcludingPostType = parsedUrl.searchParams.size - (parsedUrl.searchParams.has('post_type') ? 1 : 0);\n\t\t\t\tif ((pagePostType === filterPostType) && (paramsExcludingPostType === 0)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\trelativeUrl = replaceUserIdWIthPlaceholder(relativeUrl, parsedUrl, context);\n\t\t\tif (!relativeUrl) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t//Skip the \"All\" filter on \"Plugins -> Installed Plugins\".\n\t\t\tif (relativeUrl === 'plugins.php?plugin_status=all') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = new DashboardItem({\n\t\t\t\tlabel: label,\n\t\t\t\ttarget: {\n\t\t\t\t\turl: relativeUrl,\n\t\t\t\t\ttype: 'filter',\n\t\t\t\t},\n\t\t\t\tlocation: context.location,\n\t\t\t\torigin: context.dashboardItemOrigin,\n\t\t\t\trelativeId: context.idRegistry.generateId({\n\t\t\t\t\tlabel,\n\t\t\t\t\turl: relativeUrl,\n\t\t\t\t\t$element: $link,\n\t\t\t\t\ttypePrefix: 'f:'\n\t\t\t\t})\n\t\t\t});\n\t\t\titems.push(item);\n\t\t\tcontext.markElementAsFound($link);\n\t\t}\n\t});\n\n\tyield* items;\n}\n\nexport const builtinScanners: ItemScanner[] = [\n\tscanClassicTabs,\n\tscanFormTableFields,\n\tscanGeneralFormControls,\n\tscanSubFilters\n];\n\n//endregion\n\ninterface IdGenerationParams {\n\tlabel: string,\n\t$element?: JQuery,\n\turl?: string,\n\tsuggestedUniqueString?: string,\n\tsection?: PotentialSection | null,\n\ttypePrefix?: string\n}\n\nconst MaxSlugLength = 50;\n\nfunction stringToSlug(str: string, disallowedCharsRegex?: RegExp): string {\n\treturn str\n\t\t.toLowerCase()\n\t\t.replace(/\\s+/g, '-')\n\t\t.replace(disallowedCharsRegex ?? /[^a-z0-9_=-]/g, '')\n\t\t.substring(0, MaxSlugLength);\n}\n\nclass ItemIdRegistry {\n\tprivate readonly idsWithoutPrefix: Set<string> = new Set<string>();\n\tprivate readonly counters: Map<string, number> = new Map<string, number>();\n\tprivate static readonly minPartialIdLength = 3;\n\n\tprivate static readonly idGenerators: Array<(params: IdGenerationParams) => string> = [\n\t\t(params) => {\n\t\t\tif (params.suggestedUniqueString) {\n\t\t\t\treturn stringToSlug(params.suggestedUniqueString);\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\t(params) => {\n\t\t\tif (params.$element && (params.$element.length > 0)) {\n\t\t\t\tconst id = params.$element.prop('id');\n\t\t\t\tif (id) {\n\t\t\t\t\treturn stringToSlug(id);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\t(params) => {\n\t\t\tif (params.url) {\n\t\t\t\treturn 'url=' + params.url;\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\t(params) => {\n\t\t\tif (\n\t\t\t\tparams.$element\n\t\t\t\t&& (params.$element.length > 0)\n\t\t\t\t&& params.$element.is('input[type=\"checkbox\"], input[type=\"radio\"]')\n\t\t\t) {\n\t\t\t\tconst name = params.$element.prop('name');\n\t\t\t\tconst value = params.$element.prop('value')\n\t\t\t\tif (name && value) {\n\t\t\t\t\treturn stringToSlug('fld-' + name + '=' + value);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\t(params) => {\n\t\t\tif (!params.label) {\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tlet labelSlug = stringToSlug(params.label);\n\t\t\t//Pad with \"=\" if too short.\n\t\t\twhile (labelSlug.length < ItemIdRegistry.minPartialIdLength) {\n\t\t\t\tlabelSlug += '=';\n\t\t\t}\n\t\t\treturn labelSlug;\n\t\t}\n\t];\n\n\tconstructor(private readonly prefix: string) {\n\t}\n\n\tgenerateId(params: IdGenerationParams): string {\n\t\tlet partialId = this.generateIdWithoutPrefix(params);\n\t\tif (!partialId) {\n\t\t\t//This should never happen. The ID generator should always have a fallback.\n\t\t\tthrow new Error('Could not generate a partial ID for the item.');\n\t\t}\n\n\t\tthis.idsWithoutPrefix.add(partialId);\n\t\treturn this.prefix + partialId;\n\t}\n\n\tprivate generateIdWithoutPrefix(params: IdGenerationParams): string {\n\t\tlet possibleNonUniqueId: string = '';\n\n\t\tfor (const generator of ItemIdRegistry.idGenerators) {\n\t\t\tlet id = generator(params);\n\t\t\tif (id.length >= ItemIdRegistry.minPartialIdLength) {\n\t\t\t\tif (params.typePrefix) {\n\t\t\t\t\tid = params.typePrefix + id;\n\t\t\t\t}\n\n\t\t\t\tif (this.isUnique(id)) {\n\t\t\t\t\treturn id;\n\t\t\t\t} else if (id && !possibleNonUniqueId) {\n\t\t\t\t\tpossibleNonUniqueId = id;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!possibleNonUniqueId) {\n\t\t\tpossibleNonUniqueId = 'item';\n\t\t}\n\n\t\t//Try adding the section and see if that makes the ID unique.\n\t\tif (params.section) {\n\t\t\tconst sectionId = stringToSlug(params.section.headerText);\n\t\t\tconst combinedId = sectionId + '/' + possibleNonUniqueId;\n\t\t\tif (this.isUnique(combinedId)) {\n\t\t\t\treturn combinedId;\n\t\t\t} else {\n\t\t\t\tpossibleNonUniqueId = combinedId;\n\t\t\t}\n\t\t}\n\n\t\t//If no unique ID was found, add a counter to the first non-unique ID.\n\t\tlet counter = this.counters.get(possibleNonUniqueId) || 0;\n\t\tcounter++;\n\t\tthis.counters.set(possibleNonUniqueId, counter);\n\t\treturn possibleNonUniqueId + '-' + counter;\n\t}\n\n\tprivate isUnique(id: string): boolean {\n\t\treturn !this.idsWithoutPrefix.has(id);\n\t}\n}\n\nexport class PageScanner {\n\tconstructor(\n\t\tprivate readonly scanners: ItemScanner[],\n\t\tprivate readonly containerSelectorBlacklist: string[] = [\n\t\t\t//Special class that lets us and other plugins disable scanning of specific parts\n\t\t\t//of a page.\n\t\t\t'.ame-quick-search-no-scan',\n\n\t\t\t//Actor selector.\n\t\t\t'#ws_actor_selector_container',\n\t\t\t//\"Add Menu Items\" area in \"Appearance -> Menus\".\n\t\t\t'#nav-menu-meta',\n\t\t\t//Various tables and their navigation controls.\n\t\t\t'table.widefat',\n\t\t\t'table.wp-list-table',\n\t\t\t'.tablenav',\n\t\t\t'#posts-filter',\n\t\t\t//Classic editor. Also matches the comment editor.\n\t\t\t'form#post',\n\t\t\t//Gutenberg editor.\n\t\t\t'#editor', '.block-editor',\n\t\t\t//Link editor.\n\t\t\t'form#addlink', 'form#editlink',\n\t\t\t//Category and tag editor.\n\t\t\t'form#addtag', 'form#edittag',\n\t\t\t//Just the entire theme editor.\n\t\t\t'body.theme-editor-php',\n\t\t\t//Site editor.\n\t\t\t'#site-editor',\n\t\t\t//\"Add User\" form. The user profile page is not blacklisted; it could be useful.\n\t\t\t'form#createuser',\n\t\t\t//Certain built-in dashboard widgets. For example, the default \"Quick Draft\" widget\n\t\t\t//is probably not needed, but a custom dashboard widget might be useful.\n\t\t\t'#dashboard_quick_press', '#dashboard_primary',\n\t\t],\n\t\tprivate readonly minItemLabelLength: number = 4\n\t) {\n\t}\n\n\t* scan(\n\t\t$container: JQuery,\n\t\tlocation: ItemLocation,\n\t\tcurrentPageUrl: string,\n\t\tadminUrl: URL,\n\t\tcurrentMenuRelativeUrl: string,\n\t\tremovableQueryArgs: string[],\n\t\tcurrentUserId: string | null,\n\t\tcustomIdPrefix?: string //For sub-containers like tabs or sections on the same page.\n\t): Generator<SearchableItem, void, undefined> {\n\t\tconst relativePageUrl = getRelativeAdminPageUrl(currentPageUrl, adminUrl);\n\t\tif (!relativePageUrl) {\n\t\t\treturn; //Skip non-admin pages.\n\t\t}\n\n\t\tconsole.log('Scanning container:', $container);\n\n\t\tconst foundElements: Set<Element> = new Set<Element>();\n\t\tconst combinedContainerBlacklist = this.containerSelectorBlacklist.join(', ');\n\t\tconst idRegistry = new ItemIdRegistry(customIdPrefix ?? '');\n\t\tconst potentialSections = this.findPotentialSections($container);\n\t\tconsole.log('Potential sections:', potentialSections);\n\n\t\tconst context: ScannerContext = {\n\t\t\t$container, location, relativePageUrl, adminUrl, removableQueryArgs, currentUserId,\n\t\t\tpageUrl: new URL(currentPageUrl, adminUrl),\n\t\t\tidRegistry,\n\t\t\tdashboardItemOrigin: Object.freeze({\n\t\t\t\tmenuUrl: currentMenuRelativeUrl,\n\t\t\t\tpageUrl: relativePageUrl\n\t\t\t}),\n\n\t\t\tisElementFound: ($element) => {\n\t\t\t\treturn foundElements.has($element.get(0));\n\t\t\t},\n\t\t\tmarkElementAsFound: ($element) => {\n\t\t\t\t$element.each((_, element) => {\n\t\t\t\t\tfoundElements.add(element);\n\t\t\t\t});\n\t\t\t},\n\t\t\tisInBlacklistedContainer: ($element: JQuery): boolean => {\n\t\t\t\tif (!combinedContainerBlacklist) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\treturn ($element.closest(combinedContainerBlacklist).length > 0);\n\t\t\t},\n\t\t\tfindParentSection: ($element: JQuery, $context?: JQuery): PotentialSection | null => {\n\t\t\t\tlet lastNonContainerSectionBeforeElement: PotentialSection | null = null;\n\n\t\t\t\tconst inputElement = $element.get(0);\n\t\t\t\tconst contextElement = $context ? $context.get(0) : $container.get(0);\n\n\t\t\t\tfor (const section of potentialSections) {\n\t\t\t\t\t//Skip sections that are outside the context element.\n\t\t\t\t\tif (!$.contains(contextElement, section.element)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (section.isContainer) {\n\t\t\t\t\t\tif ($.contains(section.element, inputElement)) {\n\t\t\t\t\t\t\treturn section;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t//A non-container section like an <h2> or <h3> heading can be\n\t\t\t\t\t\t//the \"parent\" if it's the last section before the element.\n\t\t\t\t\t\tconst compareResult = section.element.compareDocumentPosition(inputElement);\n\t\t\t\t\t\tif ((compareResult & Node.DOCUMENT_POSITION_FOLLOWING) > 0) {\n\t\t\t\t\t\t\tlastNonContainerSectionBeforeElement = section;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn lastNonContainerSectionBeforeElement;\n\t\t\t}\n\t\t};\n\n\t\tconst items: SearchableItem[] = [];\n\t\tfor (const scanner of this.scanners) {\n\t\t\tconst scannedItems = scanner(context);\n\t\t\tfor (const item of scannedItems) {\n\t\t\t\t//Skip items with very short labels.\n\t\t\t\tif ((this.minItemLabelLength > 0) && (item.label.length < this.minItemLabelLength)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\titems.push(item);\n\t\t\t}\n\t\t}\n\n\t\t//Add any sections that have items and haven't been added yet.\n\t\tfor (const section of potentialSections) {\n\t\t\tif ((section.detectedItemCount < 1) || foundElements.has(section.element)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst $sectionElement = jQuery(section.element);\n\t\t\tconst item = new DashboardItem({\n\t\t\t\tlabel: section.headerText,\n\t\t\t\ttarget: {\n\t\t\t\t\turl: relativePageUrl,\n\t\t\t\t\tselector: generateCssSelectorFor($sectionElement),\n\t\t\t\t\ttype: 'section',\n\t\t\t\t},\n\t\t\t\tlocation: location,\n\t\t\t\torigin: context.dashboardItemOrigin,\n\t\t\t\trelativeId: idRegistry.generateId({\n\t\t\t\t\tlabel: section.headerText,\n\t\t\t\t\t$element: $sectionElement,\n\t\t\t\t\ttypePrefix: 's:'\n\t\t\t\t})\n\t\t\t});\n\n\t\t\titems.push(item);\n\t\t}\n\t\tconsole.log('Scanner found ' + items.length + ' items.');\n\n\t\t//todo: Eventually, each item will need a unique ID.\n\t\tyield* items;\n\t}\n\n\tprivate findPotentialSections($container: JQuery): PotentialSection[] {\n\t\tconst sections: PotentialSection[] = [];\n\n\t\t//Find loose headings (i.e. not inside a .postbox or similar container).\n\t\tconst $headings = $container.find('h2, h3').not('.nav-tab-wrapper, .screen-reader-text');\n\t\t$headings.each((_, element) => {\n\t\t\tconst $heading = $(element);\n\t\t\t//In addition to containers, also exclude headings in temporary locations like admin notices.\n\t\t\tif ($heading.closest('.postbox, .ws-ame-postbox, .notice, .updated').length > 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!$heading.is(':visible')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst text = $heading.text().trim();\n\t\t\tif (text) {\n\t\t\t\tsections.push({\n\t\t\t\t\telement,\n\t\t\t\t\theaderText: text,\n\t\t\t\t\tisContainer: false,\n\t\t\t\t\tdetectedItemCount: 0\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t//Find .postbox and similar containers.\n\t\tconst boxSelectors = ['.postbox', '.ws-ame-postbox'];\n\t\t$container.find(boxSelectors.join(', ')).each((_, element) => {\n\t\t\tconst $postbox = $(element);\n\t\t\tif (!$postbox.is(':visible')) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst $heading = $postbox.find('h2, h3, .hndle').first();\n\t\t\tconst text = getElementTextForItemLabel($heading, ' ');\n\t\t\tif (text) {\n\t\t\t\t//Which box selector did this section match?\n\t\t\t\tlet genericContainerSelector: string | undefined;\n\t\t\t\tfor (const selector of boxSelectors) {\n\t\t\t\t\tif ($postbox.is(selector)) {\n\t\t\t\t\t\tgenericContainerSelector = selector;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tsections.push({\n\t\t\t\t\telement,\n\t\t\t\t\theaderText: text,\n\t\t\t\t\tisContainer: true,\n\t\t\t\t\tdetectedItemCount: 0,\n\t\t\t\t\tgenericContainerSelector\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn sections;\n\t}\n}\n\n//region Admin menu scanning\n\n//This is a bit different from the other scanners. The admin menu is usually parsed first, and then\n//the retrieved info is used to provide context (e.g. the current menu URL) for the other scanners.\n//Also, admin menu items are not permanently stored, just parsed on the fly when needed.\n\nexport function parseAdminMenuItems($root: JQuery, adminUrl: URL, removableQueryArgs: string[] = []): {\n\tcurrentMenuItem: AdminMenuItem | null,\n\titems: SearchableItem[],\n\titemsByRelativeUrl: { [url: string]: AdminMenuItem },\n\titemsById: { [id: string]: AdminMenuItem }\n} {\n\tfunction getMenuTitle($titleContainer: JQuery): string {\n\t\tif ($titleContainer.is('.menu-top')) {\n\t\t\tconst $name = $titleContainer.find('> .wp-menu-name').first();\n\t\t\tif ($name.length > 0) {\n\t\t\t\treturn getMenuTitle($name);\n\t\t\t}\n\t\t}\n\n\t\treturn getElementTextForItemLabel($titleContainer, '');\n\t}\n\n\tconst menuItems: AdminMenuItem[] = [];\n\tconst itemById: { [id: string]: AdminMenuItem } = {};\n\tconst itemsByRelativeUrl: { [url: string]: AdminMenuItem } = {};\n\tlet currentMenuItem: AdminMenuItem | null = null;\n\n\t$root.find('#adminmenu li > a').each((_, element) => {\n\t\tconst $link = jQuery(element);\n\t\tconst $item = $link.closest('li');\n\t\t//Skip items that are hidden via CSS. They are probably not meant to be accessed directly.\n\t\tif ($item.is(':hidden') || $link.is(':hidden')) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst url: string = $link.prop('href') || '';\n\t\tconst itemTitle = getMenuTitle($link);\n\t\tconst titleParts = [itemTitle];\n\n\t\t//Find the parent, if any, and include it in the title.\n\t\tconst $parent = $item.parent().closest('li.menu-top');\n\t\tlet relativeParentUrl: string | null = null;\n\t\tif ($parent.length > 0) {\n\t\t\tconst parentTitle = getMenuTitle($parent.find('> a .wp-menu-name').first());\n\t\t\ttitleParts.unshift(parentTitle);\n\n\t\t\tconst parentUrl = $parent.find('> a').prop('href') || '';\n\t\t\trelativeParentUrl = getRelativeAdminPageUrl(parentUrl, adminUrl, '', removableQueryArgs);\n\t\t}\n\n\t\tconst relativeMenuUrl = getRelativeAdminPageUrl(url, adminUrl, '', removableQueryArgs);\n\n\t\tconst item = new AdminMenuItem({\n\t\t\t\tlabel: titleParts.join('  '),\n\t\t\t\turl: url\n\t\t\t},\n\t\t\ttitleParts,\n\t\t\t$link,\n\t\t\trelativeMenuUrl,\n\t\t\trelativeParentUrl\n\t\t);\n\t\tmenuItems.push(item);\n\t\titemById[item.getUniqueId()] = item;\n\t\tif (relativeMenuUrl) {\n\t\t\titemsByRelativeUrl[relativeMenuUrl] = item;\n\t\t}\n\n\t\tif ($link.is('.current')) {\n\t\t\tcurrentMenuItem = item;\n\t\t}\n\t});\n\n\treturn {\n\t\tcurrentMenuItem,\n\t\titems: menuItems,\n\t\titemsByRelativeUrl: itemsByRelativeUrl,\n\t\titemsById: itemById\n\t};\n}\n\n//endregion","import * as _ from 'lodash-es';\n\nexport function getRelativeAdminPageUrl(\n\turl: string,\n\tadminUrl: URL,\n\tbaseUrl: string | URL = '',\n\tremovableQueryArgs: string[] = []\n): string | null {\n\tif (!baseUrl) {\n\t\tbaseUrl = window.location.href;\n\t}\n\n\tconst parsedUrl = new URL(url, baseUrl);\n\t//Must be a dashboard/admin page URL.\n\tif (!isAdminPageUrl(parsedUrl, adminUrl)) {\n\t\treturn null;\n\t}\n\n\t//Remove \"updated\", \"return\" and similar query parameters. They are either temporary or vary from\n\t//page to page, which means they're not useful for identifying menu items.\n\tfor (const param of removableQueryArgs) {\n\t\tparsedUrl.searchParams.delete(param);\n\t}\n\n\t//Remove the fragment, if any.\n\tparsedUrl.hash = '';\n\n\t//Get the URL relative to the admin URL.\n\tconst relativeUrl = parsedUrl.pathname + parsedUrl.search;\n\tif (relativeUrl.startsWith(adminUrl.pathname)) {\n\t\treturn relativeUrl.substring(adminUrl.pathname.length);\n\t}\n\n\treturn null;\n}\n\nexport function isAdminPageUrl(inputUrl: URL, adminUrl: URL): boolean {\n\t//Origin must match the admin URL origin.\n\tif (inputUrl.origin !== adminUrl.origin) {\n\t\treturn false;\n\t}\n\t//Path must contain \"/wp-admin/\".\n\tif (!inputUrl.pathname.includes('/wp-admin/')) {\n\t\treturn false;\n\t}\n\t//Path must start with the adminUrl path.\n\treturn inputUrl.pathname.startsWith(adminUrl.pathname);\n}\n\nexport function condenseWhitespace(text: string): string {\n\treturn text.replace(/\\s+/g, ' ').trim();\n}\n\nexport function getElementTextForItemLabel(\n\t$element: JQuery,\n\ttextPartSeparator: string = ' ',\n\tchildBlacklist: string[] = [\n\t\t'.hide-if-js', '.awaiting-mod', '.update-plugins', '.menu-counter',\n\t\t'.CodeMirror', '.CodeMirror-wrap',\n\t]\n): string {\n\tconst blacklistedSelectors = childBlacklist.join(', ');\n\n\tconst parts: string[] = [];\n\t$element.contents().each((_, node) => {\n\t\tif (node.nodeType === 3) {\n\t\t\tparts.push(node.nodeValue || '');\n\t\t} else {\n\t\t\tconst $node = jQuery(node);\n\t\t\tif ($node.is(blacklistedSelectors)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ($node.is('select')) {\n\t\t\t\t//For <select> elements, jQuery(...).text() would combine all the\n\t\t\t\t//options' text, which is not what we want. Instead, let's use either\n\t\t\t\t//the name or the selected option.\n\t\t\t\tconst name = $node.prop('name');\n\t\t\t\tif (name) {\n\t\t\t\t\tparts.push(' [' + name + '] ');\n\t\t\t\t} else {\n\t\t\t\t\tconst $selected = $node.find('option:selected');\n\t\t\t\t\tif ($selected.length > 0) {\n\t\t\t\t\t\tparts.push($selected.text());\n\t\t\t\t\t} else {\n\t\t\t\t\t\tparts.push(' [...] ');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if ($node.is('input[type=\"number\"], input[type=\"text\"]')) {\n\t\t\t\tconst name = $node.prop('name');\n\t\t\t\tif (name) {\n\t\t\t\t\tparts.push(' [' + name + '] ');\n\t\t\t\t} else {\n\t\t\t\t\tparts.push(' [...] ');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tparts.push($node.text());\n\t\t\t}\n\t\t}\n\t});\n\n\treturn condenseWhitespace(parts.join(textPartSeparator));\n}\n\ninterface JQueryTraversalStep {\n\tselector: string;\n\toperation: 'find' | 'closest';\n}\n\ntype JQueryTraversalPath = JQueryTraversalStep[];\nexport type Selector = string | JQueryTraversalPath;\n\nexport function queryAdvancedSelector(selector: Selector): JQuery {\n\tif (typeof selector === 'string') {\n\t\treturn jQuery(selector);\n\t} else {\n\t\tif (selector.length === 0) {\n\t\t\treturn jQuery();\n\t\t}\n\n\t\tlet $current = jQuery('body');\n\t\tfor (const step of selector) {\n\t\t\tswitch (step.operation) {\n\t\t\t\tcase 'find':\n\t\t\t\t\t$current = $current.find(step.selector);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'closest':\n\t\t\t\t\t$current = $current.closest(step.selector);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif ($current.length === 0) {\n\t\t\t\treturn jQuery();\n\t\t\t}\n\t\t}\n\n\t\treturn $current;\n\t}\n}\n\nexport class KoObservableSet<T> implements Iterable<T> {\n\tprivate readonly _set: Set<T> = new Set();\n\tprivate readonly _observable: KnockoutObservableArray<T>;\n\n\tconstructor() {\n\t\tthis._observable = ko.observableArray(Array.from(this._set));\n\t}\n\n\t[Symbol.iterator](): Iterator<T, void> {\n\t\t//Touch the observable to create a dependency when the iterator\n\t\t//is used from Knockout bindings and computed observables.\n\t\tthis._observable();\n\t\treturn this._set.values();\n\t}\n\n\tadd(value: T): void {\n\t\tif (!this._set.has(value)) {\n\t\t\tthis._set.add(value);\n\t\t\tthis._observable.push(value);\n\t\t}\n\t}\n\n\tdelete(value: T): void {\n\t\tif (this._set.has(value)) {\n\t\t\tthis._set.delete(value);\n\t\t\tthis._observable.remove(value);\n\t\t}\n\t}\n\n\titems(): KnockoutObservableArray<T> {\n\t\treturn this._observable;\n\t}\n\n\tget size(): number {\n\t\t//We use the observable array instead of the underlying set so KO can track changes.\n\t\t//For example, this way a computed observable that depends on the size of the set will\n\t\t//be re-evaluated when an item is added or removed.\n\t\treturn this._observable().length;\n\t}\n\n\tshift(): T | undefined {\n\t\tconst value = this._observable.shift();\n\t\tif (value) {\n\t\t\tthis._set.delete(value);\n\t\t}\n\t\treturn value;\n\t}\n}\n\nclass ListNode<K, V> {\n\tkey: K;\n\tvalue: V;\n\tprev: ListNode<K, V> | null = null;\n\tnext: ListNode<K, V> | null = null;\n\n\tconstructor(key: K, value: V) {\n\t\tthis.key = key;\n\t\tthis.value = value;\n\t}\n}\n\nexport class LRUCache<K, V> {\n\tprivate readonly capacity: number;\n\tprivate cache: Map<K, ListNode<K, V>>;\n\tprivate head: ListNode<K, V> | null = null;\n\tprivate tail: ListNode<K, V> | null = null;\n\n\tconstructor(capacity: number) {\n\t\tthis.capacity = capacity;\n\t\tthis.cache = new Map<K, ListNode<K, V>>();\n\t}\n\n\tget(key: K): V | undefined {\n\t\tconst node = this.cache.get(key);\n\t\tif (!node) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Move accessed node to the head (most recently used)\n\t\tthis.removeNode(node);\n\t\tthis.addToHead(node);\n\n\t\treturn node.value;\n\t}\n\n\tput(key: K, value: V): void {\n\t\tif (this.cache.has(key)) {\n\t\t\t// Update existing node\n\t\t\tconst node = this.cache.get(key)!;\n\t\t\tnode.value = value;\n\t\t\tthis.removeNode(node);\n\t\t\tthis.addToHead(node);\n\t\t} else {\n\t\t\t// Add new node\n\t\t\tconst newNode = new ListNode(key, value);\n\t\t\tif (this.cache.size >= this.capacity) {\n\t\t\t\t// Remove least recently used item (tail)\n\t\t\t\tif (this.tail) {\n\t\t\t\t\tthis.cache.delete(this.tail.key);\n\t\t\t\t\tthis.removeNode(this.tail);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.addToHead(newNode);\n\t\t\tthis.cache.set(key, newNode);\n\t\t}\n\t}\n\n\t/**\n\t * Check if the cache contains the given key.\n\t *\n\t * Unlike get(), this method does not update the order of the cache.\n\t *\n\t * @param key\n\t */\n\thas(key: K): boolean {\n\t\treturn this.cache.has(key);\n\t}\n\n\tprivate removeNode(node: ListNode<K, V>): void {\n\t\tif (node.prev) {\n\t\t\tnode.prev.next = node.next;\n\t\t}\n\t\tif (node.next) {\n\t\t\tnode.next.prev = node.prev;\n\t\t}\n\t\tif (node === this.head) {\n\t\t\tthis.head = node.next;\n\t\t}\n\t\tif (node === this.tail) {\n\t\t\tthis.tail = node.prev;\n\t\t}\n\t}\n\n\tprivate addToHead(node: ListNode<K, V>): void {\n\t\tnode.next = this.head;\n\t\tnode.prev = null;\n\t\tif (this.head) {\n\t\t\tthis.head.prev = node;\n\t\t}\n\t\tthis.head = node;\n\t\tif (!this.tail) {\n\t\t\tthis.tail = node;\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this.cache.size;\n\t}\n\n\tforEach(callback: (value: V, key: K) => void): void {\n\t\tthis.cache.forEach((node, key) => {\n\t\t\tcallback(node.value, key);\n\t\t});\n\t}\n\n\tisFull(): boolean {\n\t\treturn this.cache.size >= this.capacity;\n\t}\n}\n\nconst UninitializedLazyValue = Symbol('UninitializedLazyValue');\n\nexport function lazy<T>(factory: () => T): () => T {\n\tlet value: T | typeof UninitializedLazyValue = UninitializedLazyValue;\n\treturn () => {\n\t\tif (value === UninitializedLazyValue) {\n\t\t\tvalue = factory();\n\t\t}\n\t\treturn value;\n\t};\n}\n\nexport type PromiseQueueItem<T> = {\n\tresolve: (value: T) => void;\n\treject: (reason: Error) => void;\n};\n\nexport function throttleBatchProcessor<T, R>(\n\thandler: (\n\t\tinputs: Set<T>,\n\t\tpromiseFunctions: PromiseQueueItem<R>[]\n\t) => void,\n\twaitTime: number\n): (input: T) => Promise<R> {\n\tconst queue: Set<T> = new Set();\n\tconst promiseFunctions: PromiseQueueItem<R>[] = [];\n\n\tconst throttledHandler = _.throttle(() => {\n\t\tconst inputs = new Set(queue);\n\t\tconst functions = [...promiseFunctions];\n\t\tqueue.clear();\n\t\tpromiseFunctions.length = 0;\n\n\t\thandler(inputs, functions);\n\t}, waitTime, {leading: true, trailing: true});\n\n\treturn (input: T): Promise<R> => {\n\t\treturn new Promise<R>((resolve, reject) => {\n\t\t\tqueue.add(input);\n\t\t\tpromiseFunctions.push({resolve, reject});\n\t\t\tthrottledHandler();\n\t\t});\n\t}\n}\n\nexport function escapeRegExp(string: string) {\n\treturn string.replace(/[.*+?^${}()|[\\]\\\\]/g, \"\\\\$&\"); // $& means the whole matched string\n}","import { CSS_SELECTOR_TYPE } from \"./types.js\";\nexport const SELECTOR_SEPARATOR = \", \";\n// RegExp that will match invalid patterns that can be used in ID attribute.\nexport const INVALID_ID_RE = new RegExp([\n    \"^$\", // empty or not set\n    \"\\\\s\", // contains whitespace\n].join(\"|\"));\n// RegExp that will match invalid patterns that can be used in class attribute.\nexport const INVALID_CLASS_RE = new RegExp([\n    \"^$\", // empty or not set\n].join(\"|\"));\n// Order in which a combined selector is constructed.\nexport const SELECTOR_PATTERN = [\n    CSS_SELECTOR_TYPE.nthoftype,\n    CSS_SELECTOR_TYPE.tag,\n    CSS_SELECTOR_TYPE.id,\n    CSS_SELECTOR_TYPE.class,\n    CSS_SELECTOR_TYPE.attribute,\n    CSS_SELECTOR_TYPE.nthchild,\n];\n//# sourceMappingURL=constants.js.map","import { getFallbackSelector } from \"./selector-fallback.js\";\nimport { sanitizeOptions } from \"./utilities-options.js\";\nimport { getClosestIdentifiableParent, sanitizeSelectorNeedle, } from \"./utilities-selectors.js\";\nimport { testSelector } from \"./utilities-dom.js\";\nimport { SELECTOR_SEPARATOR } from \"./constants.js\";\n/**\n * Generates unique CSS selector for an element.\n */\nexport function getCssSelector(needle, custom_options = {}) {\n    const elements = sanitizeSelectorNeedle(needle);\n    const options = sanitizeOptions(elements[0], custom_options);\n    let partialSelector = \"\";\n    let currentRoot = options.root;\n    /**\n     * Utility function to make subsequent calls shorter.\n     */\n    function updateIdentifiableParent() {\n        return getClosestIdentifiableParent(elements, currentRoot, partialSelector, options);\n    }\n    let closestIdentifiableParent = updateIdentifiableParent();\n    while (closestIdentifiableParent) {\n        const { foundElements, selector } = closestIdentifiableParent;\n        if (testSelector(elements, selector, options.root)) {\n            return selector;\n        }\n        currentRoot = foundElements[0];\n        partialSelector = selector;\n        closestIdentifiableParent = updateIdentifiableParent();\n    }\n    // if failed to find single selector matching all elements, try to find\n    // selector for each standalone element and join them together\n    if (elements.length > 1) {\n        return elements\n            .map((element) => getCssSelector(element, options))\n            .join(SELECTOR_SEPARATOR);\n    }\n    return getFallbackSelector(elements);\n}\nexport default getCssSelector;\n//# sourceMappingURL=index.js.map","import { sanitizeSelectorItem } from \"./utilities-selectors.js\";\nimport { createPatternMatcher, getIntersection } from \"./utilities-data.js\";\n// List of attributes to be ignored. These are handled by different selector types.\nexport const attributeBlacklistMatch = createPatternMatcher([\n    \"class\",\n    \"id\",\n    // Angular attributes\n    \"ng-*\",\n]);\n/**\n * Get simplified attribute selector for an element.\n */\nexport function attributeNodeToSimplifiedSelector({ name, }) {\n    return `[${name}]`;\n}\n/**\n * Get attribute selector for an element.\n */\nexport function attributeNodeToSelector({ name, value, }) {\n    return `[${name}='${value}']`;\n}\n/**\n * Checks whether attribute should be used as a selector.\n */\nexport function isValidAttributeNode({ nodeName }, element) {\n    // form input value should not be used as a selector\n    const tagName = element.tagName.toLowerCase();\n    if ([\"input\", \"option\"].includes(tagName) && nodeName === \"value\") {\n        return false;\n    }\n    return !attributeBlacklistMatch(nodeName);\n}\n/**\n * Sanitize all attribute data. We want to do it once, before we start to generate simplified/full selectors from the same data.\n */\nfunction sanitizeAttributeData({ nodeName, nodeValue }) {\n    return {\n        name: sanitizeSelectorItem(nodeName),\n        value: sanitizeSelectorItem(nodeValue),\n    };\n}\n/**\n * Get attribute selectors for an element.\n */\nexport function getElementAttributeSelectors(element) {\n    const validAttributes = Array.from(element.attributes)\n        .filter((attributeNode) => isValidAttributeNode(attributeNode, element))\n        .map(sanitizeAttributeData);\n    return [\n        ...validAttributes.map(attributeNodeToSimplifiedSelector),\n        ...validAttributes.map(attributeNodeToSelector),\n    ];\n}\n/**\n * Get attribute selectors matching all elements.\n */\nexport function getAttributeSelectors(elements) {\n    const elementSelectors = elements.map(getElementAttributeSelectors);\n    return getIntersection(elementSelectors);\n}\n//# sourceMappingURL=selector-attribute.js.map","import { sanitizeSelectorItem } from \"./utilities-selectors.js\";\nimport { INVALID_CLASS_RE } from \"./constants.js\";\nimport { getIntersection } from \"./utilities-data.js\";\n/**\n * Get class selectors for an element.\n */\nexport function getElementClassSelectors(element) {\n    return (element.getAttribute(\"class\") || \"\")\n        .trim()\n        .split(/\\s+/)\n        .filter((item) => !INVALID_CLASS_RE.test(item))\n        .map((item) => `.${sanitizeSelectorItem(item)}`);\n}\n/**\n * Get class selectors matching all elements.\n */\nexport function getClassSelectors(elements) {\n    const elementSelectors = elements.map(getElementClassSelectors);\n    return getIntersection(elementSelectors);\n}\n//# sourceMappingURL=selector-class.js.map","import { getElementParents } from \"./utilities-dom.js\";\nimport { SELECTOR_SEPARATOR } from \"./constants.js\";\nimport { CSS_SELECTOR_TYPE, OPERATOR, } from \"./types.js\";\nimport { constructElementSelector, createElementData, } from \"./utilities-element-data.js\";\n/**\n * Creates fallback selector for single element.\n */\nexport function getElementFallbackSelector(element) {\n    const parentElements = getElementParents(element).reverse();\n    const elementsData = parentElements.map((element) => {\n        const elementData = createElementData(element, [CSS_SELECTOR_TYPE.nthchild], OPERATOR.CHILD);\n        elementData.selectors.nthchild.forEach((selectorData) => {\n            selectorData.include = true;\n        });\n        return elementData;\n    });\n    return [\":root\", ...elementsData.map(constructElementSelector)].join(\"\");\n}\n/**\n * Creates chain of :nth-child selectors from root to the elements.\n */\nexport function getFallbackSelector(elements) {\n    return elements.map(getElementFallbackSelector).join(SELECTOR_SEPARATOR);\n}\n//# sourceMappingURL=selector-fallback.js.map","import { sanitizeSelectorItem } from \"./utilities-selectors.js\";\nimport { INVALID_ID_RE } from \"./constants.js\";\nimport { testSelector } from \"./utilities-dom.js\";\n/**\n * Get ID selector for an element.\n * */\nexport function getElementIdSelectors(element) {\n    const id = element.getAttribute(\"id\") || \"\";\n    const selector = `#${sanitizeSelectorItem(id)}`;\n    const rootNode = element.getRootNode({ composed: false });\n    return !INVALID_ID_RE.test(id) && testSelector([element], selector, rootNode)\n        ? [selector]\n        : [];\n}\n/**\n * Get ID selector for an element.\n */\nexport function getIdSelector(elements) {\n    return elements.length === 0 || elements.length > 1\n        ? []\n        : getElementIdSelectors(elements[0]);\n}\n//# sourceMappingURL=selector-id.js.map","import { isElement } from \"./utilities-iselement.js\";\nimport { getIntersection } from \"./utilities-data.js\";\n/**\n * Get nth-child selector for an element.\n */\nexport function getElementNthChildSelector(element) {\n    const parent = element.parentNode;\n    if (parent) {\n        const siblings = Array.from(parent.childNodes).filter(isElement);\n        const elementIndex = siblings.indexOf(element);\n        if (elementIndex > -1) {\n            return [`:nth-child(${elementIndex + 1})`];\n        }\n    }\n    return [];\n}\n/**\n * Get nth-child selector matching all elements.\n */\nexport function getNthChildSelector(elements) {\n    return getIntersection(elements.map(getElementNthChildSelector));\n}\n//# sourceMappingURL=selector-nth-child.js.map","import { getTagSelector } from \"./selector-tag.js\";\nimport { getIntersection } from \"./utilities-data.js\";\n/**\n * Get nth-of-type selector for an element.\n */\nexport function getElementNthOfTypeSelector(element) {\n    const tag = getTagSelector([element])[0];\n    const parentElement = element.parentElement;\n    if (parentElement) {\n        const siblings = Array.from(parentElement.children).filter((element) => element.tagName.toLowerCase() === tag);\n        const elementIndex = siblings.indexOf(element);\n        if (elementIndex > -1) {\n            return [\n                `${tag}:nth-of-type(${elementIndex + 1})`,\n            ];\n        }\n    }\n    return [];\n}\n/**\n * Get Nth-of-type selector matching all elements.\n */\nexport function getNthOfTypeSelector(elements) {\n    return getIntersection(elements.map(getElementNthOfTypeSelector));\n}\n//# sourceMappingURL=selector-nth-of-type.js.map","import { sanitizeSelectorItem } from \"./utilities-selectors.js\";\nimport { flattenArray } from \"./utilities-data.js\";\n/**\n * Get tag selector for an element.\n */\nexport function getElementTagSelectors(element) {\n    return [\n        sanitizeSelectorItem(element.tagName.toLowerCase()),\n    ];\n}\n/**\n * Get tag selector for list of elements.\n */\nexport function getTagSelector(elements) {\n    const selectors = [\n        ...new Set(flattenArray(elements.map(getElementTagSelectors))),\n    ];\n    return selectors.length === 0 || selectors.length > 1 ? [] : [selectors[0]];\n}\n//# sourceMappingURL=selector-tag.js.map","export const OPERATOR = {\n    NONE: \"\",\n    DESCENDANT: \" \",\n    CHILD: \" > \",\n};\nexport const CSS_SELECTOR_TYPE = {\n    id: \"id\",\n    class: \"class\",\n    tag: \"tag\",\n    attribute: \"attribute\",\n    nthchild: \"nthchild\",\n    nthoftype: \"nthoftype\",\n};\n//# sourceMappingURL=types.js.map","/**\n * Generates cartesian product out of input object.\n */\nexport function getCartesianProduct(input = {}) {\n    let result = [];\n    Object.entries(input).forEach(([key, values]) => {\n        result = values.flatMap((value) => {\n            if (result.length === 0) {\n                return [{ [key]: value }];\n            }\n            else {\n                return result.map((memo) => (Object.assign(Object.assign({}, memo), { [key]: value })));\n            }\n        });\n    });\n    return result;\n}\n//# sourceMappingURL=utilities-cartesian.js.map","import { isRegExp } from \"./utilities-options.js\";\nimport { showWarning } from \"./utilities-messages.js\";\n/**\n * Creates array containing only items included in all input arrays.\n */\nexport function getIntersection(items = []) {\n    const [firstItem = [], ...otherItems] = items;\n    if (otherItems.length === 0) {\n        return firstItem;\n    }\n    return otherItems.reduce((accumulator, currentValue) => {\n        return accumulator.filter((item) => currentValue.includes(item));\n    }, firstItem);\n}\n/**\n * Converts array of arrays into a flat array.\n */\nexport function flattenArray(input) {\n    return [].concat(...input);\n}\n/**\n * Convert string that can contain wildcards (asterisks) to RegExp source.\n */\nexport function wildcardToRegExp(input) {\n    return (input\n        // convert all special characters used by RegExp, except an asterisk\n        .replace(/[|\\\\{}()[\\]^$+?.]/g, \"\\\\$&\")\n        // convert asterisk to pattern that matches anything\n        .replace(/\\*/g, \".+\"));\n}\n/**\n * Creates function that will test list of provided matchers against input.\n * Used for white/blacklist functionality.\n */\nexport function createPatternMatcher(list) {\n    const matchFunctions = list.map((item) => {\n        if (isRegExp(item)) {\n            return (input) => item.test(input);\n        }\n        if (typeof item === \"function\") {\n            return (input) => {\n                const result = item(input);\n                if (typeof result !== \"boolean\") {\n                    // eslint-disable-next-line max-len\n                    showWarning(\"pattern matcher function invalid\", \"Provided pattern matching function does not return boolean. It's result will be ignored.\", item);\n                    return false;\n                }\n                return result;\n            };\n        }\n        if (typeof item === \"string\") {\n            const re = new RegExp(\"^\" + wildcardToRegExp(item) + \"$\");\n            return (input) => re.test(input);\n        }\n        // eslint-disable-next-line max-len\n        showWarning(\"pattern matcher invalid\", \"Pattern matching only accepts strings, regular expressions and/or functions. This item is invalid and will be ignored.\", item);\n        return () => false;\n    });\n    return (input) => matchFunctions.some((matchFunction) => matchFunction(input));\n}\n//# sourceMappingURL=utilities-data.js.map","import { isElement } from \"./utilities-iselement.js\";\nimport { getIntersection } from \"./utilities-data.js\";\nimport { sanitizeRoot } from \"./utilities-options.js\";\n/**\n * Check whether element is matched uniquely by selector.\n */\nexport function testSelector(elements, selector, root) {\n    const result = Array.from(sanitizeRoot(root, elements[0]).querySelectorAll(selector));\n    return (result.length === elements.length &&\n        elements.every((element) => result.includes(element)));\n}\n/**\n * Test whether selector targets element. It does not have to be a unique match.\n */\nexport function testMultiSelector(element, selector, root) {\n    const result = Array.from(sanitizeRoot(root, element).querySelectorAll(selector));\n    return result.includes(element);\n}\n/**\n * Find all parents of a single element.\n */\nexport function getElementParents(element, root) {\n    root = root !== null && root !== void 0 ? root : getRootNode(element);\n    const result = [];\n    let parent = element;\n    while (isElement(parent) && parent !== root) {\n        result.push(parent);\n        parent = parent.parentElement;\n    }\n    return result;\n}\n/**\n * Find all common parents of elements.\n */\nexport function getParents(elements, root) {\n    return getIntersection(elements.map((element) => getElementParents(element, root)));\n}\n/**\n * Returns root node for given element. This needs to be used because of document-less environments, e.g. jsdom.\n */\nexport function getRootNode(element) {\n    return element.ownerDocument.querySelector(\":root\");\n}\n//# sourceMappingURL=utilities-dom.js.map","import { CSS_SELECTOR_TYPE, OPERATOR, } from \"./types.js\";\nimport { SELECTOR_PATTERN } from \"./constants.js\";\nimport { getElementSelectorsByType } from \"./utilities-selectors.js\";\n/**\n * Creates data describing a specific selector.\n */\nexport function createElementSelectorData(selector) {\n    return {\n        value: selector,\n        include: false,\n    };\n}\n/**\n * Creates data describing an element within CssSelector chain.\n */\nexport function createElementData(element, selectorTypes, operator = OPERATOR.NONE) {\n    const selectors = {};\n    selectorTypes.forEach((selectorType) => {\n        Reflect.set(selectors, selectorType, getElementSelectorsByType(element, selectorType).map(createElementSelectorData));\n    });\n    return {\n        element,\n        operator,\n        selectors,\n    };\n}\n/**\n * Constructs selector from element data.\n */\nexport function constructElementSelector({ selectors, operator, }) {\n    let pattern = [...SELECTOR_PATTERN];\n    // `nthoftype` already contains tag\n    if (selectors[CSS_SELECTOR_TYPE.tag] &&\n        selectors[CSS_SELECTOR_TYPE.nthoftype]) {\n        pattern = pattern.filter((item) => item !== CSS_SELECTOR_TYPE.tag);\n    }\n    let selector = \"\";\n    pattern.forEach((selectorType) => {\n        const selectorsOfType = selectors[selectorType] || [];\n        selectorsOfType.forEach(({ value, include }) => {\n            if (include) {\n                selector += value;\n            }\n        });\n    });\n    return (operator + selector);\n}\n//# sourceMappingURL=utilities-element-data.js.map","/**\n * Guard function that checks if provided `input` is an Element.\n */\nexport function isElement(input) {\n    return (typeof input === \"object\" &&\n        input !== null &&\n        input.nodeType === Node.ELEMENT_NODE);\n}\n//# sourceMappingURL=utilities-iselement.js.map","const libraryName = \"CssSelectorGenerator\";\n/**\n * Convenient wrapper for `console.warn` using consistent formatting.\n */\nexport function showWarning(id = \"unknown problem\", ...args) {\n    // eslint-disable-next-line no-console\n    console.warn(`${libraryName}: ${id}`, ...args);\n}\n//# sourceMappingURL=utilities-messages.js.map","import { CSS_SELECTOR_TYPE, } from \"./types.js\";\nimport { isEnumValue } from \"./utilities-typescript.js\";\nimport { showWarning } from \"./utilities-messages.js\";\nexport const DEFAULT_OPTIONS = {\n    selectors: [\n        CSS_SELECTOR_TYPE.id,\n        CSS_SELECTOR_TYPE.class,\n        CSS_SELECTOR_TYPE.tag,\n        CSS_SELECTOR_TYPE.attribute,\n    ],\n    // if set to true, always include tag name\n    includeTag: false,\n    whitelist: [],\n    blacklist: [],\n    combineWithinSelector: true,\n    combineBetweenSelectors: true,\n    root: null,\n    maxCombinations: Number.POSITIVE_INFINITY,\n    maxCandidates: Number.POSITIVE_INFINITY,\n};\n/**\n * Makes sure returned value is a list containing only valid selector types.\n * @param input\n */\nexport function sanitizeSelectorTypes(input) {\n    if (!Array.isArray(input)) {\n        return [];\n    }\n    return input.filter((item) => isEnumValue(CSS_SELECTOR_TYPE, item));\n}\n/**\n * Checks whether provided value is of type RegExp.\n */\nexport function isRegExp(input) {\n    return input instanceof RegExp;\n}\n/**\n * Checks whether provided value is usable in whitelist or blacklist.\n * @param input\n */\nexport function isCssSelectorMatch(input) {\n    return [\"string\", \"function\"].includes(typeof input) || isRegExp(input);\n}\n/**\n * Converts input to a list of valid values for whitelist or blacklist.\n */\nexport function sanitizeCssSelectorMatchList(input) {\n    if (!Array.isArray(input)) {\n        return [];\n    }\n    return input.filter(isCssSelectorMatch);\n}\n/**\n * Checks whether provided value is valid Node.\n */\nexport function isNode(input) {\n    return input instanceof Node;\n}\n/**\n * Checks whether provided value is valid ParentNode.\n */\nexport function isParentNode(input) {\n    const validParentNodeTypes = [\n        Node.DOCUMENT_NODE,\n        Node.DOCUMENT_FRAGMENT_NODE, // this includes Shadow DOM root\n        Node.ELEMENT_NODE,\n    ];\n    return isNode(input) && validParentNodeTypes.includes(input.nodeType);\n}\n/**\n * Makes sure that the root node in options is valid.\n */\nexport function sanitizeRoot(input, element) {\n    if (isParentNode(input)) {\n        if (!input.contains(element)) {\n            // eslint-disable-next-line max-len\n            showWarning(\"element root mismatch\", \"Provided root does not contain the element. This will most likely result in producing a fallback selector using element's real root node. If you plan to use the selector using provided root (e.g. `root.querySelector`), it will nto work as intended.\");\n        }\n        return input;\n    }\n    const rootNode = element.getRootNode({ composed: false });\n    if (isParentNode(rootNode)) {\n        if (rootNode !== document) {\n            // eslint-disable-next-line max-len\n            showWarning(\"shadow root inferred\", \"You did not provide a root and the element is a child of Shadow DOM. This will produce a selector using ShadowRoot as a root. If you plan to use the selector using document as a root (e.g. `document.querySelector`), it will not work as intended.\");\n        }\n        return rootNode;\n    }\n    return element.ownerDocument.querySelector(\":root\");\n}\n/**\n * Makes sure that the output is a number, usable as `maxResults` option in\n * powerset generator.\n */\nexport function sanitizeMaxNumber(input) {\n    return typeof input === \"number\" ? input : Number.POSITIVE_INFINITY;\n}\n/**\n * Makes sure the options object contains all required keys.\n */\nexport function sanitizeOptions(element, custom_options = {}) {\n    const options = Object.assign(Object.assign({}, DEFAULT_OPTIONS), custom_options);\n    return {\n        selectors: sanitizeSelectorTypes(options.selectors),\n        whitelist: sanitizeCssSelectorMatchList(options.whitelist),\n        blacklist: sanitizeCssSelectorMatchList(options.blacklist),\n        root: sanitizeRoot(options.root, element),\n        combineWithinSelector: !!options.combineWithinSelector,\n        combineBetweenSelectors: !!options.combineBetweenSelectors,\n        includeTag: !!options.includeTag,\n        maxCombinations: sanitizeMaxNumber(options.maxCombinations),\n        maxCandidates: sanitizeMaxNumber(options.maxCandidates),\n    };\n}\n//# sourceMappingURL=utilities-options.js.map","export function* powerSetGenerator(input = [], { maxResults = Number.POSITIVE_INFINITY } = {}) {\n    let resultCounter = 0;\n    let offsets = generateOffsets(1);\n    while (offsets.length <= input.length && resultCounter < maxResults) {\n        resultCounter += 1;\n        const result = offsets.map((offset) => input[offset]);\n        yield result;\n        offsets = bumpOffsets(offsets, input.length - 1);\n    }\n}\n/**\n * Generates power set of input items.\n */\nexport function getPowerSet(input = [], { maxResults = Number.POSITIVE_INFINITY } = {}) {\n    return Array.from(powerSetGenerator(input, { maxResults }));\n}\n/**\n * Helper function used by `getPowerSet`. Updates internal pointers.\n */\nfunction bumpOffsets(offsets = [], maxValue = 0) {\n    const size = offsets.length;\n    if (size === 0) {\n        return [];\n    }\n    const result = [...offsets];\n    result[size - 1] += 1;\n    for (let index = size - 1; index >= 0; index--) {\n        if (result[index] > maxValue) {\n            if (index === 0) {\n                return generateOffsets(size + 1);\n            }\n            else {\n                result[index - 1]++;\n                result[index] = result[index - 1] + 1;\n            }\n        }\n    }\n    if (result[size - 1] > maxValue) {\n        return generateOffsets(size + 1);\n    }\n    return result;\n}\n/**\n * Generates array of size N, filled with numbers sequence starting from 0.\n */\nfunction generateOffsets(size = 1) {\n    return Array.from(Array(size).keys());\n}\n//# sourceMappingURL=utilities-powerset.js.map","import { SELECTOR_PATTERN } from \"./constants.js\";\nimport { getAttributeSelectors, getElementAttributeSelectors, } from \"./selector-attribute.js\";\nimport { getClassSelectors, getElementClassSelectors, } from \"./selector-class.js\";\nimport { getElementIdSelectors, getIdSelector } from \"./selector-id.js\";\nimport { getElementNthChildSelector, getNthChildSelector, } from \"./selector-nth-child.js\";\nimport { getElementNthOfTypeSelector, getNthOfTypeSelector, } from \"./selector-nth-of-type.js\";\nimport { getElementTagSelectors, getTagSelector } from \"./selector-tag.js\";\nimport { createPatternMatcher, flattenArray } from \"./utilities-data.js\";\nimport { getParents, testSelector } from \"./utilities-dom.js\";\nimport { CSS_SELECTOR_TYPE, OPERATOR, } from \"./types.js\";\nimport { isElement } from \"./utilities-iselement.js\";\nimport { getPowerSet } from \"./utilities-powerset.js\";\nimport { getCartesianProduct } from \"./utilities-cartesian.js\";\nexport const ESCAPED_COLON = \":\".charCodeAt(0).toString(16).toUpperCase();\n// Square brackets need to be escaped, but eslint has a problem with that.\n/* eslint-disable-next-line no-useless-escape */\nexport const SPECIAL_CHARACTERS_RE = /[ !\"#$%&'()\\[\\]{|}<>*+,./;=?@^`~\\\\]/;\n/**\n * Escapes special characters used by CSS selector items.\n */\nexport function sanitizeSelectorItem(input = \"\") {\n    var _a, _b;\n    return (_b = (_a = CSS === null || CSS === void 0 ? void 0 : CSS.escape) === null || _a === void 0 ? void 0 : _a.call(CSS, input)) !== null && _b !== void 0 ? _b : legacySanitizeSelectorItem(input);\n}\n/**\n * Legacy version of escaping utility, originally used for IE11-. Should\n * probably be replaced by a polyfill:\n * https://github.com/mathiasbynens/CSS.escape\n */\nexport function legacySanitizeSelectorItem(input = \"\") {\n    return input\n        .split(\"\")\n        .map((character) => {\n        if (character === \":\") {\n            return `\\\\${ESCAPED_COLON} `;\n        }\n        if (SPECIAL_CHARACTERS_RE.test(character)) {\n            return `\\\\${character}`;\n        }\n        return escape(character).replace(/%/g, \"\\\\\");\n    })\n        .join(\"\");\n}\nexport const SELECTOR_TYPE_GETTERS = {\n    tag: getTagSelector,\n    id: getIdSelector,\n    class: getClassSelectors,\n    attribute: getAttributeSelectors,\n    nthchild: getNthChildSelector,\n    nthoftype: getNthOfTypeSelector,\n};\nexport const ELEMENT_SELECTOR_TYPE_GETTERS = {\n    tag: getElementTagSelectors,\n    id: getElementIdSelectors,\n    class: getElementClassSelectors,\n    attribute: getElementAttributeSelectors,\n    nthchild: getElementNthChildSelector,\n    nthoftype: getElementNthOfTypeSelector,\n};\n/**\n * Creates selector of given type for single element.\n */\nexport function getElementSelectorsByType(element, selectorType) {\n    return ELEMENT_SELECTOR_TYPE_GETTERS[selectorType](element);\n}\n/**\n * Returns list of selectors of given type for the element.\n */\nexport function getSelectorsByType(elements, selector_type) {\n    var _a;\n    const getter = (_a = SELECTOR_TYPE_GETTERS[selector_type]) !== null && _a !== void 0 ? _a : (() => []);\n    return getter(elements);\n}\n/**\n * Remove blacklisted selectors from list.\n */\nexport function filterSelectors(list = [], matchBlacklist, matchWhitelist) {\n    return list.filter((item) => matchWhitelist(item) || !matchBlacklist(item));\n}\n/**\n * Prioritise whitelisted selectors in list.\n */\nexport function orderSelectors(list = [], matchWhitelist) {\n    return list.sort((a, b) => {\n        const a_is_whitelisted = matchWhitelist(a);\n        const b_is_whitelisted = matchWhitelist(b);\n        if (a_is_whitelisted && !b_is_whitelisted) {\n            return -1;\n        }\n        if (!a_is_whitelisted && b_is_whitelisted) {\n            return 1;\n        }\n        return 0;\n    });\n}\n/**\n * Returns list of unique selectors applicable to given element.\n */\nexport function getAllSelectors(elements, root, options) {\n    const selectors_list = getSelectorsList(elements, options);\n    const type_combinations = getTypeCombinations(selectors_list, options);\n    const all_selectors = flattenArray(type_combinations);\n    return [...new Set(all_selectors)];\n}\n/**\n * Creates object containing all selector types and their potential values.\n */\nexport function getSelectorsList(elements, options) {\n    const { blacklist, whitelist, combineWithinSelector, maxCombinations } = options;\n    const matchBlacklist = createPatternMatcher(blacklist);\n    const matchWhitelist = createPatternMatcher(whitelist);\n    const reducer = (data, selector_type) => {\n        const selectors_by_type = getSelectorsByType(elements, selector_type);\n        const filtered_selectors = filterSelectors(selectors_by_type, matchBlacklist, matchWhitelist);\n        const found_selectors = orderSelectors(filtered_selectors, matchWhitelist);\n        data[selector_type] = combineWithinSelector\n            ? getPowerSet(found_selectors, { maxResults: maxCombinations })\n            : found_selectors.map((item) => [item]);\n        return data;\n    };\n    return getSelectorsToGet(options).reduce(reducer, {});\n}\n/**\n * Creates list of selector types that we will need to generate the selector.\n */\nexport function getSelectorsToGet(options) {\n    const { selectors, includeTag } = options;\n    const selectors_to_get = [].concat(selectors);\n    if (includeTag && !selectors_to_get.includes(\"tag\")) {\n        selectors_to_get.push(\"tag\");\n    }\n    return selectors_to_get;\n}\n/**\n * Adds \"tag\" to a list, if it does not contain it. Used to modify selectors\n * list when includeTag option is enabled to make sure all results contain the\n * TAG part.\n */\nfunction addTagTypeIfNeeded(list) {\n    return list.includes(CSS_SELECTOR_TYPE.tag) ||\n        list.includes(CSS_SELECTOR_TYPE.nthoftype)\n        ? [...list]\n        : [...list, CSS_SELECTOR_TYPE.tag];\n}\n/**\n * Generates list of possible selector type combinations.\n */\nexport function combineSelectorTypes(options) {\n    const { selectors, combineBetweenSelectors, includeTag, maxCandidates } = options;\n    const combinations = combineBetweenSelectors\n        ? getPowerSet(selectors, { maxResults: maxCandidates })\n        : selectors.map((item) => [item]);\n    return includeTag ? combinations.map(addTagTypeIfNeeded) : combinations;\n}\n/**\n * Generates list of combined CSS selectors.\n */\nexport function getTypeCombinations(selectors_list, options) {\n    return combineSelectorTypes(options)\n        .map((item) => {\n        return constructSelectors(item, selectors_list);\n    })\n        .filter((item) => item.length > 0);\n}\n/**\n * Generates all variations of possible selectors from provided data.\n */\nexport function constructSelectors(selector_types, selectors_by_type) {\n    const data = {};\n    selector_types.forEach((selector_type) => {\n        const selector_variants = selectors_by_type[selector_type];\n        if (selector_variants.length > 0) {\n            data[selector_type] = selector_variants;\n        }\n    });\n    const combinations = getCartesianProduct(data);\n    return combinations.map(constructSelector);\n}\n/**\n * Creates selector for given selector type. Combines several parts if needed.\n */\nexport function constructSelectorType(selector_type, selectors_data) {\n    return selectors_data[selector_type]\n        ? selectors_data[selector_type].join(\"\")\n        : \"\";\n}\n/**\n * Converts selector data object to a selector.\n */\nexport function constructSelector(selectorData = {}) {\n    const pattern = [...SELECTOR_PATTERN];\n    // selector \"nthoftype\" already contains \"tag\"\n    if (selectorData[CSS_SELECTOR_TYPE.tag] &&\n        selectorData[CSS_SELECTOR_TYPE.nthoftype]) {\n        pattern.splice(pattern.indexOf(CSS_SELECTOR_TYPE.tag), 1);\n    }\n    return pattern\n        .map((type) => constructSelectorType(type, selectorData))\n        .join(\"\");\n}\n/**\n * Generates combinations of child and descendant selectors within root\n * selector.\n */\nfunction generateCandidateCombinations(selectors, rootSelector) {\n    return [\n        ...selectors.map((selector) => rootSelector + OPERATOR.DESCENDANT + selector),\n        ...selectors.map((selector) => rootSelector + OPERATOR.CHILD + selector),\n    ];\n}\n/**\n * Generates a list of selector candidates that can potentially match target\n * element.\n */\nfunction generateCandidates(selectors, rootSelector) {\n    return rootSelector === \"\"\n        ? selectors\n        : generateCandidateCombinations(selectors, rootSelector);\n}\n/**\n * Tries to find an unique CSS selector for element within given parent.\n */\nexport function getSelectorWithinRoot(elements, root, rootSelector = \"\", options) {\n    const elementSelectors = getAllSelectors(elements, options.root, options);\n    const selectorCandidates = generateCandidates(elementSelectors, rootSelector);\n    for (const candidateSelector of selectorCandidates) {\n        if (testSelector(elements, candidateSelector, options.root)) {\n            return candidateSelector;\n        }\n    }\n    return null;\n}\n/**\n * Climbs through parents of the element and tries to find the one that is\n * identifiable by unique CSS selector.\n */\nexport function getClosestIdentifiableParent(elements, root, rootSelector = \"\", options) {\n    if (elements.length === 0) {\n        return null;\n    }\n    const candidatesList = [\n        elements.length > 1 ? elements : [],\n        ...getParents(elements, root).map((element) => [element]),\n    ];\n    for (const currentElements of candidatesList) {\n        const result = getSelectorWithinRoot(currentElements, root, rootSelector, options);\n        if (result) {\n            return {\n                foundElements: currentElements,\n                selector: result,\n            };\n        }\n    }\n    return null;\n}\n/**\n * Converts input into list of elements, removing duplicates and non-elements.\n */\nexport function sanitizeSelectorNeedle(needle) {\n    if (needle instanceof NodeList || needle instanceof HTMLCollection) {\n        needle = Array.from(needle);\n    }\n    const elements = (Array.isArray(needle) ? needle : [needle]).filter(isElement);\n    return [...new Set(elements)];\n}\n//# sourceMappingURL=utilities-selectors.js.map","/**\n * Checks whether value is one of the enum's values.\n */\nexport function isEnumValue(haystack, needle) {\n    return Object.values(haystack).includes(needle);\n}\n//# sourceMappingURL=utilities-typescript.js.map","/*! js-cookie v3.0.5 | MIT */\n/* eslint-disable no-var */\nfunction assign (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n  return target\n}\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\nvar defaultConverter = {\n  read: function (value) {\n    if (value[0] === '\"') {\n      value = value.slice(1, -1);\n    }\n    return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n  },\n  write: function (value) {\n    return encodeURIComponent(value).replace(\n      /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n      decodeURIComponent\n    )\n  }\n};\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\n\nfunction init (converter, defaultAttributes) {\n  function set (name, value, attributes) {\n    if (typeof document === 'undefined') {\n      return\n    }\n\n    attributes = assign({}, defaultAttributes, attributes);\n\n    if (typeof attributes.expires === 'number') {\n      attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n    }\n    if (attributes.expires) {\n      attributes.expires = attributes.expires.toUTCString();\n    }\n\n    name = encodeURIComponent(name)\n      .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n      .replace(/[()]/g, escape);\n\n    var stringifiedAttributes = '';\n    for (var attributeName in attributes) {\n      if (!attributes[attributeName]) {\n        continue\n      }\n\n      stringifiedAttributes += '; ' + attributeName;\n\n      if (attributes[attributeName] === true) {\n        continue\n      }\n\n      // Considers RFC 6265 section 5.2:\n      // ...\n      // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n      //     character:\n      // Consume the characters of the unparsed-attributes up to,\n      // not including, the first %x3B (\";\") character.\n      // ...\n      stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n    }\n\n    return (document.cookie =\n      name + '=' + converter.write(value, name) + stringifiedAttributes)\n  }\n\n  function get (name) {\n    if (typeof document === 'undefined' || (arguments.length && !name)) {\n      return\n    }\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all.\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n    var jar = {};\n    for (var i = 0; i < cookies.length; i++) {\n      var parts = cookies[i].split('=');\n      var value = parts.slice(1).join('=');\n\n      try {\n        var found = decodeURIComponent(parts[0]);\n        jar[found] = converter.read(value, found);\n\n        if (name === found) {\n          break\n        }\n      } catch (e) {}\n    }\n\n    return name ? jar[name] : jar\n  }\n\n  return Object.create(\n    {\n      set,\n      get,\n      remove: function (name, attributes) {\n        set(\n          name,\n          '',\n          assign({}, attributes, {\n            expires: -1\n          })\n        );\n      },\n      withAttributes: function (attributes) {\n        return init(this.converter, assign({}, this.attributes, attributes))\n      },\n      withConverter: function (converter) {\n        return init(assign({}, this.converter, converter), this.attributes)\n      }\n    },\n    {\n      attributes: { value: Object.freeze(defaultAttributes) },\n      converter: { value: Object.freeze(converter) }\n    }\n  )\n}\n\nvar api = init(defaultConverter, { path: '/' });\n/* eslint-enable no-var */\n\nexport { api as default };\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","import debounce from './debounce.js';\nimport isObject from './isObject.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nexport default throttle;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n"],"names":[],"sourceRoot":""}